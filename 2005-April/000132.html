<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Freenx-cvs] CVS: freenx - fux modified 4 files
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/freenx-cvs/2005-April/index.html" >
   <LINK REL="made" HREF="mailto:freenx-cvs%40lists.berlios.de?Subject=Re%3A%20%5BFreenx-cvs%5D%20CVS%3A%20freenx%20-%20fux%20modified%204%20files&In-Reply-To=%3C42717D1E.mailGPB1O7P9R%40lists.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000131.html">
   <LINK REL="Next"  HREF="000133.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Freenx-cvs] CVS: freenx - fux modified 4 files</H1>
    <B>fux</B> 
    <A HREF="mailto:freenx-cvs%40lists.berlios.de?Subject=Re%3A%20%5BFreenx-cvs%5D%20CVS%3A%20freenx%20-%20fux%20modified%204%20files&In-Reply-To=%3C42717D1E.mailGPB1O7P9R%40lists.berlios.de%3E"
       TITLE="[Freenx-cvs] CVS: freenx - fux modified 4 files">freenx-cvs at berlios.de
       </A><BR>
    <I>Fri Apr 29 02:17:34 CEST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="000131.html">[Freenx-cvs] CVS: freenx - fabianx modified 2 files
</A></li>
        <LI>Next message: <A HREF="000133.html">[Freenx-cvs] CVS: freenx - fux modified nxsetup
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#132">[ date ]</a>
              <a href="thread.html#132">[ thread ]</a>
              <a href="subject.html#132">[ subject ]</a>
              <a href="author.html#132">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>User:      fux
Date:      2005-04-29 00:17:33 GMT
Modified:  .        ChangeLog node.conf.sample nxloadconfig nxserver
Log:
Feature Request #847 (stderror for some applications to log-file)

Revision  Changes    Path
1.49      +3 -2      freenx/ChangeLog


rev 1.49, prev_rev 1.48
Index: ChangeLog
===================================================================
RCS file: /cvsroot/freenx/freenx/ChangeLog,v
retrieving revision 1.48
retrieving revision 1.49
diff -u -r1.48 -r1.49
--- ChangeLog	28 Apr 2005 22:46:56 -0000	1.48
+++ ChangeLog	29 Apr 2005 00:17:32 -0000	1.49
@@ -1,4 +1,4 @@
-06.03.2005 FreeNX 0.4.0-CVS
+XX.0X.2005 FreeNX 0.4.0-CVS
 	* Opened the 0.4.0 branch.
 	* Added initial support for filesharing via samba.
 	* Improvements to be more node.conf compatible.
@@ -33,8 +33,9 @@
 	  of drivers cache.
 	* Fixed a possible race-condition. (reported by Edward Warnicke
 	  &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/freenx-cvs">eaw at cisco.com</A>&gt;)
+	* Feature Request #847 (stderror of some applications to log-file)
 
-XX.03.2005 FreeNX 0.3.1-CVS
+20.03.2005 FreeNX 0.3.1 &quot;Bugfix Edition&quot;
 	* Fixed keyboard mapping problems.
 	* Fixed unix-custom mode; now allowing parameters to be passed.
 	* Fixed password prompt detection support in nxnode-login.



1.24      +3 -2      freenx/node.conf.sample


rev 1.24, prev_rev 1.23
Index: node.conf.sample
===================================================================
RCS file: /cvsroot/freenx/freenx/node.conf.sample,v
retrieving revision 1.23
retrieving revision 1.24
diff -u -r1.23 -r1.24
--- node.conf.sample	28 Apr 2005 22:39:10 -0000	1.23
+++ node.conf.sample	29 Apr 2005 00:17:33 -0000	1.24
@@ -37,7 +37,7 @@
 #
 #           <A HREF="https://mail.kde.org/mailman/listinfo/freenx-knx">https://mail.kde.org/mailman/listinfo/freenx-knx</A>
 #
-# CVS: $Id: node.conf.sample,v 1.23 2005/04/28 22:39:10 fabianx Exp $
+# CVS: $Id: node.conf.sample,v 1.24 2005/04/29 00:17:33 fux Exp $
 
 #########################################################################
 # General FreeNX directives
@@ -127,6 +127,7 @@
 # 4: Server - Client communication
 # 5: Information
 # 6: Debugging information
+# 7: stderror of some applications
 #NX_LOG_LEVEL=0
 
 # Before turning logging on, please make sure that NX_LOGFILE is
@@ -352,4 +353,4 @@
 #PROXY_TCP_NODELAY=&quot;0&quot;
 
 # Extra options to nxproxy. See !M documentation for useful parameters.
-#PROXY_EXTRA_OPTIONS=&quot;&quot;
\ No newline at end of file
+#PROXY_EXTRA_OPTIONS=&quot;&quot;



1.29      +2 -2      freenx/nxloadconfig


rev 1.29, prev_rev 1.28
Index: nxloadconfig
===================================================================
RCS file: /cvsroot/freenx/freenx/nxloadconfig,v
retrieving revision 1.28
retrieving revision 1.29
diff -u -r1.28 -r1.29
--- nxloadconfig	28 Apr 2005 22:39:10 -0000	1.28
+++ nxloadconfig	29 Apr 2005 00:17:33 -0000	1.29
@@ -5,7 +5,7 @@
 #
 # License: GPL, version 2
 #
-# CVS: $Id: nxloadconfig,v 1.28 2005/04/28 22:39:10 fabianx Exp $
+# CVS: $Id: nxloadconfig,v 1.29 2005/04/29 00:17:33 fux Exp $
 #
 # ========================================================================
 
@@ -296,7 +296,7 @@
 	
 	# Logging directives
 	
-	[ -z $(echo &quot;$NX_LOG_LEVEL&quot; | egrep &quot;^[0-6]$&quot;) ] &amp;&amp; \
+	[ -z $(echo &quot;$NX_LOG_LEVEL&quot; | egrep &quot;^[0-7]$&quot;) ] &amp;&amp; \
 		ERROR=&quot;yes&quot; &amp;&amp; echo &quot;Error: Invalid value \&quot;NX_LOG_LEVEL=$NX_LOG_LEVEL\&quot;&quot;
 	[ &quot;$NX_LOG_LEVEL&quot; != &quot;0&quot; -a ! -e &quot;$NX_LOGFILE&quot; ] &amp;&amp; \
 		WARNING=&quot;yes&quot; &amp;&amp; echo &quot;Warning: Invalid value \&quot;NX_LOGFILE=$NX_LOGFILE\&quot;&quot; \



1.51      +16 -9     freenx/nxserver


rev 1.51, prev_rev 1.50
Index: nxserver
===================================================================
RCS file: /cvsroot/freenx/freenx/nxserver,v
retrieving revision 1.50
retrieving revision 1.51
diff -u -r1.50 -r1.51
--- nxserver	28 Apr 2005 22:39:10 -0000	1.50
+++ nxserver	29 Apr 2005 00:17:33 -0000	1.51
@@ -11,7 +11,7 @@
 #
 # License: GNU GPL, version 2
 #
-# CVS: $Id: nxserver,v 1.50 2005/04/28 22:39:10 fabianx Exp $
+# CVS: $Id: nxserver,v 1.51 2005/04/29 00:17:33 fux Exp $
 #
 
 # Read the config file
@@ -395,6 +395,7 @@
 # 4: Server - Client communication
 # 5: Information
 # 6: Debugging information
+# 7: stderror-channel of some applications
 
 log()
 {
@@ -407,6 +408,12 @@
 	[ &quot;$NX_LOG_LEVEL&quot; -ge &quot;4&quot; -a -w &quot;$NX_LOGFILE&quot; ] || exec cat -
 }
 
+log_error()
+{
+	[ &quot;$NX_LOG_LEVEL&quot; -ge &quot;7&quot; -a -w &quot;$NX_LOGFILE&quot; ] &amp;&amp; exec tee -a &quot;$NX_LOGFILE&quot;
+	[ &quot;$NX_LOG_LEVEL&quot; -ge &quot;7&quot; -a -w &quot;$NX_LOGFILE&quot; ] || exec cat - 
+}
+
 echo_x()
 {
 	log &quot;4&quot; &quot;$@&quot;
@@ -568,7 +575,7 @@
 			then
 				log 6 -n &quot;ssh &quot;
 				export COMMAND_SSH			
-				echo &quot;$PASS&quot; | $PATH_BIN/nxnode-login -- ssh &quot;$USER&quot; &quot;$SSHD_PORT&quot; &quot;$PATH_BIN/nxnode&quot; --check &gt; /dev/null 2&gt;/dev/null
+				echo &quot;$PASS&quot; | $PATH_BIN/nxnode-login -- ssh &quot;$USER&quot; &quot;$SSHD_PORT&quot; &quot;$PATH_BIN/nxnode&quot; --check 2&gt;&amp;1 &gt;/dev/null | log_error
 				if [ $? -eq 0 ]
 				then
 					LOGIN_SUCCESS=&quot;1&quot;
@@ -580,7 +587,7 @@
 			if [ &quot;$ENABLE_SU_AUTHENTICATION&quot; = &quot;1&quot; -a &quot;$LOGIN_SUCCESS&quot; = &quot;0&quot; ]
 			then
 				log 6 -n &quot;su &quot;
-				echo &quot;$PASS&quot; | $PATH_BIN/nxnode-login -- su &quot;$USER&quot; &quot;&quot; &quot;$PATH_BIN/nxnode&quot; --check &gt; /dev/null 2&gt;/dev/null
+				echo &quot;$PASS&quot; | $PATH_BIN/nxnode-login -- su &quot;$USER&quot; &quot;&quot; &quot;$PATH_BIN/nxnode&quot; --check 2&gt;&amp;1 &gt;/dev/null| log_error
 				if [ $? -eq 0 ]
 				then
 					LOGIN_SUCCESS=&quot;1&quot;
@@ -651,10 +658,10 @@
 	if [ &quot;$LOGIN_METHOD&quot; = &quot;SSH&quot; ]
 	then
 	    export COMMAND_SSH
-	    echo &quot;$PASS&quot; | $PATH_BIN/nxnode-login -- ssh &quot;$USER&quot; &quot;$SSHD_PORT&quot; &quot;$PATH_BIN/nxnode&quot; &quot;$CMD&quot; &quot;$@&quot; 2&gt;&amp;1 | log_tee
+	    echo &quot;$PASS&quot; | $PATH_BIN/nxnode-login -- ssh &quot;$USER&quot; &quot;$SSHD_PORT&quot; &quot;$PATH_BIN/nxnode&quot; &quot;$CMD&quot; &quot;$@&quot; 2&gt;&amp;1 &gt;/dev/null | log_error
 	elif [ &quot;$LOGIN_METHOD&quot; = &quot;SU&quot; ]
 	then
-	    echo &quot;$PASS&quot; | $PATH_BIN/nxnode-login -- su &quot;$USER&quot; &quot;&quot; &quot;$PATH_BIN/nxnode&quot; &quot;$CMD&quot; &quot;$@&quot; 2&gt;&amp;1 | log_tee
+	    echo &quot;$PASS&quot; | $PATH_BIN/nxnode-login -- su &quot;$USER&quot; &quot;&quot; &quot;$PATH_BIN/nxnode&quot; &quot;$CMD&quot; &quot;$@&quot; 2&gt;&amp;1 &gt;/dev/null | log_error
 	else 
 	    echo &quot;$@&quot; | $COMMAND_SSH -l &quot;$USER&quot; 127.0.0.1 -p $SSHD_PORT -x -2 -i $NX_ETC_DIR/users.id_dsa -o 'PubkeyAuthentication yes' -o 'RSAAuthentication yes' -o 'RhostsAuthentication no' -o 'PasswordAuthentication no' -o 'RhostsRSAAuthentication no' -o 'StrictHostKeyChecking no' $PATH_BIN/nxnode &quot;$CMD&quot; | log_tee
 	fi
@@ -664,13 +671,13 @@
 {
 	[ &quot;$ENABLE_USESSION&quot; = &quot;1&quot; ] || return
 	
-	$COMMAND_SESSREG -l &quot;:$SESS_DISPLAY&quot; -h &quot;$USERIP&quot; -a $USER 2&gt;/dev/null
+	$COMMAND_SESSREG -l &quot;:$SESS_DISPLAY&quot; -h &quot;$USERIP&quot; -a $USER 2&gt;&amp;1 | log_error
 }
 
 server_remove_usession()
 {
 	[ &quot;$ENABLE_USESSION&quot; = &quot;1&quot; ] || return
-	$COMMAND_SESSREG -l &quot;:$SESS_DISPLAY&quot; -h &quot;$USERIP&quot; -d $USER 2&gt;/dev/null
+	$COMMAND_SESSREG -l &quot;:$SESS_DISPLAY&quot; -h &quot;$USERIP&quot; -d $USER 2&gt;&amp;1 | log_error
 }
 
 server_nxnode_start_wait()
@@ -975,13 +982,13 @@
 		addmount*)
 			server_get_params $CMD
 			PARAMS=$SERVER_PARAMS
-			server_nxnode_start --smbmount &quot;$USER&quot; &quot;$PARAMS&quot; &gt;/dev/null 2&gt;&amp;1
+			server_nxnode_start --smbmount &quot;$USER&quot; &quot;$PARAMS&quot; 2&gt;&amp;1 | log_error
 			echo_x &quot;NX&gt; 719 SMB filesystem: running&quot;
 		;;
 		addprinter*)
 			server_get_params $CMD
 			PARAMS=$SERVER_PARAMS
-			server_nxnode_start --addprinter &quot;$USER&quot; &quot;$PARAMS&quot; &gt;/dev/null 2&gt;&amp;1
+			server_nxnode_start --addprinter &quot;$USER&quot; &quot;$PARAMS&quot; 2&gt;&amp;1 | log_error
 		;;
 		*)
 			# disabled for 1.4.0-5 snapshot client





</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000131.html">[Freenx-cvs] CVS: freenx - fabianx modified 2 files
</A></li>
	<LI>Next message: <A HREF="000133.html">[Freenx-cvs] CVS: freenx - fux modified nxsetup
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#132">[ date ]</a>
              <a href="thread.html#132">[ thread ]</a>
              <a href="subject.html#132">[ subject ]</a>
              <a href="author.html#132">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/freenx-cvs">More information about the Freenx-cvs
mailing list</a><br>
</body></html>
