<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Freenx-cvs] r381 - / nxlaunch nxlaunch/lib nxlaunch/src	nxlaunch/src/pixmaps
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/freenx-cvs/2007-September/index.html" >
   <LINK REL="made" HREF="mailto:freenx-cvs%40lists.berlios.de?Subject=Re%3A%20%5BFreenx-cvs%5D%20r381%20-%20/%20nxlaunch%20nxlaunch/lib%20nxlaunch/src%0A%09nxlaunch/src/pixmaps&In-Reply-To=%3C200709171230.l8HCUxKI022390%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000510.html">
   <LINK REL="Next"  HREF="000511.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Freenx-cvs] r381 - / nxlaunch nxlaunch/lib nxlaunch/src	nxlaunch/src/pixmaps</H1>
    <B>sebjames at BerliOS</B> 
    <A HREF="mailto:freenx-cvs%40lists.berlios.de?Subject=Re%3A%20%5BFreenx-cvs%5D%20r381%20-%20/%20nxlaunch%20nxlaunch/lib%20nxlaunch/src%0A%09nxlaunch/src/pixmaps&In-Reply-To=%3C200709171230.l8HCUxKI022390%40sheep.berlios.de%3E"
       TITLE="[Freenx-cvs] r381 - / nxlaunch nxlaunch/lib nxlaunch/src	nxlaunch/src/pixmaps">sebjames at mail.berlios.de
       </A><BR>
    <I>Mon Sep 17 14:31:33 CEST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000510.html">[Freenx-cvs] r380 - in nxcl: lib nxcl
</A></li>
        <LI>Next message: <A HREF="000511.html">[Freenx-cvs] r382 - nxlaunch/src
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#668">[ date ]</a>
              <a href="thread.html#668">[ thread ]</a>
              <a href="subject.html#668">[ subject ]</a>
              <a href="author.html#668">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: sebjames
Date: 2007-09-17 14:30:56 +0200 (Mon, 17 Sep 2007)
New Revision: 381

Added:
   nxlaunch/
   nxlaunch/Makefile.am
   nxlaunch/README
   nxlaunch/configure.ac
   nxlaunch/lib/
   nxlaunch/lib/Makefile.am
   nxlaunch/lib/callbacks_nx.c
   nxlaunch/lib/callbacks_nx.h
   nxlaunch/src/
   nxlaunch/src/Makefile.am
   nxlaunch/src/i18n.h
   nxlaunch/src/main.c
   nxlaunch/src/nxconfig.glade
   nxlaunch/src/nxlaunch.c
   nxlaunch/src/nxlaunch.glade
   nxlaunch/src/nxlaunch.h
   nxlaunch/src/pixmaps/
   nxlaunch/src/pixmaps/gnome-nx-session.png
   nxlaunch/src/pixmaps/kde-nx-session.png
   nxlaunch/src/pixmaps/nx-icon.png
   nxlaunch/src/pixmaps/nx-icon.xcf
   nxlaunch/src/pixmaps/nxclient-icon.png
   nxlaunch/src/pixmaps/rdp-nx-session.png
   nxlaunch/src/pixmaps/unknown-nx-session.png
   nxlaunch/src/pixmaps/vnc-nx-session.png
Log:
First import of nxlaunch GTK+ NX client based on nxcl

Added: nxlaunch/Makefile.am
===================================================================
--- nxlaunch/Makefile.am	2007-09-16 20:16:05 UTC (rev 380)
+++ nxlaunch/Makefile.am	2007-09-17 12:30:56 UTC (rev 381)
@@ -0,0 +1,10 @@
+
+AUTOMAKE_OPTIONS = check-news dist-bzip2
+
+SUBDIRS = src lib
+
+CLEANFILES = *~
+
+MAINTAINERCLEANFILES = aclocal.m4 nxlaunch-*.tar.gz nxlaunch-*.tar.bz2 nxlaunch-*.diff
+
+INCLUDES = -I./lib
\ No newline at end of file

Added: nxlaunch/README
===================================================================
--- nxlaunch/README	2007-09-16 20:16:05 UTC (rev 380)
+++ nxlaunch/README	2007-09-17 12:30:56 UTC (rev 381)
@@ -0,0 +1,15 @@
+
+  nxlaunch: A GTK+ NX client.
+
+  Seb James. September 2007. <A HREF="https://lists.berlios.de/mailman/listinfo/freenx-cvs">seb at esfnet.co.uk</A>
+
+Nxlaunch uses a program called nxcl (distributed separately) to
+negotiate the NX connection. Nxlaunch sends settings via dbus to
+nxcl so that it can then negotiate the correct sort of NX session
+for you. 
+
+nxcl is distributed separately with the nxcl library.
+
+It would be quite possible to write a GTK client which links directly
+to the nxcl library, but that is left as a further exercise for
+someone.

Added: nxlaunch/configure.ac
===================================================================
--- nxlaunch/configure.ac	2007-09-16 20:16:05 UTC (rev 380)
+++ nxlaunch/configure.ac	2007-09-17 12:30:56 UTC (rev 381)
@@ -0,0 +1,86 @@
+dnl Process this file with autoconf to produce a configure script.
+AC_PREREQ(2.59)
+AC_INIT([nxlaunch], [1.0], [<A HREF="https://lists.berlios.de/mailman/listinfo/freenx-cvs">seb at esfnet.co.uk</A>])
+AC_CONFIG_SRCDIR(src/main.c)
+AC_REVISION([$Revision: 1.3 $])
+AC_PREFIX_DEFAULT(/usr/local)
+
+AM_INIT_AUTOMAKE([1.9 foreign])
+
+AM_CONFIG_HEADER(config.h)
+AM_MAINTAINER_MODE
+
+dnl Checks for programs.
+AC_PROG_CC
+AC_PROG_INSTALL
+AC_PROG_LIBTOOL
+AC_CHECK_PROG(DOXYGEN, doxygen, doxygen, /bin/echo)
+AC_CHECK_PROG(NXCLD, nxcld, nxcld, /bin/echo)
+
+PKG_CHECK_MODULES(PACKAGE, glib-2.0 gtk+-2.0 libglade-2.0 libxml-2.0 dbus-1)
+
+dnl Checks for library functions.
+AC_HEADER_STDC
+AC_HEADER_TIME
+AC_CHECK_FUNCS(strftime gettimeofday uname)
+
+dnl Determine host system type
+AC_CANONICAL_HOST
+AC_DEFINE_UNQUOTED(HOST, &quot;$host&quot;, [The host system nxlaunch was configured for])
+
+dnl pkg_modules=&quot;libxml2&quot; &lt;- Check this and modify when necessary
+dnl PKG_CHECK_MODULES(PACKAGE, [$pkg_modules])
+AC_SUBST(PACKAGE_CFLAGS)
+AC_SUBST(PACKAGE_LIBS)
+
+dnl enable/disable compiler warnings (using gcc), if specified
+AC_ARG_ENABLE(warnings,
+  [  --disable-warnings      disable gcc warnings [default=no]],
+  [case &quot;${enableval}&quot; in
+    yes) nxlaunch_warnings=yes ;; 
+    no)  nxlaunch_warnings=no ;;
+    *) AC_MSG_ERROR(bad value ${enableval} for --enable-warnings) ;;
+  esac], nxlaunch_warnings=yes)
+AC_MSG_CHECKING(whether to use gcc verbose warnings)
+AC_MSG_RESULT($nxlaunch_warnings)
+if (test &quot;$nxlaunch_warnings&quot; = yes &amp;&amp; test &quot;$GCC&quot; = yes); then
+  CFLAGS=&quot;-Wall $CFLAGS&quot;
+fi
+
+dnl enable/disable debug logging, if specified
+AC_ARG_ENABLE(debug-output,
+  [  --enable-debug-output   enable debug output [default=no]],
+  [case &quot;${enableval}&quot; in
+    yes) nxlaunch_debug=yes ;;
+    no)  nxlaunch_debug=no ;;
+    *) AC_MSG_ERROR(bad value ${enableval} for --enable-debug-output) ;;
+  esac], nxlaunch_debug=no)
+AC_MSG_CHECKING(whether to enable debugging output)
+AC_MSG_RESULT($nxlaunch_debug)
+if test &quot;$nxlaunch_debug&quot; = yes; then
+  AC_DEFINE(DEBUG, 1, Define if debugging output should be enabled)
+else
+  AC_DEFINE(DEBUG, 0, Define if debugging output should be enabled)
+fi
+
+dnl enable build of configuration feature, if required
+AC_ARG_ENABLE(build-config,
+  [  --enable-build-config   enable build of configuration features [default=yes]],
+  [case &quot;${enableval}&quot; in
+    yes) nxlaunch_config=yes ;;
+    no)  nxlaunch_config=no ;;
+    *) AC_MSG_ERROR(bad value ${enableval} for --enable-build-config) ;;
+  esac], nxlaunch_config=yes)
+AC_MSG_CHECKING(whether to enable the build of the configuration features in nxlaunch - most users should say yes)
+AC_MSG_RESULT($nxlaunch_config)
+if test &quot;$nxlaunch_config&quot; = yes; then
+  AC_DEFINE(BUILT_IN_CONFIGURATION, 1, Define if this program should have the features to configure connections)
+else
+  AC_DEFINE(BUILT_IN_CONFIGURATION, 0, Define if this program should have the features to configure connections)
+fi
+
+dnl Always output certain files
+
+AC_CONFIG_FILES([Makefile src/Makefile lib/Makefile])
+
+AC_OUTPUT

Added: nxlaunch/lib/Makefile.am
===================================================================
--- nxlaunch/lib/Makefile.am	2007-09-16 20:16:05 UTC (rev 380)
+++ nxlaunch/lib/Makefile.am	2007-09-17 12:30:56 UTC (rev 381)
@@ -0,0 +1,7 @@
+CLEANFILES = *~
+AM_CFLAGS = @PACKAGE_CFLAGS@ -DPACKAGE_DATA_DIR=\&quot;&quot;$(datadir)&quot;\&quot; -DLOCALEDIR=\&quot;$(localedir)\&quot;
+lib_LTLIBRARIES = libcallbacks_nx.la
+libcallbacks_nx_la_SOURCES = callbacks_nx.c
+libcallbacks_nx_la_LIBADD = @PACKAGE_LIBS@ $(LIBINTL)
+libcallbacks_nx_la_LDFLAGS = -version-info 1:0:0
+pkginclude_HEADERS = callbacks_nx.h

Added: nxlaunch/lib/callbacks_nx.c
===================================================================
--- nxlaunch/lib/callbacks_nx.c	2007-09-16 20:16:05 UTC (rev 380)
+++ nxlaunch/lib/callbacks_nx.c	2007-09-17 12:30:56 UTC (rev 381)
@@ -0,0 +1,2369 @@
+/***************************************************************************
+                   nxlaunch: A GTK NX Client based on nxcl
+                   ---------------------------------------
+    begin                : September 2007
+    copyright            : (C) 2007 Embedded Software Foundry Ltd. (U.K.)
+                         :     Author: Sebastian James
+    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/freenx-cvs">seb at esfnet.co.uk</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+#include &quot;callbacks_nx.h&quot;
+
+#include &lt;unistd.h&gt;
+#include &lt;string.h&gt;
+#include &lt;time.h&gt;
+
+#include &lt;glade/glade.h&gt;
+
+/* Use libxml to write out the configuration file */
+#include &lt;libxml/xmlmemory.h&gt;
+#include &lt;libxml/parser.h&gt;
+
+extern GladeXML * xml_glob;
+
+/* A global variable for locking. */
+gboolean can_update_nx_settings = TRUE;
+
+extern int xmlIndentTreeOutput;
+
+/*!
+ * A useful utility function to set the value of a combobox.
+ */
+gboolean set_combobox (GtkWidget * widget, gchar * match_string)
+{
+	GtkListStore * prog_list;
+	GtkTreeIter iter;
+	GtkTreeIter new_iter;
+	gchar * str_data;
+	gboolean valid;
+	gboolean have_match = FALSE;
+
+	prog_list = GTK_LIST_STORE (gtk_combo_box_get_model (GTK_COMBO_BOX (widget)));
+	valid = gtk_tree_model_get_iter_first (GTK_TREE_MODEL (prog_list), &amp;iter);
+
+	while (valid) {
+		gtk_tree_model_get (GTK_TREE_MODEL (prog_list), &amp;iter, 
+				    PROGRAM, &amp;str_data, -1);
+		if (strstr (match_string, str_data)) {
+			new_iter = iter;
+			have_match = TRUE;
+		}
+		g_free (str_data);
+		valid = gtk_tree_model_iter_next (GTK_TREE_MODEL (prog_list), &amp;iter);
+	}
+
+	/* FIXME: new_iter undefined if no match is found */
+	if (have_match == TRUE) {
+		gtk_combo_box_set_active_iter (GTK_COMBO_BOX (widget), &amp;new_iter);		
+	} else {
+		/* do nothing */
+	}
+
+	return have_match;
+}
+
+/*!
+ * Utility function. Places an error in a glade window which you must
+ * define in the glade file.
+ */
+void nx_general_error (const gchar * msg, const gchar * title)
+{
+	GtkWidget * widget;
+	widget = glade_xml_get_widget (xml_glob, &quot;label_general_error&quot;);
+	gtk_label_set_text (GTK_LABEL(widget), msg);
+	widget = glade_xml_get_widget (xml_glob, &quot;dialog_general_error&quot;);
+	gtk_window_set_title (GTK_WINDOW(widget), title);
+	gtk_widget_show (widget);
+	return;
+}
+
+/*!
+ * Reads the password from the XML file into xmlChar * password, so
+ * that we can re-write it out into our re-created XML file.
+ *
+ * FIXME:
+ * This is a quick and dirty solution to remembering the password that
+ * the NX Client sets. Ideally, write_nx_connection should read in the
+ * XML tree from file if it exists and then only change/replace those 
+ * nodes that it needs to.
+ */
+gint get_nx_password (gchar * password, gchar * filename)
+{
+	xmlDocPtr doc;
+	xmlNodePtr n1, n2;
+	xmlChar * group_name;
+	xmlChar * option_key;
+
+	printerr (&quot;%s called\n&quot;, __FUNCTION__);
+
+	doc = xmlParseFile (filename);
+
+	if (doc == NULL ) {
+		/* document not parsed successfully */
+		printerr (&quot;doc not parsed\n&quot;);
+		return NX_XML_NOT_PARSED;
+	}
+
+	n1 = xmlDocGetRootElement (doc);
+
+	if (n1 == NULL) {
+		/* empty document */
+		printerr (&quot;doc is empty\n&quot;);
+		xmlFreeDoc (doc);
+		return NX_XML_EMPTY;
+	}
+
+	if (xmlStrcmp (n1-&gt;name, BAD_CAST &quot;NXClientSettings&quot;)) {
+		/* document of the wrong type, root node != NXClientSettings */
+		printerr (&quot;doc wrong root node\n&quot;);
+		xmlFreeDoc (doc);
+		return NX_XML_WRONG_ROOT_NODE;
+	}
+
+	n1 = n1-&gt;xmlChildrenNode;
+	printerr (&quot;while no 1\n&quot;);
+	while (n1 != NULL) {
+		if ((!xmlStrcmp (n1-&gt;name, BAD_CAST &quot;group&quot;))){
+
+			printerr (&quot;group match!\n&quot;);
+			group_name = xmlGetProp (n1, BAD_CAST &quot;name&quot;);
+			if ((!xmlStrcmp (group_name, BAD_CAST &quot;Login&quot;))) {
+
+				printerr (&quot;Login match!\n&quot;);
+				n2 = n1-&gt;xmlChildrenNode;
+				printerr (&quot;while no 2\n&quot;);
+				while (n2 != NULL) {
+					if ((!xmlStrcmp (n2-&gt;name, BAD_CAST &quot;option&quot;))) {
+							
+						option_key = xmlGetProp (n2, BAD_CAST &quot;key&quot;);
+						if ((!xmlStrcmp (option_key, BAD_CAST &quot;Auth&quot;))) {
+							printerr (&quot;Auth match!\n&quot;);
+							/* This is the password */
+							strncpy (password, 
+								 (gchar *)xmlGetProp (n2, BAD_CAST &quot;value&quot;), 
+								 NX_FIELDLEN-1); /* 254 chars probably enough */
+						}
+						xmlFree (option_key);
+					}
+					n2 = n2-&gt;next;
+				}
+			}
+			xmlFree (group_name);
+		}
+		n1 = n1-&gt;next;
+	}
+	xmlFreeDoc (doc);
+	printerr (&quot;%s returning\n&quot;, __FUNCTION__);
+	return 0;
+}
+
+
+
+/* Add a connection file (theConnectionName.nxs) */
+gint write_nx_connection (struct nx_connection * nx_conn)
+{
+	struct stat * buf;
+	FILE * fp;
+	gchar connection_file[1024];
+	int rtn = 0;
+
+	gboolean new_config_file = TRUE;
+
+	/* for generation of the xml file */
+	xmlDocPtr doc;
+	xmlNodePtr docRoot;
+	xmlNodePtr group;
+	xmlNodePtr optionNode;
+	xmlDtdPtr dtd = NULL; 
+	char str[16];
+	char* homepath;
+	gchar path[1024];
+	gchar * password = NULL;
+
+	printerr (&quot;%s called\n&quot;, __FUNCTION__);
+
+	homepath = getenv(&quot;HOME&quot;);
+	snprintf (path, 1023, &quot;%s/.nx&quot;, homepath);
+	mkdir (path, 0770);
+	snprintf (path, 1023, &quot;%s/.nx/config&quot;, homepath);
+	mkdir (path, 0770);
+
+	/* 
+	 * Check we have the required general config files
+	 */
+	buf = g_malloc0 (sizeof (struct stat));
+	snprintf (path, 1023, &quot;%s/.nx/config/nxclient.conf&quot;, homepath);	
+	stat (path, buf);
+	if (!S_ISREG (buf-&gt;st_mode)) {
+		fp = fopen (path, &quot;w&quot;);
+		if (fp) {
+			fwrite (nxclient_conf, sizeof (gchar), strlen (nxclient_conf), fp);
+			fclose (fp);
+		} else {
+			/* Calling fn generates popup */
+			/*nx_general_error (_(&quot;Couldn't create file ~/.nx/config/nxclient.conf. Please check disk space&quot;), 
+			  _(&quot;Can't create file&quot;));*/
+			return -1;
+		}
+	}
+	g_free (buf);
+
+	/*
+	 * Generate the filename which the connection will be written into
+	 */
+	snprintf (connection_file, 1023, &quot;%s/.nx/config/%s.nxs&quot;,
+		 homepath, nx_conn-&gt;ConnectionName);
+
+
+	/* Read the file in, if it exists, and take the values of Auth, the password, which
+	   may have been written by the nxclient. Then only need to create the tree if 
+	   we had no file to read in. */
+	password = g_malloc0 (NX_FIELDLEN * sizeof (gchar));
+	get_nx_password (password, connection_file);
+	if (strlen (password) &lt;= 0) {
+		strncpy (password, &quot;EMPTY_PASSWORD&quot;, NX_FIELDLEN-1);
+	}
+
+	/*
+	 * Create and populate the XML config file....
+	 */
+
+	/* create new xml document with XML version 1.0 */
+
+	/*if (new_config_file == TRUE) {*/
+	doc = xmlNewDoc (BAD_CAST &quot;1.0&quot;);
+	docRoot = xmlNewNode (NULL, BAD_CAST &quot;NXClientSettings&quot;);
+	xmlDocSetRootElement(doc, docRoot);
+	xmlNewProp (docRoot, BAD_CAST &quot;application&quot;, BAD_CAST &quot;nxclient&quot;);
+	xmlNewProp (docRoot, BAD_CAST &quot;version&quot;, BAD_CAST &quot;1.3&quot;); 
+
+	dtd = xmlCreateIntSubset(doc, BAD_CAST &quot;NXClientSettings&quot;, NULL, NULL);
+
+	/*} else { alternative }*/
+
+	/* 
+	 * create the first group, &quot;Advanced&quot; 
+	 */
+	group = xmlNewChild (docRoot, NULL, BAD_CAST &quot;group&quot;, NULL);
+	xmlNewProp (group, BAD_CAST &quot;name&quot;, BAD_CAST &quot;Advanced&quot;);
+
+	/* hardcoded */
+	if (new_config_file == TRUE) {
+		optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+		xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Cache size&quot;);
+		xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST &quot;8&quot;);
+
+		/* Hardcode a zero cache size on disk for now */
+		optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+		xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Cache size on disk&quot;);
+		xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST &quot;0&quot;);
+
+		optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+		xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Current keyboard&quot;);
+		xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST &quot;true&quot;);
+
+		optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+		xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Custom keyboard layout&quot;);
+		xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST &quot;us&quot;);
+
+		optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+		xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Restore cache&quot;);
+		xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST &quot;true&quot;);
+
+		/* This options seems never to change (deprecated in nx 1.5 perhaps?) */
+		optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+		xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;StreamCompression&quot;);
+		xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST &quot;&quot;);
+	}
+	/* configurable */
+	optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+	xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Disable ZLIB stream compression&quot;);
+	xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, 
+		    nx_conn-&gt;DisableZLIB ? BAD_CAST &quot;true&quot; : BAD_CAST &quot;false&quot;);
+
+	optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+	xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Disable TCP no-delay&quot;);
+	xmlNewProp (optionNode, BAD_CAST &quot;value&quot;,  
+		    nx_conn-&gt;DisableNoDelay ? BAD_CAST &quot;true&quot; : BAD_CAST &quot;false&quot;);
+
+	optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+	xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Enable SSL encryption&quot;);
+	xmlNewProp (optionNode, BAD_CAST &quot;value&quot;,  
+		    nx_conn-&gt;EnableSSLOnly ? BAD_CAST &quot;true&quot; : BAD_CAST &quot;false&quot;);
+
+
+	/* 
+	 * create the second group, &quot;Environment&quot; 
+	 */
+	if (new_config_file == TRUE) {
+		group = xmlNewChild (docRoot, NULL, BAD_CAST &quot;group&quot;, NULL);
+		xmlNewProp (group, BAD_CAST &quot;name&quot;, BAD_CAST &quot;Environment&quot;);
+		/* single option for Environment group */
+		optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+		xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;CUPSD path&quot;);
+		xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST &quot;/usr/sbin/cupsd&quot;);
+	}
+	/* 
+	 * create the third group, &quot;General&quot; 
+	 */
+	group = xmlNewChild (docRoot, NULL, BAD_CAST &quot;group&quot;, NULL);
+	xmlNewProp (group, BAD_CAST &quot;name&quot;, BAD_CAST &quot;General&quot;);
+
+	/* hardcoded options */
+	if (new_config_file == TRUE) {
+		optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+		xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;CUPSD path&quot;);
+		xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST &quot;/usr/sbin/cupsd&quot;);
+
+		optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+		xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Automatic reconnect&quot;);
+		xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST &quot;true&quot;);
+
+		optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+		xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Backingstore&quot;);
+		xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST &quot;when_requested&quot;);
+
+		/* We don't use NX for vnc or rdp sessions so this is hardcoded to &quot;unix&quot; */
+		optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+		xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Session&quot;);
+		xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST &quot;unix&quot;); 
+
+		optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+		xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Use render&quot;);
+		xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST &quot;true&quot;);
+
+		optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+		xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;displaySaveOnExit&quot;);
+		xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST &quot;true&quot;);
+	}
+
+	/* options which are set via our interface */
+	optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+	xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Desktop&quot;);
+	xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST nx_conn-&gt;Desktop);
+	
+	optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+	xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Custom Unix Desktop&quot;);
+	xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST nx_conn-&gt;CustomUnixDesktop);
+	
+	optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+	xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Command line&quot;);
+	xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST nx_conn-&gt;CommandLine);
+	
+	optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+	xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Link speed&quot;);
+	xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST nx_conn-&gt;LinkSpeed);
+	
+	optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+	xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Remember password&quot;);
+	xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, 
+		    nx_conn-&gt;RememberPassword ? BAD_CAST &quot;true&quot; : BAD_CAST &quot;false&quot; );
+	
+	/* We _could_ offer &quot;Available Area&quot; here */
+	sprintf (str, &quot;%dx%d&quot;, nx_conn-&gt;ResolutionWidth, nx_conn-&gt;ResolutionHeight);
+	optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+	xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Resolution&quot;);
+	xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, 
+		    nx_conn-&gt;FullScreen ? BAD_CAST &quot;fullscreen&quot; : BAD_CAST str );
+
+	sprintf (str, &quot;%d&quot;, nx_conn-&gt;ResolutionWidth);
+	optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+	xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Resolution width&quot;);
+	xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST str); 
+
+	sprintf (str, &quot;%d&quot;, nx_conn-&gt;ResolutionHeight);
+	optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+	xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Resolution height&quot;);
+	xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST str); 
+
+	optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+	xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Server host&quot;);
+	xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST nx_conn-&gt;ServerHost); 
+
+	sprintf (str, &quot;%d&quot;, nx_conn-&gt;ServerPort);
+	optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+	xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Server port&quot;);
+	xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST str); 
+
+	optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+	xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Use default image encoding&quot;);
+	xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, 
+		    nx_conn-&gt;ImageEncoding == 0 ? BAD_CAST &quot;0&quot; : BAD_CAST &quot;1&quot;);
+
+	optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+	xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Use taint&quot;);
+	xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, 
+		    nx_conn-&gt;UseTaint ? BAD_CAST &quot;true&quot; : BAD_CAST &quot;false&quot; );
+
+	optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+	xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Virtual desktop&quot;);
+	xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, 
+		    nx_conn-&gt;VirtualDesktop ? BAD_CAST &quot;true&quot; : BAD_CAST &quot;false&quot; );
+
+	optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+	xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;XAgent encoding&quot;);
+	xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, 
+		    nx_conn-&gt;XAgentEncoding ? BAD_CAST &quot;true&quot; : BAD_CAST &quot;false&quot; );
+
+	/* the xdm entries */
+	optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+	xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;xdm mode&quot;);
+	xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST nx_conn-&gt;XdmMode);
+
+	sprintf (str, &quot;%d&quot;, nx_conn-&gt;XdmPort);
+	optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+	xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;xdm list port&quot;);
+	xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST str);
+	optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+	xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;xdm broadcast port&quot;);
+	xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST str);
+	optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+	xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;xdm query port&quot;);
+	xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST str);
+
+	optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+	xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;xdm list host&quot;);
+	xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST nx_conn-&gt;XdmHost);
+	optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+	xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;xdm query host&quot;);
+	xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST nx_conn-&gt;XdmHost);
+	
+	/* 
+	 * create the fourth group, &quot;Images&quot; 
+	 */
+	group = xmlNewChild (docRoot, NULL, BAD_CAST &quot;group&quot;, NULL);
+	xmlNewProp (group, BAD_CAST &quot;name&quot;, BAD_CAST &quot;Images&quot;);
+
+	/* hardcoded options, most of these probably to do with VNC/RDP connections */
+	if (new_config_file == TRUE) {
+		optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+		xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Disable JPEG Compression&quot;);
+		xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST &quot;0&quot;);
+	
+		optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+		xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Disable all image optimisations&quot;);
+		xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST &quot;false&quot;);
+	
+		optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+		xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Image Encoding Type&quot;);
+		xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST &quot;0&quot;);
+	
+		optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+		xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Image JPEG Encoding&quot;);
+		xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST &quot;false&quot;);
+	
+		optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+		xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;RDP optimization for low-bandwidth link&quot;);
+		xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST &quot;false&quot;);
+	
+		optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+		xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Reduce colors to&quot;);
+		xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST &quot;&quot;);
+	
+		optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+		xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;VNC images compression&quot;);
+		xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST &quot;0&quot;);
+	
+		optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+		xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Windows Image Compression&quot;);
+		xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST &quot;1&quot;);
+	}
+
+	/* configurable options */
+
+	/* nx_conn-&gt;ImageEncoding: 0:Default
+	                           1:PNG
+	                           2:JPEG
+                                   3:XBM   */
+
+	/* 0:JPEG no custom 
+	   1:JPEG with custom
+	   2:PNG/XBM */
+	optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+	xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Image Compression Type&quot;);
+	if (nx_conn-&gt;ImageEncoding == 1 || nx_conn-&gt;ImageEncoding == 3) {
+		xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST &quot;2&quot;);
+	} else {
+		xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST &quot;1&quot;);
+	}
+
+	/* The value of the image quality spinbutton */
+	sprintf (str, &quot;%d&quot;, nx_conn-&gt;JPEGQuality);
+	optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+	xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;JPEG Quality&quot;);
+	xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST str);
+
+	/* PNG: true, otherwise false */
+	optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+	xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Use PNG Compression&quot;);
+	xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, 
+		    nx_conn-&gt;ImageEncoding == 1 ? BAD_CAST &quot;true&quot; : BAD_CAST &quot;false&quot;);
+
+	/* 
+	 * create the 5th group, &quot;Login&quot; 
+	 */
+	group = xmlNewChild (docRoot, NULL, BAD_CAST &quot;group&quot;, NULL);
+	xmlNewProp (group, BAD_CAST &quot;name&quot;, BAD_CAST &quot;Login&quot;);
+
+	optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+	xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;User&quot;);
+	xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST nx_conn-&gt;User);
+
+	/* nx_conn-&gt;PublicKey should have been set to the default NX one to begin with */
+	optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+	xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Public Key&quot;);
+	xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST nx_conn-&gt;PublicKey);
+
+	/* Don't do anything right now about key=&quot;Auth&quot;, the saved password */
+	optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+	xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Auth&quot;);
+	xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST password);
+
+	/* Now we can free the password memory */
+       g_free (password);
+
+	/* 
+	 * create the 6th group, &quot;Services&quot;, all currently hardcoded except for sound
+	 */
+	if (new_config_file == TRUE) {
+		group = xmlNewChild (docRoot, NULL, BAD_CAST &quot;group&quot;, NULL);
+		xmlNewProp (group, BAD_CAST &quot;name&quot;, BAD_CAST &quot;Services&quot;);
+
+		optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+		xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Audio&quot;);
+		xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, 
+			    nx_conn-&gt;enableSound ? BAD_CAST &quot;true&quot; : BAD_CAST &quot;false&quot; );
+		optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+		xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;IPPPort&quot;);
+		xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST &quot;631&quot;);
+		optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+		xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;IPPPrinting&quot;);
+		xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST &quot;false&quot;);
+		optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+		xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Shares&quot;);
+		xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST &quot;false&quot;);
+	}
+
+	/* 
+	 * create the 7th group, &quot;Share0&quot; - the on client print queue, which we hardcode
+	 */
+	if (new_config_file == TRUE) {
+		group = xmlNewChild (docRoot, NULL, BAD_CAST &quot;group&quot;, NULL);
+		xmlNewProp (group, BAD_CAST &quot;name&quot;, BAD_CAST &quot;Share0&quot;);
+
+		optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+		xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Default&quot;);
+		xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST &quot;true&quot;);
+		optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+		xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Driver&quot;);
+		xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST &quot;cups printer&quot;);
+		optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+		xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Password&quot;);
+		xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST &quot;&quot;);
+		optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+		xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Public&quot;);
+		xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST &quot;false&quot;);
+		optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+		xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Sharename&quot;);
+		xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST &quot;wm&quot;);
+		optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+		xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Type&quot;);
+		xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST &quot;cupsprinter&quot;);
+		optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+		xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Username&quot;);
+		xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST &quot;hc&quot;);
+	}
+
+	/* 
+	 * create the 8th group, &quot;share chosen&quot; again hardcoded
+	 */
+	if (new_config_file == TRUE) {
+		group = xmlNewChild (docRoot, NULL, BAD_CAST &quot;group&quot;, NULL);
+		xmlNewProp (group, BAD_CAST &quot;name&quot;, BAD_CAST &quot;share chosen&quot;);
+
+		optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+		xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Share number&quot;);
+		xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST &quot;1&quot;);
+		optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+		xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;Share0&quot;);
+		xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST &quot;Share0&quot;);
+		optionNode = xmlNewChild (group, NULL, BAD_CAST &quot;option&quot;, NULL);
+		xmlNewProp (optionNode, BAD_CAST &quot;key&quot;, BAD_CAST &quot;default printer&quot;);
+		xmlNewProp (optionNode, BAD_CAST &quot;value&quot;, BAD_CAST &quot;Share0&quot;);
+	}
+
+	/* Save with Indentation */
+	xmlIndentTreeOutput = 1;
+
+	rtn = xmlSaveFormatFile (connection_file, doc, 1);
+	/* specifying encoding: rtn = xmlSaveFormatFileEnc (connection_file, doc, &quot;iso8859-1&quot;, 1);*/
+
+	xmlFreeDoc (doc);
+
+	if (rtn == -1) {
+		/* Calling function generates popup */
+		/*nx_general_error (_(&quot;Error saving NX configuration. Please check disk space&quot;), 
+		  _(&quot;Error saving configuration&quot;));*/
+		return -1;
+	}
+
+	printerr (&quot;%s returning\n&quot;, __FUNCTION__);
+	/* Clean up and return */
+	return rtn;
+}
+
+/* Delete a connection file */
+gint delete_nx_connection (gchar * name)
+{
+	gchar connection_file[1024];
+	snprintf (connection_file, 1023, &quot;%s/.nx/config/%s.nxs&quot;, getenv(&quot;HOME&quot;), name);
+	unlink (connection_file);
+	return 0;
+}
+
+/**
+ * Replace a connection config file. You do: 
+ * delete_nx_connection (); 
+ * write_nx_connection ();
+ *
+ */
+gint replace_nx_connection (struct nx_connection * nx_conn, gchar * name)
+{
+	delete_nx_connection (name);	
+	return (write_nx_connection (nx_conn));
+}
+
+/* places contents of the general group in nx_conn */
+void parse_general (xmlDocPtr doc, xmlNodePtr cur, 
+		    struct nx_connection * nx_conn)
+{
+	xmlChar * option_key;
+
+	xmlChar * xdm_mode = NULL;
+	guint xdm_li_port = 177;
+	xmlChar * xdm_li_host = NULL;
+	guint xdm_bc_port = 177;
+	guint xdm_qu_port = 177;
+	xmlChar * xdm_qu_host = NULL;
+
+	cur = cur-&gt;xmlChildrenNode;
+
+	while (cur != NULL) {
+		if ((!xmlStrcmp (cur-&gt;name, BAD_CAST &quot;option&quot;))) {
+
+			option_key = xmlGetProp (cur, BAD_CAST &quot;key&quot;);
+
+			if ((!xmlStrcmp (option_key, BAD_CAST &quot;Server host&quot;))) {
+				strncpy (nx_conn-&gt;ServerHost, (gchar *) xmlGetProp (cur, BAD_CAST &quot;value&quot;), NX_FIELDLEN-1);
+			}
+			else if ((!xmlStrcmp (option_key, BAD_CAST &quot;Server port&quot;))) {
+				nx_conn-&gt;ServerPort = atoi ((gchar *) xmlGetProp (cur, BAD_CAST &quot;value&quot;));
+			}
+			else if ((!xmlStrcmp (option_key, BAD_CAST &quot;Desktop&quot;))) {
+				strncpy (nx_conn-&gt;Desktop, (gchar *) xmlGetProp (cur, BAD_CAST &quot;value&quot;), NX_FIELDLEN-1);
+			}
+			else if ((!xmlStrcmp (option_key, BAD_CAST &quot;Custom Unix Desktop&quot;))) {
+				strncpy (nx_conn-&gt;CustomUnixDesktop, (gchar *) xmlGetProp (cur, BAD_CAST &quot;value&quot;), NX_FIELDLEN-1);
+			}
+			else if ((!xmlStrcmp (option_key, BAD_CAST &quot;Command line&quot;))) {
+				strncpy (nx_conn-&gt;CommandLine, (gchar *) xmlGetProp (cur, BAD_CAST &quot;value&quot;), NX_FIELDLEN-1);
+			}
+			else if ((!xmlStrcmp (option_key, BAD_CAST &quot;Link speed&quot;))) {
+				strncpy (nx_conn-&gt;LinkSpeed, (gchar *) xmlGetProp (cur, BAD_CAST &quot;value&quot;), NX_FIELDLEN-1);
+			}
+			else if ((!xmlStrcmp (option_key, BAD_CAST &quot;Remember password&quot;))) {
+				nx_conn-&gt;RememberPassword = 
+					(!xmlStrcmp (xmlGetProp (cur, BAD_CAST &quot;value&quot;), BAD_CAST &quot;true&quot;))
+					? TRUE : FALSE;
+			}
+			/* bit of a pain */
+			else if ((!xmlStrcmp (option_key, BAD_CAST &quot;Resolution&quot;))) {
+				nx_conn-&gt;FullScreen = 
+					(!xmlStrcmp (xmlGetProp (cur, BAD_CAST &quot;value&quot;), BAD_CAST &quot;fullscreen&quot;))
+					? TRUE : FALSE;
+			}
+			else if ((!xmlStrcmp (option_key, BAD_CAST &quot;Resolution width&quot;))) {
+				nx_conn-&gt;ResolutionWidth = atoi ((gchar *)xmlGetProp (cur, BAD_CAST &quot;value&quot;));
+			}
+			else if ((!xmlStrcmp (option_key, BAD_CAST &quot;Resolution height&quot;))) {
+				nx_conn-&gt;ResolutionHeight = atoi ((gchar *)xmlGetProp (cur, BAD_CAST &quot;value&quot;));
+			}
+			else if ((!xmlStrcmp (option_key, BAD_CAST &quot;Use default image encoding&quot;))) {
+				if (!xmlStrcmp (xmlGetProp (cur, BAD_CAST &quot;value&quot;), BAD_CAST &quot;0&quot;)) {
+					nx_conn-&gt;ImageEncoding = 0; /* default */
+				}
+			}
+			else if ((!xmlStrcmp (option_key, BAD_CAST &quot;Use taint&quot;))) {
+				nx_conn-&gt;UseTaint = 
+					(!xmlStrcmp (xmlGetProp (cur, BAD_CAST &quot;value&quot;), BAD_CAST &quot;true&quot;))
+					? TRUE : FALSE;
+			}
+			else if ((!xmlStrcmp (option_key, BAD_CAST &quot;Virtual desktop&quot;))) {
+				nx_conn-&gt;VirtualDesktop = 
+					(!xmlStrcmp (xmlGetProp (cur, BAD_CAST &quot;value&quot;), BAD_CAST &quot;true&quot;))
+					? TRUE : FALSE;
+				printerr (&quot;VirtualDesktop is %d\n&quot;, nx_conn-&gt;VirtualDesktop);
+			}
+			else if ((!xmlStrcmp (option_key, BAD_CAST &quot;XAgent encoding&quot;))) {
+				nx_conn-&gt;XAgentEncoding = 
+					(!xmlStrcmp (xmlGetProp (cur, BAD_CAST &quot;value&quot;), BAD_CAST &quot;true&quot;))
+					? TRUE : FALSE;
+			}
+			else if ((!xmlStrcmp (option_key, BAD_CAST &quot;xdm mode&quot;))) {
+				xdm_mode = xmlGetProp (cur, BAD_CAST &quot;value&quot;);
+			}
+			else if ((!xmlStrcmp (option_key, BAD_CAST &quot;xdm list port&quot;))) {
+				xdm_li_port = atoi ((gchar *) xmlGetProp (cur, BAD_CAST &quot;value&quot;));
+			}
+			else if ((!xmlStrcmp (option_key, BAD_CAST &quot;xdm broadcast port&quot;))) {
+				xdm_bc_port = atoi ((gchar *) xmlGetProp (cur, BAD_CAST &quot;value&quot;));
+			}
+			else if ((!xmlStrcmp (option_key, BAD_CAST &quot;xdm query port&quot;))) {
+				xdm_qu_port = atoi ((gchar *) xmlGetProp (cur, BAD_CAST &quot;value&quot;));
+			}
+			else if ((!xmlStrcmp (option_key, BAD_CAST &quot;xdm list host&quot;))) {
+				xdm_li_host = xmlGetProp (cur, BAD_CAST &quot;value&quot;);
+			}
+			else if ((!xmlStrcmp (option_key, BAD_CAST &quot;xdm query host&quot;))) {
+				xdm_qu_host = xmlGetProp (cur, BAD_CAST &quot;value&quot;);
+			}
+
+			xmlFree (option_key);
+		}
+		cur = cur-&gt;next;
+	}
+
+	/* Now we need to do a little extra work to set nx_conn-&gt;XdmHost and XdmPort */
+	if (xdm_mode != NULL) {
+		
+		strncpy (nx_conn-&gt;XdmMode, (gchar *)xdm_mode, NX_FIELDLEN-1);
+
+		if ((!xmlStrcmp (xdm_mode, BAD_CAST &quot;list&quot;))) {
+			if (xdm_li_host != NULL) {
+				strncpy (nx_conn-&gt;XdmHost, (gchar *)xdm_li_host, NX_FIELDLEN-1);
+			} else {
+				strncpy (nx_conn-&gt;XdmHost, &quot;your.X.host&quot;, NX_FIELDLEN-1);
+			}
+			nx_conn-&gt;XdmPort = xdm_li_port;
+			
+		} else if ((!xmlStrcmp (xdm_mode, BAD_CAST &quot;query&quot;))) {
+			if (xdm_qu_host != NULL) {
+				strncpy (nx_conn-&gt;XdmHost, (gchar *)xdm_qu_host, NX_FIELDLEN-1);
+			} else {
+				strncpy (nx_conn-&gt;XdmHost, &quot;your.X.host&quot;, NX_FIELDLEN-1);
+			}
+			nx_conn-&gt;XdmPort = xdm_qu_port;
+			
+		} else if ((!xmlStrcmp (xdm_mode, BAD_CAST &quot;broadcast&quot;))) {
+			if (xdm_qu_host != NULL) {
+				strncpy (nx_conn-&gt;XdmHost, (gchar *)xdm_qu_host, NX_FIELDLEN-1);
+			} else {
+				strncpy (nx_conn-&gt;XdmHost, &quot;your.X.host&quot;, NX_FIELDLEN-1);
+			}
+			nx_conn-&gt;XdmPort = xdm_bc_port;
+
+		} else {
+			/* xdm_mode is &quot;server decide&quot;, null or something random  */
+			strncpy (nx_conn-&gt;XdmHost, (gchar *)xdm_qu_host, NX_FIELDLEN-1);
+			nx_conn-&gt;XdmPort = 177;	
+		}
+
+		if (xdm_qu_host != NULL) {
+			xmlFree (xdm_qu_host);
+		}
+		if (xdm_li_host != NULL) {
+			xmlFree (xdm_li_host);
+		}
+
+		xmlFree (xdm_mode);
+
+	} else {
+		strncpy (nx_conn-&gt;XdmHost, &quot;your.X.host&quot;, NX_FIELDLEN-1);
+		nx_conn-&gt;XdmPort = 177;		
+	}
+
+	return;
+}
+
+/* places contents of the advanced group in nx_conn */
+void parse_advanced (xmlDocPtr doc, xmlNodePtr cur, 
+		     struct nx_connection * nx_conn)
+{
+	xmlChar * option_key;
+
+	cur = cur-&gt;xmlChildrenNode;
+
+	while (cur != NULL) {
+		if ((!xmlStrcmp (cur-&gt;name, BAD_CAST &quot;option&quot;))) {
+
+			option_key = xmlGetProp (cur, BAD_CAST &quot;key&quot;);
+
+			if ((!xmlStrcmp (option_key, BAD_CAST &quot;Disable ZLIB stream compression&quot;))) {
+				nx_conn-&gt;DisableZLIB = 
+					(!xmlStrcmp (xmlGetProp (cur, BAD_CAST &quot;value&quot;), BAD_CAST &quot;true&quot;))
+					? TRUE : FALSE;
+			}
+			else if ((!xmlStrcmp (option_key, BAD_CAST &quot;Disable TCP no-delay&quot;))) {
+				nx_conn-&gt;DisableNoDelay = 
+					(!xmlStrcmp (xmlGetProp (cur, BAD_CAST &quot;value&quot;), BAD_CAST &quot;true&quot;))
+					? TRUE : FALSE;
+			}
+			else if ((!xmlStrcmp (option_key, BAD_CAST &quot;Enable SSL encryption&quot;))) {
+				nx_conn-&gt;EnableSSLOnly = 
+					(!xmlStrcmp (xmlGetProp (cur, BAD_CAST &quot;value&quot;), BAD_CAST &quot;true&quot;))
+					? TRUE : FALSE;
+			}
+
+			xmlFree (option_key);
+		}
+		cur = cur-&gt;next;
+	}
+	return;
+}
+
+/* places contents of the general group def im enc in data */
+gint read_default_image_encoding (xmlDocPtr doc, xmlNodePtr cur)
+{
+	xmlChar * option_key;
+	gint rtn = -1;
+	cur = cur-&gt;xmlChildrenNode;
+
+	while (cur != NULL) {
+		if ((!xmlStrcmp (cur-&gt;name, BAD_CAST &quot;option&quot;))) {
+			
+			option_key = xmlGetProp (cur, BAD_CAST &quot;key&quot;);
+							
+			if ((!xmlStrcmp (option_key, BAD_CAST &quot;Use default image encoding&quot;))) {
+				if (!xmlStrcmp (xmlGetProp (cur, BAD_CAST &quot;value&quot;), BAD_CAST &quot;0&quot;)) {
+					rtn = 0; /* default */
+				} else if (!xmlStrcmp (xmlGetProp (cur, BAD_CAST &quot;value&quot;), BAD_CAST &quot;1&quot;)) { 
+					rtn = 1;
+				} else {
+					rtn = -1;
+				}
+			}
+			xmlFree (option_key);
+			if (rtn != -1) {
+				break;
+			}
+		}
+		cur = cur-&gt;next;
+	}
+	return rtn;
+}
+
+/*!
+ * Return value of &quot;Use default image encoding&quot; node 
+ * which is 0 or 1. -1 on failure.
+ */
+gint find_def_im_enc_in_general (xmlDocPtr doc, xmlNodePtr cur)
+{
+	xmlChar * group_name;
+	gint rtn = -1;
+	gboolean rtn_ready = FALSE;
+
+	if (!xmlStrcmp (cur-&gt;name, BAD_CAST &quot;NXClientSettings&quot;)) {
+
+		cur = cur-&gt;xmlChildrenNode;
+		while (cur != NULL) {
+			if ((!xmlStrcmp (cur-&gt;name, BAD_CAST &quot;group&quot;))){
+
+				group_name = xmlGetProp (cur, BAD_CAST &quot;name&quot;);
+
+				if ((!xmlStrcmp (group_name, BAD_CAST &quot;General&quot;))) {
+					printerr (&quot;\&quot;General\&quot; group found (lookin for def. im. enc.)\n&quot;);
+
+					rtn = read_default_image_encoding (doc, cur);
+					rtn_ready = TRUE;
+				}
+				xmlFree (group_name);
+				if (rtn_ready == TRUE) { break; }
+			}
+			cur = cur-&gt;next;
+		}
+	} else {
+		printerr (&quot;Got passed the wrong parent node\n&quot;);
+	}
+
+	return rtn;
+}
+
+
+#define NOT_YET_SET 99
+/* places contents of the images group in nx_conn */
+void parse_images (xmlDocPtr doc, xmlNodePtr cur, 
+		   struct nx_connection * nx_conn)
+{
+	xmlChar * option_key;
+	guint comp = 5;
+	gboolean png = FALSE;
+	xmlNodePtr parent; /* used to get the &quot;Use default image encoding&quot; setting. */
+	gint default_image_encoding = -1;
+
+	/* At this point, cur is &lt;group name=&quot;Images&quot;&gt; */
+	parent = cur-&gt;parent;
+
+	default_image_encoding = find_def_im_enc_in_general (doc, parent);
+	printerr (&quot;default_image_encoding = %d\n&quot;, default_image_encoding);
+
+	if (default_image_encoding == 0) {
+		/* This means &quot;USE DEFAULT&quot; */
+		nx_conn-&gt;ImageEncoding = 0;
+	} else if (default_image_encoding == 1) {
+		/* This means &quot;DON'T USE DEFAULT&quot; */
+		nx_conn-&gt;ImageEncoding = NOT_YET_SET; /* used a few lines down */
+	} else {
+		nx_conn-&gt;ImageEncoding = NOT_YET_SET;
+	}
+
+	cur = cur-&gt;children;
+
+	while (cur != NULL) {
+		if ((!xmlStrcmp (cur-&gt;name, BAD_CAST &quot;option&quot;))) {
+
+			option_key = xmlGetProp (cur, BAD_CAST &quot;key&quot;);
+
+			if ((!xmlStrcmp (option_key, BAD_CAST &quot;Image Compression Type&quot;))) {				
+				comp = atoi ((gchar *) xmlGetProp (cur, BAD_CAST &quot;value&quot;));
+			}
+			else if ((!xmlStrcmp (option_key, BAD_CAST &quot;JPEG Quality&quot;))) {
+				nx_conn-&gt;JPEGQuality = atoi ((gchar *) xmlGetProp (cur, BAD_CAST &quot;value&quot;));
+			}
+			else if ((!xmlStrcmp (option_key, BAD_CAST &quot;Use PNG Compression&quot;))) {
+				png = (!xmlStrcmp (xmlGetProp (cur, BAD_CAST &quot;value&quot;), BAD_CAST &quot;true&quot;))
+					? TRUE : FALSE;	
+			}
+
+			xmlFree (option_key);
+		}
+		cur = cur-&gt;next;
+	}
+
+	if (nx_conn-&gt;ImageEncoding == NOT_YET_SET) {
+		if (png) {
+			nx_conn-&gt;ImageEncoding = 1; /* PNG */
+		} else {
+			if (comp == 2) {
+				nx_conn-&gt;ImageEncoding = 3; /* XBM */
+			} else if (comp == 0 || comp == 1) {
+				nx_conn-&gt;ImageEncoding = 2; /* JPEG */
+			}
+		}
+	}
+
+	return;
+}
+
+/* places contents of the login group in nx_conn */
+void parse_login (xmlDocPtr doc, xmlNodePtr cur, 
+		  struct nx_connection * nx_conn)
+{
+	xmlChar * option_key;
+	gint i, end;
+
+	cur = cur-&gt;xmlChildrenNode;
+
+	while (cur != NULL) {
+		if ((!xmlStrcmp (cur-&gt;name, BAD_CAST &quot;option&quot;))) {
+
+			option_key = xmlGetProp (cur, BAD_CAST &quot;key&quot;);
+
+			if ((!xmlStrcmp (option_key, BAD_CAST &quot;User&quot;))) {
+				strncpy (nx_conn-&gt;User, (gchar *) xmlGetProp (cur, BAD_CAST &quot;value&quot;), NX_FIELDLEN-1);
+			}
+			else if ((!xmlStrcmp (option_key, BAD_CAST &quot;Public Key&quot;))) {
+				strncpy (nx_conn-&gt;PublicKey, (gchar *) xmlGetProp (cur, BAD_CAST &quot;value&quot;), SSLKEYLEN-1);
+				/* We need to parse the PublicKey now and replace and spaces with new lines, because
+				   the nxclient program seems to incorrectly save \n characters in the .nxs file which
+				   are read in and converted to whitespace (the space char 0x20) by libxml2. */
+				
+				/* Need to avoid the -----BEGIN DSA PRIVATE KEY----- string and the
+				   -----END DSA PRIVATE KEY----- string, but escape all other characters.
+				*/
+
+				/* Find the end of the key */
+				end = 0;
+				while (nx_conn-&gt;PublicKey[end++]) {}
+
+				i = 30; /* 30 means this should start on a '-' character */
+				while (nx_conn-&gt;PublicKey[i] &amp;&amp; i&lt;(end-29)) {
+
+					/*printerr (&quot;PublicKey[%d] = '%c' or 0x%x\n&quot;, 
+					  i, nx_conn-&gt;PublicKey[i], nx_conn-&gt;PublicKey[i]);*/
+					
+					/* Replace spaces in the actual key with newline characters */
+					if (nx_conn-&gt;PublicKey[i] == 0x20) {
+						nx_conn-&gt;PublicKey[i] = 0xa;
+					}
+					i++;
+				}
+			}
+
+			xmlFree (option_key);
+		}
+		cur = cur-&gt;next;
+	}
+	return;
+}
+
+void parse_services (xmlDocPtr doc, xmlNodePtr cur, 
+		     struct nx_connection * nx_conn)
+{
+	xmlChar * option_key;
+
+	cur = cur-&gt;children;
+
+	while (cur != NULL) {
+		if ((!xmlStrcmp (cur-&gt;name, BAD_CAST &quot;option&quot;))) {
+
+			option_key = xmlGetProp (cur, BAD_CAST &quot;key&quot;);
+
+			if ((!xmlStrcmp (option_key, BAD_CAST &quot;Audio&quot;))) {
+				nx_conn-&gt;enableSound =
+					(!xmlStrcmp (xmlGetProp (cur, BAD_CAST &quot;value&quot;), BAD_CAST &quot;true&quot;)) ? TRUE : FALSE;
+
+			} else if ((!xmlStrcmp (option_key, BAD_CAST &quot;IPPPort&quot;))) {
+				nx_conn-&gt;IPPPort = atoi ((gchar *) xmlGetProp (cur, BAD_CAST &quot;value&quot;));
+
+			} else if ((!xmlStrcmp (option_key, BAD_CAST &quot;IPPPrinting&quot;))) {
+				nx_conn-&gt;IPPPrinting =
+					(!xmlStrcmp (xmlGetProp (cur, BAD_CAST &quot;value&quot;), BAD_CAST &quot;true&quot;)) ? TRUE : FALSE;
+
+			} else if ((!xmlStrcmp (option_key, BAD_CAST &quot;Shares&quot;))) {
+				nx_conn-&gt;Shares =
+					(!xmlStrcmp (xmlGetProp (cur, BAD_CAST &quot;value&quot;), BAD_CAST &quot;true&quot;)) ? TRUE : FALSE;
+			}
+
+			xmlFree (option_key);
+		}
+		cur = cur-&gt;next;
+	}
+
+	return;
+}
+
+
+/**
+ * Read an entry in theConn.nxs to display in the nx pop up.
+ *
+ * Returns 0 if all ok. Otherwise, an error code as found in callbacks_nx.h
+ */
+gint read_nx_connection (struct nx_connection * nx_conn, const gchar * name)
+{
+	xmlDocPtr doc;
+	xmlNodePtr cur;
+	xmlChar * group_name;
+
+	gchar * doc_name;
+
+	strncpy (nx_conn-&gt;ConnectionName, name, NX_FIELDLEN-1);
+
+	doc_name = g_malloc (1024 * sizeof (gchar));
+	snprintf (doc_name, 1023, &quot;%s/.nx/config/%s.nxs&quot;, getenv(&quot;HOME&quot;), name);
+	doc = xmlParseFile (doc_name);
+	/* Assume it's ok to free up docname here */
+	g_free (doc_name);
+
+	if (doc == NULL ) {
+		/* document not parsed successfully */
+		return NX_XML_NOT_PARSED;
+	}
+
+	cur = xmlDocGetRootElement (doc);
+
+	if (cur == NULL) {
+		/* empty document */
+		xmlFreeDoc (doc);
+		return NX_XML_EMPTY;
+	}
+
+	if (xmlStrcmp (cur-&gt;name, BAD_CAST &quot;NXClientSettings&quot;)) {
+		/* document of the wrong type, root node != NXClientSettings */
+		xmlFreeDoc (doc);
+		return NX_XML_WRONG_ROOT_NODE;
+	}
+
+	cur = cur-&gt;xmlChildrenNode;
+	while (cur != NULL) {
+		if ((!xmlStrcmp (cur-&gt;name, BAD_CAST &quot;group&quot;))){
+
+			group_name = xmlGetProp (cur, BAD_CAST &quot;name&quot;);
+
+			if ((!xmlStrcmp (group_name, BAD_CAST &quot;General&quot;))) {
+				printerr (&quot;\&quot;General\&quot; group found\n&quot;);
+				parse_general (doc, cur, nx_conn);
+
+			} else if ((!xmlStrcmp (group_name, BAD_CAST &quot;Advanced&quot;))) {
+				printerr (&quot;\&quot;Advanced\&quot; group found\n&quot;);
+				parse_advanced (doc, cur, nx_conn);
+
+			} else if ((!xmlStrcmp (group_name, BAD_CAST &quot;Images&quot;))) {
+				printerr (&quot;\&quot;Images\&quot; group found\n&quot;);
+				parse_images (doc, cur, nx_conn);
+
+			} else if ((!xmlStrcmp (group_name, BAD_CAST &quot;Login&quot;))) {
+				printerr (&quot;\&quot;Login\&quot; group found\n&quot;);
+				parse_login (doc, cur, nx_conn);
+
+			} else if ((!xmlStrcmp (group_name, BAD_CAST &quot;Services&quot;))) {
+				printerr (&quot;\&quot;Services\&quot; group found\n&quot;);
+				parse_services (doc, cur, nx_conn);
+
+#ifdef EXTRAXMLNEEDED
+			} else if ((!xmlStrcmp (group_name, BAD_CAST &quot;Environment&quot;))) {
+				printerr (&quot;\&quot;Environment\&quot; group found\n&quot;);
+				/* don't need (hardcoded): 
+				   parse_environment (doc, cur, nx_conn);*/
+
+			} else if ((!xmlStrcmp (group_name, BAD_CAST &quot;Share0&quot;))) {
+				printerr (&quot;\&quot;Share0\&quot; group found\n&quot;);
+				/* don't need:
+				   parse_share0 (doc, cur, nx_conn);*/
+
+			} else if ((!xmlStrcmp (group_name, BAD_CAST &quot;share chosen&quot;))) {
+				printerr (&quot;\&quot;share chosen\&quot; group found\n&quot;);
+				/* don't need:
+				   parse_share_chosen (doc, cur, nx_conn);*/
+#endif
+			} else {
+				printerr (&quot;hardcoded/unknown group found\n&quot;);
+			}
+
+			xmlFree (group_name);
+
+		}
+		cur = cur-&gt;next;
+	}
+
+	/* the Geometry field is not stored in the XML, but we create it, for convenience of other apps */
+	snprintf (nx_conn-&gt;Geometry, 32, &quot;%dx%d&quot;, nx_conn-&gt;ResolutionWidth, nx_conn-&gt;ResolutionHeight);
+
+	xmlFreeDoc (doc);
+	printerr (&quot;returning from %s\n&quot;, __FUNCTION__);
+	return 0;
+}
+
+
+
+/*
+ * Allocate memory for an nx connection data structure.
+ * Note that if you use gtk tree models, you may prefer to only malloc
+ * the struct nx_connection, as some of the gtk functions will malloc
+ * before they copy a string into you nx_connection structure.
+ */
+struct nx_connection * nx_connection_malloc (void)
+{
+	struct nx_connection * nx_conn;
+
+	/* malloc the structure itself */
+	nx_conn = g_malloc0 (sizeof (struct nx_connection));
+	
+	/* and all the gchars that it has to point to */
+	nx_conn-&gt;ConnectionName = g_malloc0 (NX_FIELDLEN * sizeof(gchar));
+	nx_conn-&gt;ServerHost = g_malloc0 (NX_FIELDLEN * sizeof(gchar));
+	nx_conn-&gt;User = g_malloc0 (NX_FIELDLEN * sizeof(gchar));
+	nx_conn-&gt;Pass = g_malloc0 (NX_FIELDLEN * sizeof(gchar));
+	nx_conn-&gt;Geometry = g_malloc0 (NX_FIELDLEN * sizeof(gchar));
+	nx_conn-&gt;LinkSpeed = g_malloc0 (NX_FIELDLEN * sizeof(gchar));
+	nx_conn-&gt;Desktop = g_malloc0 (NX_FIELDLEN * sizeof(gchar));
+	nx_conn-&gt;CustomUnixDesktop = g_malloc0 (NX_FIELDLEN * sizeof(gchar));
+	nx_conn-&gt;XdmMode = g_malloc0 (NX_FIELDLEN * sizeof(gchar));
+	nx_conn-&gt;XdmHost = g_malloc0 (NX_FIELDLEN * sizeof(gchar));
+
+	/* More memory required for SSLKey and the command line */
+	nx_conn-&gt;PublicKey = g_malloc0 (SSLKEYLEN * sizeof(gchar));
+	nx_conn-&gt;CommandLine = g_malloc0 (CMDLINELEN * sizeof(gchar));
+
+	nx_conn-&gt;agentServer = g_malloc0 (NX_FIELDLEN * sizeof(gchar));
+	nx_conn-&gt;agentUser = g_malloc0 (NX_FIELDLEN * sizeof(gchar));
+	nx_conn-&gt;agentPass = g_malloc0 (NX_FIELDLEN * sizeof(gchar));
+
+	return nx_conn;
+}
+
+/* reset an nx connection data structure to default values */
+void nx_connection_zero (struct nx_connection * nx_conn)
+{
+	strcpy (nx_conn-&gt;ConnectionName, &quot;&quot;);
+	strcpy (nx_conn-&gt;ServerHost, &quot;&quot;);
+	strcpy (nx_conn-&gt;User, &quot;&quot;);
+	strcpy (nx_conn-&gt;Pass, &quot;&quot;);
+	strcpy (nx_conn-&gt;LinkSpeed, &quot;wan&quot;);
+	strcpy (nx_conn-&gt;Desktop, &quot;kde&quot;);
+	strcpy (nx_conn-&gt;CustomUnixDesktop, &quot;console&quot;);
+	strncpy (nx_conn-&gt;PublicKey, NXDefaultKey, SSLKEYLEN-1); /* Set to default */
+	strcpy (nx_conn-&gt;CommandLine, &quot;&quot;);
+	strcpy (nx_conn-&gt;XdmMode, &quot;server decide&quot;);
+	strcpy (nx_conn-&gt;XdmHost, &quot;&quot;);
+	strcpy (nx_conn-&gt;agentServer, &quot;&quot;);
+	strcpy (nx_conn-&gt;agentUser, &quot;&quot;);
+	strcpy (nx_conn-&gt;agentPass, &quot;&quot;);
+
+
+	nx_conn-&gt;ServerPort = 22;
+	nx_conn-&gt;ResolutionWidth = 800;
+	nx_conn-&gt;ResolutionHeight = 600;
+	strcpy (nx_conn-&gt;Geometry, &quot;800x600&quot;);
+	nx_conn-&gt;ImageEncoding = 0;
+	nx_conn-&gt;JPEGQuality = 5;
+	nx_conn-&gt;XdmPort = 177;
+
+	nx_conn-&gt;RememberPassword = FALSE;
+	nx_conn-&gt;DisableNoDelay = FALSE;
+	nx_conn-&gt;DisableZLIB = FALSE;
+	nx_conn-&gt;EnableSSLOnly = TRUE;
+	nx_conn-&gt;VirtualDesktop = FALSE;
+	nx_conn-&gt;XAgentEncoding = FALSE;
+	nx_conn-&gt;UseTaint = FALSE;
+	nx_conn-&gt;FullScreen = TRUE;
+	nx_conn-&gt;enableSound = FALSE;
+	return;
+}
+
+/* free up memory associated with an nx connection data structure */
+gint nx_connection_free (struct nx_connection * nx_conn)
+{
+	if (nx_conn-&gt;ConnectionName)
+		g_free (nx_conn-&gt;ConnectionName);
+	if (nx_conn-&gt;ServerHost)
+		g_free (nx_conn-&gt;ServerHost);
+	if (nx_conn-&gt;User)
+		g_free (nx_conn-&gt;User);
+	if (nx_conn-&gt;Pass)
+		g_free (nx_conn-&gt;Pass);
+	if (nx_conn-&gt;Geometry)
+		g_free (nx_conn-&gt;Geometry);
+	if (nx_conn-&gt;LinkSpeed)
+		g_free (nx_conn-&gt;LinkSpeed);
+	if (nx_conn-&gt;Desktop)
+		g_free (nx_conn-&gt;Desktop);
+	if (nx_conn-&gt;CustomUnixDesktop)
+		g_free (nx_conn-&gt;CustomUnixDesktop);
+	if (nx_conn-&gt;PublicKey)
+		g_free (nx_conn-&gt;PublicKey);
+	if (nx_conn-&gt;CommandLine)
+		g_free (nx_conn-&gt;CommandLine);
+	if (nx_conn-&gt;XdmMode)
+		g_free (nx_conn-&gt;XdmMode);
+	if (nx_conn-&gt;XdmHost)
+		g_free (nx_conn-&gt;XdmHost);
+	if (nx_conn-&gt;agentServer)
+		g_free (nx_conn-&gt;agentServer);
+	if (nx_conn-&gt;agentUser)
+		g_free (nx_conn-&gt;agentUser);
+	if (nx_conn-&gt;agentPass)
+		g_free (nx_conn-&gt;agentPass);
+
+	if (nx_conn != NULL)
+		g_free (nx_conn);
+	
+	return 0;
+}
+
+
+
+
+void setup_nx_popup (struct nx_connection * nx_conn)
+{
+	GtkWidget * widget;
+	GtkTextBuffer * buffer;
+
+	/* First set the page of the notebook so it always comes up the same way */
+	widget = glade_xml_get_widget (xml_glob, &quot;notebook_nx&quot;);
+	gtk_notebook_set_current_page (GTK_NOTEBOOK (widget), 0);
+
+	widget = glade_xml_get_widget (xml_glob, &quot;entry_nx_connection_name&quot;);
+	gtk_entry_set_text (GTK_ENTRY (widget), nx_conn-&gt;ConnectionName);
+
+	widget = glade_xml_get_widget (xml_glob, &quot;entry_nx_user&quot;);
+	gtk_entry_set_text (GTK_ENTRY (widget), nx_conn-&gt;User);
+
+	widget = glade_xml_get_widget (xml_glob, &quot;entry_nx_server&quot;);
+	gtk_entry_set_text (GTK_ENTRY (widget), nx_conn-&gt;ServerHost);
+
+	widget = glade_xml_get_widget (xml_glob, &quot;spinbutton_nx_port&quot;);
+	gtk_spin_button_set_value (GTK_SPIN_BUTTON (widget), nx_conn-&gt;ServerPort);
+
+	widget = glade_xml_get_widget (xml_glob, &quot;checkbutton_nx_save_password&quot;);
+	gtk_toggle_button_set_active(GTK_TOGGLE_BUTTON (widget), 
+				     nx_conn-&gt;RememberPassword ? TRUE : FALSE);
+
+	widget = glade_xml_get_widget (xml_glob, &quot;checkbutton_nx_disable_no_delay&quot;);
+	gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (widget), 
+				      nx_conn-&gt;DisableNoDelay ? TRUE : FALSE); 
+
+	widget = glade_xml_get_widget (xml_glob, &quot;checkbutton_nx_disable_zlib&quot;);
+	gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (widget), 
+				      nx_conn-&gt;DisableZLIB ? TRUE : FALSE); 
+
+	widget = glade_xml_get_widget (xml_glob, &quot;checkbutton_nx_enable_ssl_for_all&quot;);
+	gtk_toggle_button_set_active(GTK_TOGGLE_BUTTON (widget), 
+				     nx_conn-&gt;EnableSSLOnly ? TRUE : FALSE); 
+
+	widget = glade_xml_get_widget (xml_glob, &quot;hscale_nx_connection_capacity&quot;);
+	if (!strncmp (nx_conn-&gt;LinkSpeed, &quot;modem&quot;, NX_FIELDLEN)) {
+		gtk_range_set_value (GTK_RANGE (widget), 1);
+	} else if (!strncmp (nx_conn-&gt;LinkSpeed, &quot;isdn&quot;, NX_FIELDLEN)) {
+		gtk_range_set_value (GTK_RANGE (widget), 2);
+	} else if (!strncmp (nx_conn-&gt;LinkSpeed, &quot;adsl&quot;, NX_FIELDLEN)) {
+		gtk_range_set_value (GTK_RANGE (widget), 3);
+	} else if (!strncmp (nx_conn-&gt;LinkSpeed, &quot;wan&quot;, NX_FIELDLEN)) {
+		gtk_range_set_value (GTK_RANGE (widget), 4);
+	} else if (!strncmp (nx_conn-&gt;LinkSpeed, &quot;lan&quot;, NX_FIELDLEN)) {
+		gtk_range_set_value (GTK_RANGE (widget), 5);
+	} else {
+		gtk_range_set_value (GTK_RANGE (widget), 3);
+	}
+
+
+	widget = glade_xml_get_widget (xml_glob, &quot;combobox_nx_desktop_session&quot;);
+
+	if (!strncmp (nx_conn-&gt;Desktop, &quot;kde&quot;, NX_FIELDLEN)) {
+		set_combobox (widget, &quot;KDE&quot;);
+
+	} else 	if (!strncmp (nx_conn-&gt;Desktop, &quot;gnome&quot;, NX_FIELDLEN)) {
+		set_combobox (widget, &quot;GNOME&quot;);
+
+	} else 	if (!strncmp (nx_conn-&gt;Desktop, &quot;cde&quot;, NX_FIELDLEN)) {
+		set_combobox (widget, &quot;CDE&quot;);
+
+	} else 	if (!strncmp (nx_conn-&gt;Desktop, &quot;xdm&quot;, NX_FIELDLEN)) {
+		set_combobox (widget, &quot;XDM&quot;);
+
+	} else 	if (!strncmp (nx_conn-&gt;Desktop, &quot;console&quot;, NX_FIELDLEN)) {
+
+		if (!strncmp (nx_conn-&gt;CustomUnixDesktop, &quot;console&quot;, NX_FIELDLEN)) {
+
+			set_combobox (widget, _(&quot;Console&quot;));
+
+		} else if (!strncmp (nx_conn-&gt;CustomUnixDesktop, &quot;default&quot;, NX_FIELDLEN)) {
+
+			set_combobox (widget, _(&quot;Default X client script on server&quot;));
+
+		} else if (!strncmp (nx_conn-&gt;CustomUnixDesktop, &quot;application&quot;, NX_FIELDLEN)) {
+
+			set_combobox (widget, _(&quot;Custom command&quot;));
+		} else {
+			set_combobox (widget, _(&quot;Console&quot;));
+		}
+
+	} else {
+		set_combobox (widget, &quot;KDE&quot;);
+	}
+
+	widget = glade_xml_get_widget (xml_glob, &quot;entry_nx_custom_command&quot;);
+	gtk_entry_set_text (GTK_ENTRY (widget), nx_conn-&gt;CommandLine);
+
+	widget = glade_xml_get_widget (xml_glob, &quot;radiobutton_nx_new_virtual_desktop&quot;);
+	gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (widget), nx_conn-&gt;VirtualDesktop);
+
+	widget = glade_xml_get_widget (xml_glob, &quot;radiobutton_nx_floating_window&quot;);
+	gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (widget), !nx_conn-&gt;VirtualDesktop);
+
+	widget = glade_xml_get_widget (xml_glob, &quot;checkbutton_nx_disable_x_agent&quot;);
+	gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (widget), !nx_conn-&gt;XAgentEncoding);
+
+	widget = glade_xml_get_widget (xml_glob, &quot;checkbutton_nx_disable_x_replies&quot;);
+	gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (widget), !nx_conn-&gt;UseTaint);
+
+	widget = glade_xml_get_widget (xml_glob, &quot;combobox_nx_xdm_mode&quot;);
+	if (!strncmp (nx_conn-&gt;XdmMode, &quot;server decide&quot;, NX_FIELDLEN)) {
+		set_combobox (widget, &quot;Let NX server decide&quot;);
+
+	} else if (!strncmp (nx_conn-&gt;XdmMode, &quot;query&quot;, NX_FIELDLEN)) {
+		set_combobox (widget, &quot;Send an XDM query to a host&quot;);
+
+	} else if (!strncmp (nx_conn-&gt;XdmMode, &quot;broadcast&quot;, NX_FIELDLEN)) {
+		set_combobox (widget, &quot;Broadcast an XDM query&quot;);
+
+	} else if (!strncmp (nx_conn-&gt;XdmMode, &quot;list&quot;, NX_FIELDLEN)) {
+		set_combobox (widget, &quot;Get a list of available X display managers&quot;);
+
+	} else {
+		printerr (&quot;deflt, nx_conn-&gt;XdmMode = %s\n&quot;, nx_conn-&gt;XdmMode);
+		set_combobox (widget, &quot;Let NX server decide&quot;);
+	}
+
+	widget = glade_xml_get_widget (xml_glob, &quot;entry_nx_xdm_host&quot;);
+	gtk_entry_set_text (GTK_ENTRY (widget), nx_conn-&gt;XdmHost);
+
+	widget = glade_xml_get_widget (xml_glob, &quot;spinbutton_nx_xdm_port&quot;);
+	gtk_spin_button_set_value (GTK_SPIN_BUTTON (widget), nx_conn-&gt;XdmPort);
+
+	widget = glade_xml_get_widget (xml_glob, &quot;combobox_nx_window_size&quot;);
+	if (nx_conn-&gt;FullScreen) {
+		set_combobox (widget, &quot;Full Screen&quot;);	
+	} else {
+
+		if (nx_conn-&gt;ResolutionWidth == 640 
+		    &amp;&amp; nx_conn-&gt;ResolutionHeight == 480) {
+			set_combobox (widget, &quot;640 x 480&quot;);	
+		} else if (nx_conn-&gt;ResolutionWidth == 800
+		    &amp;&amp; nx_conn-&gt;ResolutionHeight == 600) {
+			set_combobox (widget, &quot;800 x 600&quot;);
+		} else if (nx_conn-&gt;ResolutionWidth == 1024
+		    &amp;&amp; nx_conn-&gt;ResolutionHeight == 768) {
+			set_combobox (widget, &quot;1024 x 768&quot;);
+		} else if (nx_conn-&gt;ResolutionWidth == 1280
+		    &amp;&amp; nx_conn-&gt;ResolutionHeight == 1024) {
+			set_combobox (widget, &quot;1280 x 1024&quot;);
+		} else {
+			set_combobox (widget, &quot;Custom&quot;);
+		}
+	}
+
+	widget = glade_xml_get_widget (xml_glob, &quot;spinbutton_nx_width&quot;);
+	gtk_spin_button_set_value (GTK_SPIN_BUTTON (widget), nx_conn-&gt;ResolutionWidth);
+
+	widget = glade_xml_get_widget (xml_glob, &quot;spinbutton_nx_height&quot;);
+	gtk_spin_button_set_value (GTK_SPIN_BUTTON (widget), nx_conn-&gt;ResolutionHeight);
+
+	widget = glade_xml_get_widget (xml_glob, &quot;combobox_nx_image_encoding&quot;);
+	switch (nx_conn-&gt;ImageEncoding) {
+	case 1:
+		set_combobox (widget, &quot;PNG&quot;);
+		break;
+	case 2:
+		set_combobox (widget, &quot;JPEG&quot;);
+		break;
+	case 3:
+		set_combobox (widget, &quot;X Bitmap&quot;);
+		break;
+	default:
+		set_combobox (widget, &quot;Default&quot;);
+		break;
+	}
+
+	widget = glade_xml_get_widget (xml_glob, &quot;spinbutton_nx_jpeg_quality&quot;);
+	gtk_spin_button_set_value (GTK_SPIN_BUTTON (widget), nx_conn-&gt;JPEGQuality);
+
+	/* SSL key */
+	widget = glade_xml_get_widget (xml_glob, &quot;textview_nx_key&quot;);
+	buffer = gtk_text_view_get_buffer (GTK_TEXT_VIEW (widget));
+	gtk_text_buffer_set_text (buffer, nx_conn-&gt;PublicKey, -1);
+
+	/* Enable sound */
+	widget = glade_xml_get_widget (xml_glob, &quot;checkbutton_nx_enable_sound&quot;);
+	gtk_toggle_button_set_active(GTK_TOGGLE_BUTTON (widget), 
+				     nx_conn-&gt;enableSound ? TRUE : FALSE); 
+	return;
+}
+
+
+/*!
+ * Pass the name of the NX connection then read from suitable config
+ * file into an nx_connection data structure and use this to set the
+ * fields in the pop up window.
+ *
+ */
+void setup_new_nx_popup (const gchar * name)
+{
+	struct nx_connection * nx_conn;
+	nx_conn = nx_connection_malloc ();
+	read_nx_connection (nx_conn, name);
+	setup_nx_popup (nx_conn);
+	nx_connection_free (nx_conn);
+	return;
+}
+
+/*!
+ * This function re-sets the NX popup to have
+ * zero or default values.
+ */
+void zero_new_nx_popup (void)
+{
+	struct nx_connection * nx_conn;
+	nx_conn = nx_connection_malloc ();
+	nx_connection_zero (nx_conn);
+	setup_nx_popup (nx_conn);
+	nx_connection_free (nx_conn);
+	return;
+}
+
+/*!
+ * This function sets up name, server, user and fullscreen with data
+ * taken from the submitted form data in conn_new_nx dialog. This is
+ * not required in nxlaunch, but is used by another program which
+ * links to callbacks_nx.c
+ *
+ * It also sets up the data in nx_conn (which will be written to the
+ * config files) with values taken from the conn_new_nx dialog. This
+ * is the really important action as far as nxlaunch is concerned. You
+ * can just malloc some fields NX_FIELDLEN in size and pass the
+ * pointers to this function in nxlaunch and similar programs.
+ *
+ * \param name Filled with the name for the connection.
+ *
+ * \param server Filled with the server ip or address
+ *
+ * \param uname Filled with the username for the connection
+ *
+ * \param fullscreen Set &gt;0 if the connection is fullscreen
+ *
+ * \param nx_conn Filled with all the details of the connection (name,
+ * server, username and fullscreen are all in here)
+ */
+void read_nx_popup (gchar * name, gchar * server, gchar * uname, int * fullscreen,
+		    struct nx_connection * nx_conn)
+{
+	GtkWidget * widget;
+	GtkTextBuffer * buffer;
+	GtkTextIter start, end;
+	GtkTreeIter iter;
+	GtkListStore * nxList;
+	gchar * str;
+
+	/* Used to get the connection capacity hscale value */
+	gdouble speed;
+	guint speed_as_int;
+
+	str = g_malloc0 (512 * sizeof (gchar));
+
+	/*
+	 * The Network Tab.
+	 */
+
+	widget = glade_xml_get_widget(xml_glob, &quot;entry_nx_connection_name&quot;);
+	strncpy (name, gtk_entry_get_text (GTK_ENTRY (widget)), NX_FIELDLEN);
+	strncpy (nx_conn-&gt;ConnectionName, 
+		 gtk_entry_get_text (GTK_ENTRY (widget)), NX_FIELDLEN);
+
+
+	widget = glade_xml_get_widget(xml_glob, &quot;entry_nx_server&quot;);
+	strncpy (server, gtk_entry_get_text (GTK_ENTRY (widget)), NX_FIELDLEN);
+	strncpy (nx_conn-&gt;ServerHost,
+		 gtk_entry_get_text (GTK_ENTRY (widget)), NX_FIELDLEN);
+
+
+	widget = glade_xml_get_widget (xml_glob, &quot;spinbutton_nx_port&quot;);
+	nx_conn-&gt;ServerPort = gtk_spin_button_get_value_as_int (GTK_SPIN_BUTTON (widget));
+
+	widget = glade_xml_get_widget(xml_glob, &quot;entry_nx_user&quot;);
+	strncpy (nx_conn-&gt;User, 
+		 gtk_entry_get_text (GTK_ENTRY (widget)), NX_FIELDLEN);
+	strncpy (uname, gtk_entry_get_text (GTK_ENTRY (widget)), NX_FIELDLEN);
+
+	widget = glade_xml_get_widget(xml_glob, &quot;checkbutton_nx_save_password&quot;);
+	if (gtk_toggle_button_get_active(GTK_TOGGLE_BUTTON (widget))) {
+		nx_conn-&gt;RememberPassword = TRUE;
+	} else {
+		nx_conn-&gt;RememberPassword = FALSE;
+	}
+
+	widget = glade_xml_get_widget(xml_glob, &quot;checkbutton_nx_disable_no_delay&quot;);
+	if (gtk_toggle_button_get_active(GTK_TOGGLE_BUTTON (widget))) {
+		nx_conn-&gt;DisableNoDelay = TRUE;
+	} else {
+		nx_conn-&gt;DisableNoDelay = FALSE;
+	}
+
+	widget = glade_xml_get_widget(xml_glob, &quot;checkbutton_nx_disable_zlib&quot;);
+	if (gtk_toggle_button_get_active(GTK_TOGGLE_BUTTON (widget))) {
+		nx_conn-&gt;DisableZLIB = TRUE;
+	} else {
+		nx_conn-&gt;DisableZLIB = FALSE;
+	}
+
+	widget = glade_xml_get_widget(xml_glob, &quot;checkbutton_nx_enable_ssl_for_all&quot;);
+	if (gtk_toggle_button_get_active(GTK_TOGGLE_BUTTON (widget))) {
+		nx_conn-&gt;EnableSSLOnly = TRUE;
+	} else {
+		nx_conn-&gt;EnableSSLOnly = FALSE;
+	}
+
+	widget = glade_xml_get_widget(xml_glob, &quot;hscale_nx_connection_capacity&quot;);
+	speed = gtk_range_get_value (GTK_RANGE (widget));
+	if (speed &gt; 5 || speed &lt; 0) {
+		/* error set to default of adsl (middle of the range) */
+		strncpy (nx_conn-&gt;LinkSpeed, &quot;adsl&quot;, NX_FIELDLEN);
+	} else {
+		speed_as_int = (guint)speed;
+		switch (speed_as_int) {
+		case 1:
+			strncpy (nx_conn-&gt;LinkSpeed, &quot;modem&quot;, NX_FIELDLEN);
+			break;
+		case 2:
+			strncpy (nx_conn-&gt;LinkSpeed, &quot;isdn&quot;, NX_FIELDLEN);
+			break;
+		case 3:
+			strncpy (nx_conn-&gt;LinkSpeed, &quot;adsl&quot;, NX_FIELDLEN);
+			break;
+		case 4:
+			strncpy (nx_conn-&gt;LinkSpeed, &quot;wan&quot;, NX_FIELDLEN);
+			break;
+		case 5:
+			strncpy (nx_conn-&gt;LinkSpeed, &quot;lan&quot;, NX_FIELDLEN);
+			break;
+		default:
+			strncpy (nx_conn-&gt;LinkSpeed, &quot;adsl&quot;, NX_FIELDLEN);
+			break;
+		}
+	}
+
+
+	/*
+	 * The Desktop Tab 
+	 */
+
+	widget = glade_xml_get_widget (xml_glob, &quot;combobox_nx_desktop_session&quot;);
+	nxList = GTK_LIST_STORE (gtk_combo_box_get_model (GTK_COMBO_BOX (widget)));
+	printerr (&quot;Getting active iter for desktop session list..\n&quot;);
+	gtk_combo_box_get_active_iter (GTK_COMBO_BOX (widget), &amp;iter);
+	gtk_tree_model_get (GTK_TREE_MODEL (nxList), &amp;iter, PROGRAM, &amp;str, -1);
+
+	if (strstr (str, _(&quot;KDE&quot;))) {
+		strncpy (nx_conn-&gt;Desktop, &quot;kde&quot;, NX_FIELDLEN);
+		strncpy (nx_conn-&gt;CustomUnixDesktop, &quot;console&quot;, NX_FIELDLEN);
+
+	} else if (strstr (str, _(&quot;GNOME&quot;))) {
+		strncpy (nx_conn-&gt;Desktop, &quot;gnome&quot;, NX_FIELDLEN);
+		strncpy (nx_conn-&gt;CustomUnixDesktop, &quot;console&quot;, NX_FIELDLEN);
+
+	} else if (strstr (str, _(&quot;CDE&quot;))) {
+		strncpy (nx_conn-&gt;Desktop, &quot;cde&quot;, NX_FIELDLEN);
+		strncpy (nx_conn-&gt;CustomUnixDesktop, &quot;console&quot;, NX_FIELDLEN);
+
+	} else if (strstr (str, _(&quot;XDM&quot;))) {
+		strncpy (nx_conn-&gt;Desktop, &quot;xdm&quot;, NX_FIELDLEN);
+		strncpy (nx_conn-&gt;CustomUnixDesktop, &quot;console&quot;, NX_FIELDLEN);
+
+	} else if (strstr (str, _(&quot;Console&quot;))) {
+		strncpy (nx_conn-&gt;Desktop, &quot;console&quot;, NX_FIELDLEN);
+		strncpy (nx_conn-&gt;CustomUnixDesktop, &quot;console&quot;, NX_FIELDLEN);
+
+	} else if (strstr (str, _(&quot;Default X client script on server&quot;))) {
+		strncpy (nx_conn-&gt;Desktop, &quot;console&quot;, NX_FIELDLEN);
+		strncpy (nx_conn-&gt;CustomUnixDesktop, &quot;default&quot;, NX_FIELDLEN);
+
+	} else if (strstr (str, _(&quot;Custom command&quot;))) {
+		strncpy (nx_conn-&gt;Desktop, &quot;console&quot;, NX_FIELDLEN);
+		strncpy (nx_conn-&gt;CustomUnixDesktop, &quot;application&quot;, NX_FIELDLEN);
+
+	} else {
+		strncpy (nx_conn-&gt;Desktop, &quot;kde&quot;, NX_FIELDLEN);
+		strncpy (nx_conn-&gt;CustomUnixDesktop, &quot;console&quot;, NX_FIELDLEN);
+	}
+
+	widget = glade_xml_get_widget(xml_glob, &quot;entry_nx_custom_command&quot;);
+	strncpy (nx_conn-&gt;CommandLine, gtk_entry_get_text (GTK_ENTRY (widget)), CMDLINELEN);
+
+	widget = glade_xml_get_widget(xml_glob, &quot;radiobutton_nx_new_virtual_desktop&quot;);
+	if (gtk_toggle_button_get_active(GTK_TOGGLE_BUTTON (widget))) {
+		nx_conn-&gt;VirtualDesktop = TRUE;
+	} else {
+		nx_conn-&gt;VirtualDesktop = FALSE;
+	}
+
+	widget = glade_xml_get_widget(xml_glob, &quot;checkbutton_nx_disable_x_agent&quot;);
+	if (gtk_toggle_button_get_active(GTK_TOGGLE_BUTTON (widget))) {
+		nx_conn-&gt;XAgentEncoding = FALSE;
+	} else {
+		nx_conn-&gt;XAgentEncoding = TRUE;
+	}
+
+	widget = glade_xml_get_widget(xml_glob, &quot;checkbutton_nx_disable_x_replies&quot;);
+	if (gtk_toggle_button_get_active(GTK_TOGGLE_BUTTON (widget))) {
+		nx_conn-&gt;UseTaint = FALSE;
+	} else {
+		nx_conn-&gt;UseTaint = TRUE;
+	}
+	
+	widget = glade_xml_get_widget (xml_glob, &quot;combobox_nx_xdm_mode&quot;);
+	nxList = GTK_LIST_STORE (gtk_combo_box_get_model (GTK_COMBO_BOX (widget)));
+	printerr (&quot;Getting active iter for xdm mode..\n&quot;);
+	gtk_combo_box_get_active_iter (GTK_COMBO_BOX (widget), &amp;iter);
+	gtk_tree_model_get (GTK_TREE_MODEL (nxList), &amp;iter, PROGRAM, &amp;str, -1);
+
+	if (strstr (str, _(&quot;Let NX server decide&quot;))) {
+		strncpy (nx_conn-&gt;XdmMode, &quot;server decide&quot;, NX_FIELDLEN);
+
+	} else if (strstr (str, _(&quot;Send an XDM query to a host&quot;))) {
+		strncpy (nx_conn-&gt;XdmMode, &quot;query&quot;, NX_FIELDLEN);
+
+	} else if (strstr (str, _(&quot;Broadcast an XDM query&quot;))) {
+		strncpy (nx_conn-&gt;XdmMode, &quot;broadcast&quot;, NX_FIELDLEN);
+
+	} else if (strstr (str, _(&quot;Get a list of available X display managers&quot;))) {
+		strncpy (nx_conn-&gt;XdmMode, &quot;list&quot;, NX_FIELDLEN);
+
+	} else {
+		strncpy (nx_conn-&gt;XdmMode, &quot;server decide&quot;, NX_FIELDLEN);
+	}
+
+	widget = glade_xml_get_widget(xml_glob, &quot;entry_nx_xdm_host&quot;);
+	strncpy (nx_conn-&gt;XdmHost, gtk_entry_get_text (GTK_ENTRY (widget)), NX_FIELDLEN);
+
+	widget = glade_xml_get_widget (xml_glob, &quot;spinbutton_nx_xdm_port&quot;);
+	nx_conn-&gt;XdmPort = gtk_spin_button_get_value_as_int (GTK_SPIN_BUTTON (widget));
+
+	widget = glade_xml_get_widget (xml_glob, &quot;combobox_nx_window_size&quot;);
+	nxList = GTK_LIST_STORE (gtk_combo_box_get_model (GTK_COMBO_BOX (widget)));
+	printerr (&quot;Getting active iter for nx window size..\n&quot;);
+	gtk_combo_box_get_active_iter (GTK_COMBO_BOX (widget), &amp;iter);
+	gtk_tree_model_get (GTK_TREE_MODEL (nxList), &amp;iter, PROGRAM, &amp;str, -1);
+
+	if (strstr (str, &quot;640 x 480&quot;)) {
+		nx_conn-&gt;FullScreen = FALSE;
+		*fullscreen = 0;
+		nx_conn-&gt;ResolutionWidth = 640;
+		nx_conn-&gt;ResolutionHeight = 480;
+
+	} else if (strstr (str, &quot;800 x 600&quot;)) {
+		nx_conn-&gt;FullScreen = FALSE;
+		*fullscreen = 0;
+		nx_conn-&gt;ResolutionWidth = 800;
+		nx_conn-&gt;ResolutionHeight = 600;
+
+	} else if (strstr (str, &quot;1024 x 768&quot;)) {
+		nx_conn-&gt;FullScreen = FALSE;
+		*fullscreen = 0;
+		nx_conn-&gt;ResolutionWidth = 1024;
+		nx_conn-&gt;ResolutionHeight = 768;
+
+	} else if (strstr (str, &quot;1280 x 1024&quot;)) {
+		nx_conn-&gt;FullScreen = FALSE;
+		*fullscreen = 0;
+		nx_conn-&gt;ResolutionWidth = 1280;
+		nx_conn-&gt;ResolutionHeight = 1024;
+
+	} else if (strstr (str, _(&quot;Custom&quot;))) {
+		nx_conn-&gt;FullScreen = FALSE;
+		*fullscreen = 0;
+		/* Set from widgets */
+		widget = glade_xml_get_widget (xml_glob, &quot;spinbutton_nx_width&quot;);
+		nx_conn-&gt;ResolutionWidth = gtk_spin_button_get_value_as_int (GTK_SPIN_BUTTON (widget));
+		widget = glade_xml_get_widget (xml_glob, &quot;spinbutton_nx_height&quot;);
+		nx_conn-&gt;ResolutionHeight = gtk_spin_button_get_value_as_int (GTK_SPIN_BUTTON (widget));
+
+	} else if (strstr (str, _(&quot;Full Screen&quot;))) {
+		nx_conn-&gt;FullScreen = TRUE;
+		*fullscreen = 1;
+		nx_conn-&gt;ResolutionWidth = 800;
+		nx_conn-&gt;ResolutionHeight = 600;
+
+	} else {
+		nx_conn-&gt;FullScreen = TRUE;
+		*fullscreen = 1;
+		nx_conn-&gt;ResolutionWidth = 800;
+		nx_conn-&gt;ResolutionHeight = 600;
+	}
+
+	widget = glade_xml_get_widget (xml_glob, &quot;combobox_nx_image_encoding&quot;);
+	nxList = GTK_LIST_STORE (gtk_combo_box_get_model (GTK_COMBO_BOX (widget)));
+	printerr (&quot;Getting active iter for image encoding..\n&quot;);
+	gtk_combo_box_get_active_iter (GTK_COMBO_BOX (widget), &amp;iter);
+	gtk_tree_model_get (GTK_TREE_MODEL (nxList), &amp;iter, PROGRAM, &amp;str, -1);
+
+	if (strstr (str, _(&quot;Default&quot;))) {
+		nx_conn-&gt;ImageEncoding = 0;
+	} else if (strstr (str, _(&quot;PNG&quot;))) {
+		nx_conn-&gt;ImageEncoding = 1;
+	} else if (strstr (str, _(&quot;JPEG&quot;))) {
+		nx_conn-&gt;ImageEncoding = 2;
+	} else if (strstr (str, _(&quot;X Bitmap&quot;))) {
+		nx_conn-&gt;ImageEncoding = 3;
+	} else {
+		nx_conn-&gt;ImageEncoding = 0;
+	}
+
+	widget = glade_xml_get_widget (xml_glob, &quot;spinbutton_nx_jpeg_quality&quot;);
+	nx_conn-&gt;JPEGQuality = gtk_spin_button_get_value_as_int (GTK_SPIN_BUTTON (widget));
+
+	g_free (str);
+
+	/*
+	 * The SSH Public Key
+	 *
+	 * We'll read this from the relevant window, which should default to the 
+	 * standard NX public key.
+	 */
+	widget = glade_xml_get_widget (xml_glob, &quot;textview_nx_key&quot;);
+	buffer = gtk_text_view_get_buffer (GTK_TEXT_VIEW (widget));
+	printerr (&quot;gtk_text_buffer_get_start_iter (buffer, &amp;start);\n&quot;);
+	gtk_text_buffer_get_start_iter (buffer, &amp;start);
+	printerr (&quot;gtk_text_buffer_get_end_iter (buffer, &amp;end);\n&quot;);
+	gtk_text_buffer_get_end_iter (buffer, &amp;end);
+
+	str = NULL;
+	printerr (&quot;gtk_text_buffer_get_text (buffer, &amp;start, &amp;end, FALSE);\n&quot;);
+	str = gtk_text_buffer_get_text (buffer, &amp;start, &amp;end, FALSE);
+	if (str != NULL) {
+		strncpy (nx_conn-&gt;PublicKey,
+			 str,
+			 SSLKEYLEN-1);
+	} else {
+		strncpy (nx_conn-&gt;PublicKey, NXDefaultKey, SSLKEYLEN-1);
+	}
+
+	/* Enable Sound Checkbutton */
+	widget = glade_xml_get_widget(xml_glob, &quot;checkbutton_nx_enable_sound&quot;);
+	if (gtk_toggle_button_get_active(GTK_TOGGLE_BUTTON (widget))) {
+		nx_conn-&gt;enableSound = TRUE;
+	} else {
+		nx_conn-&gt;enableSound = FALSE;
+	}
+
+	return;
+}
+
+
+/**
+ * check that we have ~/.nx/config and ~/.nx/config/nxclient.conf 
+ * 
+ * This function gets called when hcconnect boots.
+ */
+void nx_check_config (void)
+{
+	struct stat * buf;
+	buf = g_malloc0 (sizeof (struct stat));
+	gchar tmp[1024];
+	char* homepath;
+
+	homepath = getenv(&quot;HOME&quot;);
+
+	/* Check we have the required config files */
+	snprintf (tmp, 1023, &quot;%s/.nx/config&quot;, homepath);
+	stat (tmp, buf);
+	if (!S_ISDIR (buf-&gt;st_mode)) {
+		snprintf (tmp, 1023, &quot;mkdir -p %s/.nx/config&quot;, homepath);
+		system (tmp);
+		nx_writeout_nxclient_conf ();
+	} else {
+		snprintf (tmp, 1023, &quot;%s/.nx/config/nxclient.conf&quot;, homepath);
+		stat (tmp, buf);
+		if (!S_ISREG (buf-&gt;st_mode)) {
+			nx_writeout_nxclient_conf ();
+		}
+	}
+
+	g_free (buf);
+
+	return;
+}
+
+
+/**
+ * Just writes out the nxclient.conf file
+ */
+gint nx_writeout_nxclient_conf (void)
+{
+	FILE * fp;
+	char* homepath;
+	gchar path[1024];
+
+	homepath = getenv(&quot;HOME&quot;);
+	snprintf (path, 1023, &quot;%s/.nx/nxclient.conf&quot;, homepath);
+	fp = fopen (path, &quot;w&quot;);
+	if (fp) {
+		fwrite (nxclient_conf, sizeof (gchar), strlen (nxclient_conf),  fp); 
+		fclose (fp);
+		return 0;
+	}
+
+	return -1;
+}
+
+
+/*
+ * Next functions are callbacks to handle the correct greying out
+ * of controls, for example, greying out the extra settings, when a
+ * GNOME desktop session is chosen.
+ */
+
+
+void set_custom_settings_sensitivity (void)
+{
+	GtkWidget * widget;
+	GtkTreeIter iter;
+	GtkListStore * nxList;
+	gchar * str;
+	gboolean rtn;
+
+	widget = glade_xml_get_widget (xml_glob, &quot;combobox_nx_desktop_session&quot;);
+	nxList = GTK_LIST_STORE (gtk_combo_box_get_model (GTK_COMBO_BOX (widget)));
+	rtn = gtk_combo_box_get_active_iter (GTK_COMBO_BOX (widget), &amp;iter);
+	if (!rtn) {
+		return;
+	}
+	gtk_tree_model_get (GTK_TREE_MODEL (nxList), &amp;iter, PROGRAM, &amp;str, -1);
+
+	if (strstr (str, _(&quot;KDE&quot;))) {
+		grey_all_custom_settings ();
+
+	} else if (strstr (str, _(&quot;GNOME&quot;))) {
+		grey_all_custom_settings ();
+
+	} else if (strstr (str, _(&quot;CDE&quot;))) {
+		grey_all_custom_settings ();
+
+	} else if (strstr (str, _(&quot;Console&quot;))) {
+		/* ungrey options, grey command box */
+		ungrey_custom_options ();
+		widget = glade_xml_get_widget (xml_glob, &quot;entry_nx_custom_command&quot;);
+		gtk_widget_set_sensitive (widget, FALSE);
+		widget = glade_xml_get_widget (xml_glob, &quot;label_nx_custom_command&quot;);
+		gtk_widget_set_sensitive (widget, FALSE);
+
+	} else if (strstr (str, _(&quot;Default X client script on server&quot;))) {
+		/* ungrey options, grey command box */
+		ungrey_custom_options ();
+		widget = glade_xml_get_widget (xml_glob, &quot;entry_nx_custom_command&quot;);
+		gtk_widget_set_sensitive (widget, FALSE);
+		widget = glade_xml_get_widget (xml_glob, &quot;label_nx_custom_command&quot;);
+		gtk_widget_set_sensitive (widget, FALSE);
+
+	} else if (strstr (str, _(&quot;Custom command&quot;))) {
+		/* ungrey all custom settings */
+		ungrey_custom_options ();
+		widget = glade_xml_get_widget (xml_glob, &quot;entry_nx_custom_command&quot;);
+		gtk_widget_set_sensitive (widget, TRUE);
+		widget = glade_xml_get_widget (xml_glob, &quot;label_nx_custom_command&quot;);
+		gtk_widget_set_sensitive (widget, TRUE);
+
+
+	} else {
+		grey_all_custom_settings ();
+	}
+
+	return;
+}
+
+void grey_all_custom_settings (void)
+{
+	GtkWidget * widget;
+
+	widget = glade_xml_get_widget (xml_glob, &quot;radiobutton_nx_floating_window&quot;);
+	gtk_widget_set_sensitive (widget, FALSE);
+	widget = glade_xml_get_widget (xml_glob, &quot;radiobutton_nx_new_virtual_desktop&quot;);
+	gtk_widget_set_sensitive (widget, FALSE);
+	widget = glade_xml_get_widget (xml_glob, &quot;checkbutton_nx_disable_x_agent&quot;);
+	gtk_widget_set_sensitive (widget, FALSE);
+	widget = glade_xml_get_widget (xml_glob, &quot;checkbutton_nx_disable_x_replies&quot;);
+	gtk_widget_set_sensitive (widget, FALSE);
+	widget = glade_xml_get_widget (xml_glob, &quot;frame_nx_custom_settings&quot;);
+	gtk_widget_set_sensitive (widget, FALSE);
+
+	return;
+}
+
+void ungrey_custom_options (void) 
+{
+	GtkWidget * widget;
+
+	widget = glade_xml_get_widget (xml_glob, &quot;frame_nx_custom_settings&quot;);
+	gtk_widget_set_sensitive (widget, TRUE);
+	widget = glade_xml_get_widget (xml_glob, &quot;label_nx_custom_settings&quot;);
+	gtk_widget_set_sensitive (widget, TRUE);
+	widget = glade_xml_get_widget (xml_glob, &quot;radiobutton_nx_floating_window&quot;);
+	gtk_widget_set_sensitive (widget, TRUE);
+	widget = glade_xml_get_widget (xml_glob, &quot;radiobutton_nx_new_virtual_desktop&quot;);
+	gtk_widget_set_sensitive (widget, TRUE);
+
+	if (gtk_toggle_button_get_active (GTK_TOGGLE_BUTTON (widget))) {
+		/* desensitise checkbutton_nx_disable_x_agent 
+		   and checkbutton_nx_disable_x_replies */
+		widget = glade_xml_get_widget (xml_glob, &quot;checkbutton_nx_disable_x_agent&quot;);
+		gtk_widget_set_sensitive (widget, FALSE);
+		widget = glade_xml_get_widget (xml_glob, &quot;checkbutton_nx_disable_x_replies&quot;);
+		gtk_widget_set_sensitive (widget, FALSE);
+	} else {
+		widget = glade_xml_get_widget (xml_glob, &quot;checkbutton_nx_disable_x_agent&quot;);
+		gtk_widget_set_sensitive (widget, TRUE);
+		if (gtk_toggle_button_get_active (GTK_TOGGLE_BUTTON (widget))) {
+			widget = glade_xml_get_widget (xml_glob, &quot;checkbutton_nx_disable_x_replies&quot;);
+			gtk_widget_set_sensitive (widget, TRUE);
+		}
+	}	
+}
+
+void set_xdm_settings (void)
+{
+	GtkWidget * widget;
+	GtkTreeIter iter1;
+	GtkListStore * nxList1;
+	gchar * str1;
+	gboolean rtn = FALSE;
+
+	widget = glade_xml_get_widget (xml_glob, &quot;frame_nx_xdm&quot;);
+	gtk_widget_set_sensitive (widget, TRUE);
+	widget = glade_xml_get_widget (xml_glob, &quot;label_nx_xdm&quot;);
+	gtk_widget_set_sensitive (widget, TRUE);
+
+	widget = glade_xml_get_widget (xml_glob, &quot;combobox_nx_xdm_mode&quot;);
+	gtk_widget_set_sensitive (widget, TRUE);
+	nxList1 = GTK_LIST_STORE (gtk_combo_box_get_model (GTK_COMBO_BOX (widget)));
+	rtn = gtk_combo_box_get_active_iter (GTK_COMBO_BOX (widget), &amp;iter1);
+	if (!rtn) {
+		return;
+	} 
+
+	gtk_tree_model_get (GTK_TREE_MODEL (nxList1), &amp;iter1, PROGRAM, &amp;str1, -1);
+
+	if (strstr (str1, _(&quot;Let NX server decide&quot;))) {
+		widget = glade_xml_get_widget (xml_glob, &quot;entry_nx_xdm_host&quot;);
+		gtk_widget_set_sensitive (widget, FALSE);
+		widget = glade_xml_get_widget (xml_glob, &quot;spinbutton_nx_xdm_port&quot;);
+		gtk_widget_set_sensitive (widget, FALSE);
+		widget = glade_xml_get_widget (xml_glob, &quot;label_nx_xdm_host&quot;);
+		gtk_widget_set_sensitive (widget, FALSE);
+		widget = glade_xml_get_widget (xml_glob, &quot;label_nx_xdm_port&quot;);
+		gtk_widget_set_sensitive (widget, FALSE);
+
+	} else if (strstr (str1, _(&quot;Send an XDM query to a host&quot;))) {
+		widget = glade_xml_get_widget (xml_glob, &quot;entry_nx_xdm_host&quot;);
+		gtk_widget_set_sensitive (widget, TRUE);
+		widget = glade_xml_get_widget (xml_glob, &quot;spinbutton_nx_xdm_port&quot;);
+		gtk_widget_set_sensitive (widget, TRUE);
+		widget = glade_xml_get_widget (xml_glob, &quot;label_nx_xdm_host&quot;);
+		gtk_widget_set_sensitive (widget, TRUE);
+		widget = glade_xml_get_widget (xml_glob, &quot;label_nx_xdm_port&quot;);
+		gtk_widget_set_sensitive (widget, TRUE);
+
+	} else if (strstr (str1, _(&quot;Broadcast an XDM query&quot;))) {
+		widget = glade_xml_get_widget (xml_glob, &quot;entry_nx_xdm_host&quot;);
+		gtk_widget_set_sensitive (widget, FALSE);
+		widget = glade_xml_get_widget (xml_glob, &quot;spinbutton_nx_xdm_port&quot;);
+		gtk_widget_set_sensitive (widget, TRUE);
+		widget = glade_xml_get_widget (xml_glob, &quot;label_nx_xdm_host&quot;);
+		gtk_widget_set_sensitive (widget, FALSE);
+		widget = glade_xml_get_widget (xml_glob, &quot;label_nx_xdm_port&quot;);
+		gtk_widget_set_sensitive (widget, TRUE);
+
+	} else if (strstr (str1, _(&quot;Get a list of available X display managers&quot;))) {
+		widget = glade_xml_get_widget (xml_glob, &quot;entry_nx_xdm_host&quot;);
+		gtk_widget_set_sensitive (widget, TRUE);
+		widget = glade_xml_get_widget (xml_glob, &quot;spinbutton_nx_xdm_port&quot;);
+		gtk_widget_set_sensitive (widget, TRUE);
+		widget = glade_xml_get_widget (xml_glob, &quot;label_nx_xdm_host&quot;);
+		gtk_widget_set_sensitive (widget, TRUE);
+		widget = glade_xml_get_widget (xml_glob, &quot;label_nx_xdm_port&quot;);
+		gtk_widget_set_sensitive (widget, TRUE);
+
+	} else {
+		widget = glade_xml_get_widget (xml_glob, &quot;entry_nx_xdm_host&quot;);
+		gtk_widget_set_sensitive (widget, FALSE);
+		widget = glade_xml_get_widget (xml_glob, &quot;spinbutton_nx_xdm_port&quot;);
+		gtk_widget_set_sensitive (widget, FALSE);
+		widget = glade_xml_get_widget (xml_glob, &quot;label_nx_xdm_host&quot;);
+		gtk_widget_set_sensitive (widget, FALSE);
+		widget = glade_xml_get_widget (xml_glob, &quot;label_nx_xdm_port&quot;);
+		gtk_widget_set_sensitive (widget, FALSE);
+	}
+
+	return;
+}
+
+
+int set_xdm_settings_sensitivity_do_work (void)
+{
+	GtkWidget * widget;
+	GtkTreeIter iter;
+	GtkListStore * nxList;
+	gchar * str;
+	gint rtn = 0;
+	
+	widget = glade_xml_get_widget (xml_glob, &quot;combobox_nx_desktop_session&quot;);
+	nxList = GTK_LIST_STORE (gtk_combo_box_get_model (GTK_COMBO_BOX (widget)));
+	gtk_combo_box_get_active_iter (GTK_COMBO_BOX (widget), &amp;iter);
+	gtk_tree_model_get (GTK_TREE_MODEL (nxList), &amp;iter, PROGRAM, &amp;str, -1);
+
+	if (strstr (str, _(&quot;KDE&quot;))) {
+		grey_all_xdm_settings ();
+
+	} else if (strstr (str, _(&quot;GNOME&quot;))) {
+		grey_all_xdm_settings ();
+
+	} else if (strstr (str, _(&quot;CDE&quot;))) {
+		grey_all_xdm_settings ();
+
+	} else if (strstr (str, _(&quot;XDM&quot;))) {
+		rtn = 10;
+
+	} else if (strstr (str, _(&quot;Console&quot;))) {
+		grey_all_xdm_settings ();
+
+	} else if (strstr (str, _(&quot;Default X client script on server&quot;))) {
+		grey_all_xdm_settings ();
+
+	} else if (strstr (str, _(&quot;Custom command&quot;))) {
+		grey_all_xdm_settings ();
+	} else {
+		grey_all_xdm_settings ();
+	}
+
+	return rtn;
+}
+
+void set_xdm_settings_sensitivity (void)
+{
+	if (set_xdm_settings_sensitivity_do_work () == 10) {
+		set_xdm_settings ();
+	}
+	return;
+}
+
+
+void grey_all_xdm_settings (void)
+{
+	GtkWidget * widget;
+
+	widget = glade_xml_get_widget (xml_glob, &quot;combobox_nx_xdm_mode&quot;);
+	gtk_widget_set_sensitive (widget, FALSE);
+	widget = glade_xml_get_widget (xml_glob, &quot;entry_nx_xdm_host&quot;);
+	gtk_widget_set_sensitive (widget, FALSE);
+	widget = glade_xml_get_widget (xml_glob, &quot;spinbutton_nx_xdm_port&quot;);
+	gtk_widget_set_sensitive (widget, FALSE);
+	widget = glade_xml_get_widget (xml_glob, &quot;label_nx_xdm_host&quot;);
+	gtk_widget_set_sensitive (widget, FALSE);
+	widget = glade_xml_get_widget (xml_glob, &quot;label_nx_xdm_port&quot;);
+	gtk_widget_set_sensitive (widget, FALSE);
+	widget = glade_xml_get_widget (xml_glob, &quot;frame_nx_xdm&quot;);
+	gtk_widget_set_sensitive (widget, FALSE);
+
+	return;
+}
+
+void on_combobox_nx_desktop_session_changed (GtkComboBox * box)
+{
+	set_xdm_settings_sensitivity ();
+	set_custom_settings_sensitivity ();
+	return;
+}
+
+void on_combobox_nx_xdm_mode_changed (GtkComboBox * box)
+{
+	set_xdm_settings_sensitivity ();
+}
+
+void on_radiobutton_nx_new_virtual_desktop_toggled (GtkToggleButton * button)
+{
+	set_custom_settings_sensitivity ();
+}
+
+void on_checkbutton_nx_disable_x_agent_toggled (GtkToggleButton * button)
+{
+	GtkWidget * widget;
+
+	widget = glade_xml_get_widget(xml_glob, &quot;checkbutton_nx_disable_x_agent&quot;);
+	gtk_widget_set_sensitive (widget, TRUE);
+	if (gtk_toggle_button_get_active(GTK_TOGGLE_BUTTON (widget))) {
+		widget = glade_xml_get_widget(xml_glob, &quot;checkbutton_nx_disable_x_replies&quot;);
+		gtk_widget_set_sensitive (widget, TRUE);
+	} else {
+		widget = glade_xml_get_widget(xml_glob, &quot;checkbutton_nx_disable_x_replies&quot;);
+		gtk_widget_set_sensitive (widget, FALSE);
+	}
+}
+
+void on_combobox_nx_window_size_changed (GtkComboBox * box)
+{
+	GtkWidget * widget;
+	GtkTreeIter iter;
+	GtkListStore * nxList;
+	gchar * str;
+
+	str = g_malloc0 (512 * sizeof (gchar));
+
+	nxList = GTK_LIST_STORE (gtk_combo_box_get_model (box));
+	gtk_combo_box_get_active_iter (box, &amp;iter);
+	gtk_tree_model_get (GTK_TREE_MODEL (nxList), &amp;iter, PROGRAM, &amp;str, -1);
+
+	if (strstr (str, &quot;640 x 480&quot;)) {
+		widget =  glade_xml_get_widget (xml_glob, &quot;spinbutton_nx_width&quot;);
+		gtk_widget_set_sensitive (widget, FALSE);
+		gtk_spin_button_set_value (GTK_SPIN_BUTTON (widget), (gdouble)640);
+		widget =  glade_xml_get_widget (xml_glob, &quot;spinbutton_nx_height&quot;);
+		gtk_widget_set_sensitive (widget, FALSE);
+		gtk_spin_button_set_value (GTK_SPIN_BUTTON (widget), (gdouble)480);
+
+	} else if (strstr (str, &quot;800 x 600&quot;)) {
+		widget =  glade_xml_get_widget (xml_glob, &quot;spinbutton_nx_width&quot;);
+		gtk_widget_set_sensitive (widget, FALSE);
+		gtk_spin_button_set_value (GTK_SPIN_BUTTON (widget), (gdouble)800);
+		widget =  glade_xml_get_widget (xml_glob, &quot;spinbutton_nx_height&quot;);
+		gtk_widget_set_sensitive (widget, FALSE);
+		gtk_spin_button_set_value (GTK_SPIN_BUTTON (widget), (gdouble)600);
+
+	} else if (strstr (str, &quot;1024 x 768&quot;)) {
+		widget =  glade_xml_get_widget (xml_glob, &quot;spinbutton_nx_width&quot;);
+		gtk_widget_set_sensitive (widget, FALSE);
+		gtk_spin_button_set_value (GTK_SPIN_BUTTON (widget), (gdouble)1024);
+		widget =  glade_xml_get_widget (xml_glob, &quot;spinbutton_nx_height&quot;);
+		gtk_widget_set_sensitive (widget, FALSE);
+		gtk_spin_button_set_value (GTK_SPIN_BUTTON (widget), (gdouble)768);
+
+	} else if (strstr (str, &quot;1280 x 1024&quot;)) {
+		widget =  glade_xml_get_widget (xml_glob, &quot;spinbutton_nx_width&quot;);
+		gtk_widget_set_sensitive (widget, FALSE);
+		gtk_spin_button_set_value (GTK_SPIN_BUTTON (widget), (gdouble)1280);
+		widget =  glade_xml_get_widget (xml_glob, &quot;spinbutton_nx_height&quot;);
+		gtk_widget_set_sensitive (widget, FALSE);
+		gtk_spin_button_set_value (GTK_SPIN_BUTTON (widget), (gdouble)1024);
+
+	} else if (strstr (str, _(&quot;Custom&quot;))) {
+		widget =  glade_xml_get_widget (xml_glob, &quot;spinbutton_nx_width&quot;);
+		gtk_widget_set_sensitive (widget, TRUE);
+		widget =  glade_xml_get_widget (xml_glob, &quot;spinbutton_nx_height&quot;);
+		gtk_widget_set_sensitive (widget, TRUE);
+
+	} else if (strstr (str, _(&quot;Full Screen&quot;))) {
+		widget =  glade_xml_get_widget (xml_glob, &quot;spinbutton_nx_width&quot;);
+		gtk_widget_set_sensitive (widget, FALSE);
+		widget =  glade_xml_get_widget (xml_glob, &quot;spinbutton_nx_height&quot;);
+		gtk_widget_set_sensitive (widget, FALSE);
+
+	} else {
+
+	}
+
+	g_free (str);
+
+	return;
+}
+
+
+void on_combobox_nx_image_encoding_changed (GtkComboBox * box)
+{
+	GtkWidget * widget;
+	GtkTreeIter iter;
+	GtkListStore * nxList;
+	gchar * str;
+
+	str = g_malloc0 (512 * sizeof (gchar));
+
+	nxList = GTK_LIST_STORE (gtk_combo_box_get_model (box));
+	gtk_combo_box_get_active_iter (box, &amp;iter);
+	gtk_tree_model_get (GTK_TREE_MODEL (nxList), &amp;iter, PROGRAM, &amp;str, -1);
+
+	if (strstr (str, &quot;JPEG&quot;)) {
+		widget =  glade_xml_get_widget (xml_glob, &quot;spinbutton_nx_jpeg_quality&quot;);
+		gtk_widget_set_sensitive (widget, TRUE);
+		widget =  glade_xml_get_widget (xml_glob, &quot;label_nx_jpeg_quality&quot;);
+		gtk_widget_set_sensitive (widget, TRUE);
+
+	} else {
+		widget =  glade_xml_get_widget (xml_glob, &quot;spinbutton_nx_jpeg_quality&quot;);
+		gtk_widget_set_sensitive (widget, FALSE);
+		widget =  glade_xml_get_widget (xml_glob, &quot;label_nx_jpeg_quality&quot;);
+		gtk_widget_set_sensitive (widget, FALSE);
+
+	}
+}
+
+
+void on_hscale_nx_connection_capacity_value_changed (GtkWidget * w)
+{
+	GtkWidget * label;
+	gdouble speed;
+	guint speed_as_int;
+
+	speed = gtk_range_get_value (GTK_RANGE (w));
+	label = glade_xml_get_widget(xml_glob, &quot;label_nx_connection_capacity&quot;);
+
+	if (speed &gt; 5 || speed &lt; 0) {
+		/* error set to default of adsl (middle of the range) */
+		gtk_label_set_text (GTK_LABEL (label), _(&quot;Connection capacity: ADSL&quot;));
+	} else {
+		speed_as_int = (guint)speed;
+		switch (speed_as_int) {
+		case 1:
+			gtk_label_set_text (GTK_LABEL (label), _(&quot;Connection capacity: Modem&quot;));
+			break;
+		case 2:
+			gtk_label_set_text (GTK_LABEL (label), _(&quot;Connection capacity: ISDN&quot;));
+			break;
+		case 3:
+			gtk_label_set_text (GTK_LABEL (label), _(&quot;Connection capacity: ADSL&quot;));
+			break;
+		case 4:
+			gtk_label_set_text (GTK_LABEL (label), _(&quot;Connection capacity: WAN&quot;));
+			break;
+		case 5:
+			gtk_label_set_text (GTK_LABEL (label), _(&quot;Connection capacity: LAN&quot;));
+			break;
+		default:
+			gtk_label_set_text (GTK_LABEL (label), _(&quot;Connection capacity: ADSL&quot;));
+			break;
+		}
+	}	
+}
+
+void on_button_nx_revert_ssl_key_clicked (GtkButton * button)
+{
+	GtkWidget * widget;
+	GtkTextBuffer * buffer;
+	GtkTextIter start, end;
+
+	widget = glade_xml_get_widget (xml_glob, &quot;textview_nx_key&quot;);
+	buffer = gtk_text_view_get_buffer (GTK_TEXT_VIEW (widget));
+
+	/* Delete the text first*/
+	gtk_text_buffer_get_start_iter (buffer, &amp;start);
+	gtk_text_buffer_get_end_iter (buffer, &amp;end);
+	gtk_text_buffer_delete (buffer, &amp;start, &amp;end);
+
+	gtk_text_buffer_set_text (buffer, NXDefaultKey, -1);
+	return;
+}
+
+void on_nx_key_file_chosen (GtkButton * button)
+{
+	GtkWidget * widget, * fdlg;
+	GtkTextBuffer * buffer;
+	GtkTextIter start, end;
+	FILE * fp;
+	gchar * key;
+	size_t count;
+
+	fdlg = glade_xml_get_widget (xml_glob, &quot;filechooserdialog_nx_key&quot;);	
+
+	/* open the file, copy contents to window, close filechooserdialog */
+	fp = fopen (gtk_file_chooser_get_filename (GTK_FILE_CHOOSER (fdlg)), &quot;r&quot;);
+	if (!fp) {
+		/* Couldn't open the file */
+		nx_general_error (&quot;Couldn't open file&quot;, &quot;File Error&quot;);
+		return;
+	}
+	
+	key = g_malloc0 (SSLKEYLEN * sizeof (gchar));
+
+	count = fread (key, 1, SSLKEYLEN-1, fp);
+	/* debug */
+	printerr (&quot;read %d chars\n&quot;, count);
+
+	if (ferror (fp) != 0) {
+		nx_general_error (&quot;File input/output error&quot;, &quot;File Error&quot;);	
+		fclose (fp);
+		return;
+	}
+
+	fclose (fp);
+
+	widget = glade_xml_get_widget (xml_glob, &quot;textview_nx_key&quot;);
+	buffer = gtk_text_view_get_buffer (GTK_TEXT_VIEW (widget));
+
+	/* set new key */
+	gtk_text_buffer_get_start_iter (buffer, &amp;start);
+	gtk_text_buffer_get_end_iter (buffer, &amp;end);
+	gtk_text_buffer_delete (buffer, &amp;start, &amp;end);
+	gtk_text_buffer_set_text (buffer, key, -1);
+
+	g_free (key);
+
+	gtk_widget_hide (fdlg);
+
+	return;
+}
+
+
+
+

Added: nxlaunch/lib/callbacks_nx.h
===================================================================
--- nxlaunch/lib/callbacks_nx.h	2007-09-16 20:16:05 UTC (rev 380)
+++ nxlaunch/lib/callbacks_nx.h	2007-09-17 12:30:56 UTC (rev 381)
@@ -0,0 +1,275 @@
+/***************************************************************************
+                   nxlaunch: A GTK NX Client based on nxcl
+                   ---------------------------------------
+    begin                : September 2007
+    copyright            : (C) 2007 Embedded Software Foundry Ltd. (U.K.)
+                         :     Author: Sebastian James
+    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/freenx-cvs">seb at esfnet.co.uk</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+
+/*! \file callbacks_nx.h
+ *
+ * Functions to do with the configuration of NoMachine NX connections.
+ * Contains both the callback functions relating to the NX
+ * configuration pop-up and also functions which deal with adding
+ * and removing connections from the NX config files (~/.nx/config/nxclient.conf 
+ * and ~/.nx/config/perConnection.nxs)
+ *
+ */
+
+
+#ifndef __CALLBACKS_NX__
+#define __CALLBACKS_NX__
+#include &quot;../src/i18n.h&quot;
+
+#ifdef DEBUG
+# if DEBUG==0
+# undef DEBUG
+# endif
+#endif
+
+#ifndef PRINTERR_DEFINED
+# define PRINTERR_DEFINED 1
+# ifdef DEBUG
+#  define printerr(args...)	fprintf(stderr, ## args);
+# else
+#  define printerr(args...)
+# endif
+#endif
+
+#include &lt;errno.h&gt;
+#include &lt;stdio.h&gt;
+#include &lt;stdlib.h&gt;
+#include &lt;glib.h&gt;
+
+#include &lt;gtk/gtk.h&gt;
+#include &lt;sys/stat.h&gt;
+
+#include &lt;libxml/xmlmemory.h&gt;
+#include &lt;libxml/parser.h&gt;
+
+/*!
+ * struct to hold data on nx connection. The names of
+ * the elements of this structure are the same as the 
+ * names they have in the connection config files
+ *
+ * With NX_FIELDLEN = 255, and the two extra size fields
+ * this structure will take up about 7 kB of memory. 
+ *
+ * contents of [] brackets are the descriptions of the controls
+ * in the GUI.
+ *
+ * This structure is related to NXConfigData in nxcl/nxcl, but not
+ * quite the same. The NXConfigData equivalents are indicated in
+ * comments.
+ */
+struct nx_connection {
+
+	/* The name of the session, this gives the filename of the nx config file */
+	gchar * ConnectionName;         // NXCL:sessionName
+
+	/* Configurable variables in the network page */
+	gchar * ServerHost;             // NXCL:serverHost
+	guint ServerPort;               // NXCL:serverPort
+	gchar * User;                   // NXCL:sessionUser
+	gchar * Pass;                   // NXCL:sessionPass
+	gboolean RememberPassword;      // NXCL:?
+	gboolean DisableNoDelay;        // NXCL:?
+	gboolean DisableZLIB;           // NXCL:?
+	gboolean EnableSSLOnly;         // NXCL:encryption == EnableSSLOnly
+	gchar * LinkSpeed;              // NXCL:linkType
+	gchar * PublicKey; /* Needs more than 255 chars */ // NXCL:key
+
+	/* Configurable variables in the desktop page */
+	gchar * Desktop;                // NXCL:sessionType
+	gchar * CustomUnixDesktop;      // NXCL:in customCommand
+	gchar * CommandLine;            // NXCL:customeCommand and sessionType?
+	gboolean VirtualDesktop; /* if false, then &quot;Floating Window&quot; is true */ // NXCL:
+	gboolean XAgentEncoding;        // NXCL:?
+	gboolean UseTaint;              // NXCL:?
+	gchar * XdmMode;                // NXCL:?
+	gchar * XdmHost;                // NXCL:?agentServer?
+	guint XdmPort;                  // NXCL:?
+	gboolean FullScreen;            // NXCL:fullscreen
+	guint ResolutionWidth;          // NXCL:in string geometry
+	guint ResolutionHeight;         // NXCL:in string geometry
+	gchar * Geometry;               // NXCL:geometry
+	guint ImageEncoding;	/* nx_conn-&gt;ImageEncoding: 0:Default
+	                           1:PNG
+	                           2:JPEG
+                                   3:XBM   */ // NXCL:imageCompressionMethod
+	guint JPEGQuality;                    // NXCL:imageCompressionLevel
+
+	/* Services */
+	gboolean enableSound;   /* If true, nxesd will be started */ // NXCL:media
+	guint IPPPort;         // NXCL:?
+	gboolean IPPPrinting;  // NXCL:?cups?
+	gboolean Shares;       // NXCL:?
+	gchar * agentServer;
+	gchar * agentUser;
+	gchar * agentPass;
+};
+/* We allow up to NX_FIELDLEN characters in the strings above, except for SSLKey */
+#define NX_FIELDLEN 255
+#define SSLKEYLEN 4096 /* Guess at large enough value.
+			  Apparently this is about 10 times as big as it needs to be */
+#define CMDLINELEN 1024 /* Allow 1023 char length command lines. */
+
+/* Error return codes used in read_nx_connection and write_nx_connection */
+#define NX_XML_NOT_PARSED -1
+#define NX_XML_EMPTY -2
+#define NX_XML_WRONG_ROOT_NODE -3 /* document of the wrong type, 
+				     root node != NXClientSettings */
+
+/* This enum is used setting up some combo boxes */
+enum { PROGRAM, N_COLS };
+
+/* The text to place in wfclient.ini when there isn't already one existing. */
+static const gchar nxclient_conf[] = 
+&quot;&lt;!DOCTYPE NXClientSettings&gt;\n&quot;
+&quot;&lt;NXClientSettings application=\&quot;nxclient\&quot; version=\&quot;1.3\&quot; &gt;\n&quot;
+&quot;&lt;group name=\&quot;General\&quot; &gt;\n&quot;
+&quot;&lt;option key=\&quot;CUPS Password\&quot; value=\&quot;\&quot; /&gt;\n&quot;
+&quot;&lt;option key=\&quot;CUPS Port\&quot; value=\&quot;0\&quot; /&gt;\n&quot;
+&quot;&lt;option key=\&quot;Default font\&quot; value=\&quot;Helvetica,10,-1,5,50,0,0,0,0,0\&quot; /&gt;\n&quot;
+&quot;&lt;option key=\&quot;Hide Full Screen Info\&quot; value=\&quot;false\&quot; /&gt;\n&quot;
+&quot;&lt;option key=\&quot;Last session\&quot; value=\&quot;Nx1\&quot; /&gt;\n&quot;
+&quot;&lt;option key=\&quot;Permit Root Login\&quot; value=\&quot;false\&quot; /&gt;\n&quot;
+&quot;&lt;option key=\&quot;Personal NX dir\&quot; value=\&quot;/etc/persistent/hc/.nx\&quot; /&gt;\n&quot;
+&quot;&lt;option key=\&quot;Remove old sessions\&quot; value=\&quot;true\&quot; /&gt;\n&quot;
+&quot;&lt;option key=\&quot;System NX dir\&quot; value=\&quot;/opt/nx\&quot; /&gt;\n&quot;
+&quot;&lt;/group&gt;\n&quot;
+&quot;&lt;/NXClientSettings&gt;\n&quot;;
+
+static const gchar NXDefaultKey[] =
+&quot;-----BEGIN DSA PRIVATE KEY-----\n&quot;
+&quot;MIIBuwIBAAKBgQCXv9AzQXjxvXWC1qu3CdEqskX9YomTfyG865gb4D02ZwWuRU/9\n&quot;
+&quot;C3I9/bEWLdaWgJYXIcFJsMCIkmWjjeSZyTmeoypI1iLifTHUxn3b7WNWi8AzKcVF\n&quot;
+&quot;aBsBGiljsop9NiD1mEpA0G+nHHrhvTXz7pUvYrsrXcdMyM6rxqn77nbbnwIVALCi\n&quot;
+&quot;xFdHZADw5KAVZI7r6QatEkqLAoGBAI4L1TQGFkq5xQ/nIIciW8setAAIyrcWdK/z\n&quot;
+&quot;5/ZPeELdq70KDJxoLf81NL/8uIc4PoNyTRJjtT3R4f8Az1TsZWeh2+ReCEJxDWgG\n&quot;
+&quot;fbk2YhRqoQTtXPFsI4qvzBWct42WonWqyyb1bPBHk+JmXFscJu5yFQ+JUVNsENpY\n&quot;
+&quot;+Gkz3HqTAoGANlgcCuA4wrC+3Cic9CFkqiwO/Rn1vk8dvGuEQqFJ6f6LVfPfRTfa\n&quot;
+&quot;QU7TGVLk2CzY4dasrwxJ1f6FsT8DHTNGnxELPKRuLstGrFY/PR7KeafeFZDf+fJ3\n&quot;
+&quot;mbX5nxrld3wi5titTnX+8s4IKv29HJguPvOK/SI7cjzA+SqNfD7qEo8CFDIm1xRf\n&quot;
+&quot;8xAPsSKs6yZ6j1FNklfu\n&quot;
+&quot;-----END DSA PRIVATE KEY-----&quot;;
+
+
+/*! Utility functions */
+gboolean set_combobox (GtkWidget * widget, gchar * match_string);
+void nx_general_error (const gchar * msg, const gchar * title);
+
+/* Fn declarations for NX file access */
+gint write_nx_connection (struct nx_connection * nx_conn);
+gint delete_nx_connection (gchar * name);
+gint replace_nx_connection (struct nx_connection * nx_conn, gchar * name);
+
+/*! 
+ * Used in read_nx_connection
+ */
+void parse_general (xmlDocPtr doc, xmlNodePtr cur, 
+		    struct nx_connection * nx_conn);
+
+void parse_advanced (xmlDocPtr doc, xmlNodePtr cur, 
+		     struct nx_connection * nx_conn);
+
+gint read_default_image_encoding (xmlDocPtr doc, xmlNodePtr cur);
+gint find_def_im_enc_in_general (xmlDocPtr doc, xmlNodePtr cur);
+void parse_images (xmlDocPtr doc, xmlNodePtr cur, 
+		   struct nx_connection * nx_conn);
+
+void parse_login (xmlDocPtr doc, xmlNodePtr cur, 
+		  struct nx_connection * nx_conn);
+
+/*!
+ * Read an entry in theConn.nxs, putting details into the nx_connection struct.
+ *
+ * Returns 0 if a match is found and read. -1 on error, -2 for no match.
+ */
+gint read_nx_connection (struct nx_connection * nx_conn, const gchar * name);
+
+
+/* Memory management for nx_connection structures */
+struct nx_connection * nx_connection_malloc (void);
+void nx_connection_zero (struct nx_connection * nx_conn);
+gint nx_connection_free (struct nx_connection * nx_conn);
+
+/*! 
+ * This does the real work for setup_new_nx_popup() and 
+ * zero_new_nx_popup ()
+ */
+void setup_nx_popup (struct nx_connection * nx_conn);
+
+/*!
+ * setup_new_nx_popup () fills in the fields in the NX
+ * connection configuration popup (conn_new_nx in glade)
+ * using the entry in the config file which has the name
+ * conn-&gt;name.
+ */
+void setup_new_nx_popup (const gchar * name);
+
+/*!
+ * Resets fields in the NX
+ * connection configuration popup (conn_new_nx in glade)
+ * to zero/defaults.
+ */
+void zero_new_nx_popup (void);
+
+/*!
+ * This function sets up the connection structure with data taken
+ * from the submitted form data in the conn_new_nx dialog.
+ *
+ * It also sets up the data in nx_conn (which will be written to 
+ * the appsrv.ini file) with values taken from the conn_new_nx dialog.
+ */
+void read_nx_popup (gchar * name, gchar * server, gchar * uname, int * fullscreen,
+		    struct nx_connection * nx_conn);
+
+/*!
+ * This checks for the existence of the NX configuration
+ * files (in ~/.nx/config). If not present, it initialises
+ * the files using nx_writeout_nxclient_conf ().
+ */
+void nx_check_config (void);
+gint nx_writeout_nxclient_conf (void);
+
+
+/*!
+ * Callbacks which handle greying/ungreying of fields when the comboboxes
+ * and checkboxes in the NX popup window are manipulated
+ */
+
+/* Desktop Sessions */
+void set_custom_settings_sensitivity (void);
+void grey_all_custom_settings (void);
+void ungrey_custom_options (void);
+
+void set_xdm_settings (void);
+int set_xdm_settings_sensitivity_do_work (void);
+void set_xdm_settings_sensitivity (void);
+void grey_all_xdm_settings (void);
+
+void on_combobox_nx_desktop_session_changed (GtkComboBox * box);
+void on_combobox_nx_xdm_mode_changed (GtkComboBox * box);
+void on_radiobutton_nx_new_virtual_desktop_toggled (GtkToggleButton * button);
+void on_checkbutton_nx_disable_x_agent_toggled (GtkToggleButton * button);
+
+void on_combobox_new_nx_window_size_changed (GtkComboBox * box);
+
+void on_combobox_nx_image_encoding_changed (GtkComboBox * box);
+
+void on_button_nx_revert_ssl_key_clicked (GtkButton * button);
+
+void on_nx_key_file_chosen (GtkButton * button);
+
+#endif

Added: nxlaunch/src/Makefile.am
===================================================================
--- nxlaunch/src/Makefile.am	2007-09-16 20:16:05 UTC (rev 380)
+++ nxlaunch/src/Makefile.am	2007-09-17 12:30:56 UTC (rev 381)
@@ -0,0 +1,9 @@
+# Currently, if prefix is /usr then these files go in /usr/share/ but it would be better to place them in /usr/share/nxlaunch/
+EXTRA_DIST = nxlaunch.gladep nxconfig.gladep kde-nx-session.png gnome-nx-session.png unknown-nx-session.png rdp-nx-session.png vnc-nx-session.png nx-icon.png
+dist_data_DATA = nxlaunch.glade nxconfig.glade
+AM_CFLAGS = @PACKAGE_CFLAGS@ -DPACKAGE_DATA_DIR=\&quot;&quot;$(datadir)&quot;\&quot; -DLOCALEDIR=\&quot;$(localedir)\&quot; -DPACKAGE_BIN_DIR=\&quot;&quot;$(bindir)&quot;\&quot;
+bin_PROGRAMS = nxlaunch
+nxlaunch_SOURCES =  main.c nxlaunch.c
+nxlaunch_LDADD = @PACKAGE_LIBS@ $(LIBINTL) -L../lib/.libs -lcallbacks_nx
+pkginclude_HEADERS = nxlaunch.h
+nxlaunch_LDFLAGS = -export-dynamic # Required so that glade can autoconnect signals
\ No newline at end of file

Added: nxlaunch/src/i18n.h
===================================================================
--- nxlaunch/src/i18n.h	2007-09-16 20:16:05 UTC (rev 380)
+++ nxlaunch/src/i18n.h	2007-09-17 12:30:56 UTC (rev 381)
@@ -0,0 +1,39 @@
+/***************************************************************************
+                   nxlaunch: A GTK NX Client based on nxcl
+                   ---------------------------------------
+    begin                : September 2007
+    copyright            : (C) 2007 Embedded Software Foundry Ltd. (U.K.)
+                         :     Author: Sebastian James
+    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/freenx-cvs">seb at esfnet.co.uk</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#ifndef __NXLAUNCH_I18N__
+#  define __NXLAUNCH_I18N__
+#  ifdef HAVE_CONFIG_H
+#    include &lt;config.h&gt;
+#  endif
+#  ifdef ENABLE_NLS
+#    include &quot;../lib/gettext.h&quot;
+#    define _(String) gettext (String)
+#    define gettext_noop(String) String
+#    define N_(String) gettext_noop (String)
+#  else
+#    define _(String) (String)
+#    define N_(String) String
+#    define textdomain(Domain) (Domain)
+#    define gettext(String) (String)
+#    define dgettext(Domain,String) (String)
+#    define dcgettext(Domain,String,Type) (String)
+#    define bindtextdomain(Domain, Directory) (Domain) 
+#    define bind_textdomain_codeset(Domain,Codeset) (Codeset) 
+#  endif /* ENABLE_NLS */
+#endif /* __NXLAUNCH_I18N__ */
+

Added: nxlaunch/src/main.c
===================================================================
--- nxlaunch/src/main.c	2007-09-16 20:16:05 UTC (rev 380)
+++ nxlaunch/src/main.c	2007-09-17 12:30:56 UTC (rev 381)
@@ -0,0 +1,211 @@
+/***************************************************************************
+                   nxlaunch: A GTK NX Client based on nxcl
+                   ---------------------------------------
+    begin                : September 2007
+    copyright            : (C) 2007 Embedded Software Foundry Ltd. (U.K.)
+                         :     Author: Sebastian James
+    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/freenx-cvs">seb at esfnet.co.uk</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#include &quot;i18n.h&quot;
+
+/*! 
+ * config.h is created by the configure script and contains
+ * configure/compile time choices made by the program compiler.
+ */
+#include &quot;../config.h&quot;
+
+#include &lt;glade/glade.h&gt;
+#include &lt;gtk/gtk.h&gt;
+#include &lt;stdlib.h&gt;
+#include &lt;stdio.h&gt;
+#include &lt;sys/types.h&gt;
+#include &lt;sys/stat.h&gt;
+#include &lt;fcntl.h&gt;
+#include &lt;locale.h&gt;
+
+#include &quot;nxlaunch.h&quot;
+
+/*!
+ * Global Variable Definitions
+ */
+//@{
+
+/* Use globals for the xml tree */
+GladeXML * xml_nxlaunch_glob; /* nxlaunch.glade */
+GladeXML * xml_glob;          /* nxconfig.glade */
+
+/* And globals for the lists of connections/sessions */
+GtkListStore * conn_store;
+GtkTreeIter    conn_iter;
+GtkTreeIter    active_iter_glob;
+guint          next_conn_type;
+GtkListStore * sess_store;
+GtkTreeIter    sess_iter;
+guint          next_sess_type;
+
+/* Use some globals for the dbus interface as these need to be available to our callbacks. */
+gchar * dbusSendInterface;
+gchar * dbusRecvInterface;
+gchar * dbusMatchString;
+int              dbusNum = 0;
+DBusConnection * dbusConn = NULL;
+DBusError        dbusErr;
+
+/* The &quot;mode&quot; in which the program was started: &quot;main&quot;, &quot;from name&quot;,
+ * &quot;from file&quot;, &quot;edit named&quot;, &quot;edit file&quot;. See nxlaunch.h for
+ * #defines */
+int nxlaunch_mode = 0;
+//@}
+
+/*!
+ * main program entry point
+ */
+gint
+main (gint argc, gchar * argv[])
+{
+	GtkWidget * widget;
+	gchar * our_locale;
+	int n_conn = 0;
+
+	bindtextdomain (PACKAGE, BINDTEXTDOMAIN);
+	bind_textdomain_codeset (PACKAGE, &quot;UTF-8&quot;);
+	textdomain (PACKAGE);
+
+	gtk_set_locale ();
+	gtk_init (&amp;argc, &amp;argv);
+
+	our_locale = setlocale (LC_ALL, NULL);
+
+	xml_nxlaunch_glob = glade_xml_new (PACKAGE_DATA_DIR&quot;/nxlaunch.glade&quot;, NULL, NULL);
+	if (!xml_nxlaunch_glob) {
+		printerr (_(&quot;Failed to load the glade XML file (nxlaunch.glade)\n&quot;));
+		return EXIT_FAILURE;
+	}
+	glade_xml_signal_autoconnect (xml_nxlaunch_glob);
+
+#if BUILT_IN_CONFIGURATION==1
+	xml_glob = glade_xml_new (PACKAGE_DATA_DIR&quot;/nxconfig.glade&quot;, NULL, NULL);
+	if (!xml_glob) {
+		printerr (_(&quot;Failed to load the glade XML file (nxconfig.glade)\n&quot;));
+		return EXIT_FAILURE;
+	}
+	glade_xml_signal_autoconnect (xml_glob);
+#endif
+
+	dbusNum = obtainDbusConnection();
+
+	/*
+	 * See nxlaunch.h for the enums which relate to these list stores.
+	 */
+	conn_store = gtk_list_store_new (N_CONN_COLUMNS,		 
+					 G_TYPE_STRING,
+					 G_TYPE_STRING,
+					 G_TYPE_UINT,
+					 G_TYPE_STRING,
+					 G_TYPE_STRING,
+					 G_TYPE_BOOLEAN,
+					 G_TYPE_BOOLEAN,
+					 G_TYPE_BOOLEAN,
+					 G_TYPE_BOOLEAN,
+					 G_TYPE_STRING,
+					 G_TYPE_STRING,
+					 G_TYPE_STRING,
+					 G_TYPE_STRING,
+					 G_TYPE_STRING,
+					 G_TYPE_BOOLEAN,
+					 G_TYPE_BOOLEAN,
+					 G_TYPE_BOOLEAN,
+					 G_TYPE_STRING,
+					 G_TYPE_STRING,
+					 G_TYPE_UINT,
+					 G_TYPE_BOOLEAN,
+					 G_TYPE_UINT,
+					 G_TYPE_UINT,
+					 G_TYPE_STRING,
+					 G_TYPE_UINT,
+					 G_TYPE_UINT,
+					 G_TYPE_BOOLEAN,
+					 G_TYPE_UINT,
+					 G_TYPE_BOOLEAN,
+					 G_TYPE_BOOLEAN,
+					 G_TYPE_STRING,
+					 G_TYPE_STRING,
+					 G_TYPE_STRING);
+
+	sess_store = gtk_list_store_new (N_SESS_COLUMNS,
+					 G_TYPE_INT,
+					 G_TYPE_INT,
+					 G_TYPE_STRING,
+					 GDK_TYPE_PIXBUF,
+					 G_TYPE_STRING,
+					 G_TYPE_STRING,
+					 G_TYPE_INT,
+					 G_TYPE_STRING,
+					 G_TYPE_STRING,
+					 G_TYPE_STRING);
+
+	/* Create the columns */
+	nxlaunch_create_nxconnection_list ();
+	nxlaunch_create_nxsession_list ();
+
+	/* fill the models (and hence the lists) from the config file */
+	n_conn = nxconnection_buildlist();
+	printerr (_(&quot;Found %d connections in config directory.\n&quot;), n_conn);
+
+	/* initialise active_iter_glob and conn_iter */
+	gtk_tree_model_get_iter_first (GTK_TREE_MODEL (conn_store), &amp;active_iter_glob);
+	gtk_tree_model_get_iter_first (GTK_TREE_MODEL (conn_store), &amp;conn_iter);
+
+	gtk_tree_model_get_iter_first (GTK_TREE_MODEL (sess_store), &amp;sess_iter);
+
+	/*
+	 * The following needs to be more sophisticated, with libpopt
+	 * being used. We'll then set modes from the options. Going to
+	 * have these options: --edit|-e --username|-u --file|-f Could
+	 * also have options to mod the chosen connection, like
+	 * --fullscreen etc.
+	 */
+	gboolean have_named = FALSE;
+	if (argc == 2) {
+		/* If we have an argument, we want to launch a connection based on name */
+		nxlaunch_mode = MODE_NAMED;
+		have_named = launch_named_connection (argv[1]);
+	} else {
+		nxlaunch_mode = MODE_MAIN;
+	}
+
+	/*
+	 * If we have a connection named on the cmd line, we just want
+	 * to show the password dialog - that means we need to avoid
+	 * showing the nxlauncher window, BUT we do need to &quot;realise&quot;
+	 * it, so that the tree model containing the connections is
+	 * accessible.
+	 */
+
+	if (!have_named) {
+		/* Unmask the main window */
+		widget = glade_xml_get_widget (xml_nxlaunch_glob, &quot;nxlauncher&quot;);
+		gtk_widget_show_all (widget);
+
+		/*
+		 * FIXME: Now we should highlight the first connection
+		 * in the list.
+		 */
+
+	} else {
+		widget = glade_xml_get_widget (xml_nxlaunch_glob, &quot;treeview_nxconnection&quot;);
+		gtk_widget_realize (widget);
+	}
+
+	gtk_main();
+	return EXIT_SUCCESS;
+}

Added: nxlaunch/src/nxconfig.glade
===================================================================
--- nxlaunch/src/nxconfig.glade	2007-09-16 20:16:05 UTC (rev 380)
+++ nxlaunch/src/nxconfig.glade	2007-09-17 12:30:56 UTC (rev 381)
@@ -0,0 +1,1960 @@
+&lt;?xml version=&quot;1.0&quot; standalone=&quot;no&quot;?&gt; &lt;!--*- mode: xml -*--&gt;
+&lt;!DOCTYPE glade-interface SYSTEM &quot;<A HREF="http://glade.gnome.org/glade-2.0.dtd">http://glade.gnome.org/glade-2.0.dtd</A>&quot;&gt;
+
+&lt;glade-interface&gt;
+&lt;requires lib=&quot;gnome&quot;/&gt;
+
+&lt;widget class=&quot;GtkDialog&quot; id=&quot;conn_new_nx&quot;&gt;
+  &lt;property name=&quot;title&quot; translatable=&quot;yes&quot;&gt;NoMachine NX Connection Details&lt;/property&gt;
+  &lt;property name=&quot;type&quot;&gt;GTK_WINDOW_TOPLEVEL&lt;/property&gt;
+  &lt;property name=&quot;window_position&quot;&gt;GTK_WIN_POS_CENTER_ON_PARENT&lt;/property&gt;
+  &lt;property name=&quot;modal&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;resizable&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;destroy_with_parent&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;icon&quot;&gt;nx-desktop.png&lt;/property&gt;
+  &lt;property name=&quot;decorated&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;skip_taskbar_hint&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;skip_pager_hint&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;type_hint&quot;&gt;GDK_WINDOW_TYPE_HINT_DIALOG&lt;/property&gt;
+  &lt;property name=&quot;gravity&quot;&gt;GDK_GRAVITY_NORTH_WEST&lt;/property&gt;
+  &lt;property name=&quot;has_separator&quot;&gt;True&lt;/property&gt;
+  &lt;signal name=&quot;delete_event&quot; handler=&quot;gtk_widget_hide&quot; object=&quot;conn_new_nx&quot; last_modification_time=&quot;Fri, 14 Oct 2005 14:18:27 GMT&quot;/&gt;
+
+  &lt;child internal-child=&quot;vbox&quot;&gt;
+    &lt;widget class=&quot;GtkVBox&quot; id=&quot;vbox40&quot;&gt;
+      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+      &lt;child internal-child=&quot;action_area&quot;&gt;
+	&lt;widget class=&quot;GtkHButtonBox&quot; id=&quot;hbuttonbox15&quot;&gt;
+	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;layout_style&quot;&gt;GTK_BUTTONBOX_END&lt;/property&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkButton&quot; id=&quot;button21&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;label&quot;&gt;gtk-cancel&lt;/property&gt;
+	      &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+	      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;response_id&quot;&gt;-6&lt;/property&gt;
+	      &lt;signal name=&quot;clicked&quot; handler=&quot;gtk_widget_hide&quot; object=&quot;conn_new_nx&quot; last_modification_time=&quot;Mon, 22 Nov 2004 16:04:57 GMT&quot;/&gt;
+	    &lt;/widget&gt;
+	  &lt;/child&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkButton&quot; id=&quot;button22&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;has_default&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;label&quot;&gt;gtk-ok&lt;/property&gt;
+	      &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+	      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;response_id&quot;&gt;-5&lt;/property&gt;
+	      &lt;signal name=&quot;clicked&quot; handler=&quot;on_conn_new_ok_clicked&quot; last_modification_time=&quot;Tue, 15 Mar 2005 12:07:14 GMT&quot;/&gt;
+	      &lt;signal name=&quot;clicked&quot; handler=&quot;gtk_widget_hide&quot; object=&quot;conn_new_nx&quot; last_modification_time=&quot;Mon, 17 Sep 2007 12:04:08 GMT&quot;/&gt;
+	    &lt;/widget&gt;
+	  &lt;/child&gt;
+	&lt;/widget&gt;
+	&lt;packing&gt;
+	  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+	  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;pack_type&quot;&gt;GTK_PACK_END&lt;/property&gt;
+	&lt;/packing&gt;
+      &lt;/child&gt;
+
+      &lt;child&gt;
+	&lt;widget class=&quot;GtkNotebook&quot; id=&quot;notebook_nx&quot;&gt;
+	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;show_tabs&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;show_border&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;tab_pos&quot;&gt;GTK_POS_TOP&lt;/property&gt;
+	  &lt;property name=&quot;scrollable&quot;&gt;False&lt;/property&gt;
+	  &lt;property name=&quot;enable_popup&quot;&gt;False&lt;/property&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkVBox&quot; id=&quot;vbox52&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkFrame&quot; id=&quot;frame9&quot;&gt;
+		  &lt;property name=&quot;border_width&quot;&gt;5&lt;/property&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;label_xalign&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;label_yalign&quot;&gt;0.5&lt;/property&gt;
+		  &lt;property name=&quot;shadow_type&quot;&gt;GTK_SHADOW_OUT&lt;/property&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkAlignment&quot; id=&quot;alignment23&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;xscale&quot;&gt;1&lt;/property&gt;
+		      &lt;property name=&quot;yscale&quot;&gt;1&lt;/property&gt;
+		      &lt;property name=&quot;top_padding&quot;&gt;2&lt;/property&gt;
+		      &lt;property name=&quot;bottom_padding&quot;&gt;5&lt;/property&gt;
+		      &lt;property name=&quot;left_padding&quot;&gt;12&lt;/property&gt;
+		      &lt;property name=&quot;right_padding&quot;&gt;2&lt;/property&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkVBox&quot; id=&quot;vbox53&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkHBox&quot; id=&quot;hbox60&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+			      &lt;child&gt;
+				&lt;widget class=&quot;GtkEntry&quot; id=&quot;entry_nx_connection_name&quot;&gt;
+				  &lt;property name=&quot;width_request&quot;&gt;160&lt;/property&gt;
+				  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;tooltip&quot; translatable=&quot;yes&quot;&gt;Mandatory: Enter a unique name for the connection.&lt;/property&gt;
+				  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;editable&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;visibility&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;max_length&quot;&gt;254&lt;/property&gt;
+				  &lt;property name=&quot;text&quot; translatable=&quot;yes&quot;&gt;&lt;/property&gt;
+				  &lt;property name=&quot;has_frame&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;invisible_char&quot;&gt;*&lt;/property&gt;
+				  &lt;property name=&quot;activates_default&quot;&gt;False&lt;/property&gt;
+				&lt;/widget&gt;
+				&lt;packing&gt;
+				  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+				&lt;/packing&gt;
+			      &lt;/child&gt;
+
+			      &lt;child&gt;
+				&lt;placeholder/&gt;
+			      &lt;/child&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+			&lt;/widget&gt;
+		      &lt;/child&gt;
+		    &lt;/widget&gt;
+		  &lt;/child&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkLabel&quot; id=&quot;label181&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;&lt;i&gt;Connection Name&lt;/i&gt;&lt;/property&gt;
+		      &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;use_markup&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+		      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+		    &lt;/widget&gt;
+		    &lt;packing&gt;
+		      &lt;property name=&quot;type&quot;&gt;label_item&lt;/property&gt;
+		    &lt;/packing&gt;
+		  &lt;/child&gt;
+		&lt;/widget&gt;
+		&lt;packing&gt;
+		  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+		&lt;/packing&gt;
+	      &lt;/child&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkFrame&quot; id=&quot;frame10&quot;&gt;
+		  &lt;property name=&quot;border_width&quot;&gt;5&lt;/property&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;label_xalign&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;label_yalign&quot;&gt;0.5&lt;/property&gt;
+		  &lt;property name=&quot;shadow_type&quot;&gt;GTK_SHADOW_OUT&lt;/property&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkAlignment&quot; id=&quot;alignment24&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;xscale&quot;&gt;1&lt;/property&gt;
+		      &lt;property name=&quot;yscale&quot;&gt;1&lt;/property&gt;
+		      &lt;property name=&quot;top_padding&quot;&gt;2&lt;/property&gt;
+		      &lt;property name=&quot;bottom_padding&quot;&gt;5&lt;/property&gt;
+		      &lt;property name=&quot;left_padding&quot;&gt;12&lt;/property&gt;
+		      &lt;property name=&quot;right_padding&quot;&gt;2&lt;/property&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkVBox&quot; id=&quot;vbox54&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkTable&quot; id=&quot;table15&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;n_rows&quot;&gt;2&lt;/property&gt;
+			      &lt;property name=&quot;n_columns&quot;&gt;2&lt;/property&gt;
+			      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;row_spacing&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;column_spacing&quot;&gt;0&lt;/property&gt;
+
+			      &lt;child&gt;
+				&lt;widget class=&quot;GtkLabel&quot; id=&quot;label182&quot;&gt;
+				  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Address: &lt;/property&gt;
+				  &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+				  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+				  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+				  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+				&lt;/widget&gt;
+				&lt;packing&gt;
+				  &lt;property name=&quot;left_attach&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;right_attach&quot;&gt;1&lt;/property&gt;
+				  &lt;property name=&quot;top_attach&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;bottom_attach&quot;&gt;1&lt;/property&gt;
+				  &lt;property name=&quot;x_options&quot;&gt;fill&lt;/property&gt;
+				  &lt;property name=&quot;y_options&quot;&gt;&lt;/property&gt;
+				&lt;/packing&gt;
+			      &lt;/child&gt;
+
+			      &lt;child&gt;
+				&lt;widget class=&quot;GtkHBox&quot; id=&quot;hbox61&quot;&gt;
+				  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+				  &lt;child&gt;
+				    &lt;widget class=&quot;GtkEntry&quot; id=&quot;entry_nx_server&quot;&gt;
+				      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				      &lt;property name=&quot;tooltip&quot; translatable=&quot;yes&quot;&gt;Mandatory. Enter an internet address or IP number.&lt;/property&gt;
+				      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+				      &lt;property name=&quot;editable&quot;&gt;True&lt;/property&gt;
+				      &lt;property name=&quot;visibility&quot;&gt;True&lt;/property&gt;
+				      &lt;property name=&quot;max_length&quot;&gt;254&lt;/property&gt;
+				      &lt;property name=&quot;text&quot; translatable=&quot;yes&quot;&gt;&lt;/property&gt;
+				      &lt;property name=&quot;has_frame&quot;&gt;True&lt;/property&gt;
+				      &lt;property name=&quot;invisible_char&quot;&gt;*&lt;/property&gt;
+				      &lt;property name=&quot;activates_default&quot;&gt;False&lt;/property&gt;
+				    &lt;/widget&gt;
+				    &lt;packing&gt;
+				      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+				    &lt;/packing&gt;
+				  &lt;/child&gt;
+
+				  &lt;child&gt;
+				    &lt;widget class=&quot;GtkLabel&quot; id=&quot;label183&quot;&gt;
+				      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;:&lt;/property&gt;
+				      &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+				      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+				      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+				      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+				      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+				    &lt;/widget&gt;
+				    &lt;packing&gt;
+				      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+				    &lt;/packing&gt;
+				  &lt;/child&gt;
+
+				  &lt;child&gt;
+				    &lt;widget class=&quot;GtkSpinButton&quot; id=&quot;spinbutton_nx_port&quot;&gt;
+				      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				      &lt;property name=&quot;tooltip&quot; translatable=&quot;yes&quot;&gt;Mandatory. The port to connect to on the NX server.&lt;/property&gt;
+				      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+				      &lt;property name=&quot;climb_rate&quot;&gt;1&lt;/property&gt;
+				      &lt;property name=&quot;digits&quot;&gt;0&lt;/property&gt;
+				      &lt;property name=&quot;numeric&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_ALWAYS&lt;/property&gt;
+				      &lt;property name=&quot;snap_to_ticks&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;adjustment&quot;&gt;22 1 32767 1 10 10&lt;/property&gt;
+				    &lt;/widget&gt;
+				    &lt;packing&gt;
+				      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+				    &lt;/packing&gt;
+				  &lt;/child&gt;
+				&lt;/widget&gt;
+				&lt;packing&gt;
+				  &lt;property name=&quot;left_attach&quot;&gt;1&lt;/property&gt;
+				  &lt;property name=&quot;right_attach&quot;&gt;2&lt;/property&gt;
+				  &lt;property name=&quot;top_attach&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;bottom_attach&quot;&gt;1&lt;/property&gt;
+				  &lt;property name=&quot;y_options&quot;&gt;fill&lt;/property&gt;
+				&lt;/packing&gt;
+			      &lt;/child&gt;
+
+			      &lt;child&gt;
+				&lt;widget class=&quot;GtkLabel&quot; id=&quot;label184&quot;&gt;
+				  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Username: &lt;/property&gt;
+				  &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+				  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+				  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+				  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+				&lt;/widget&gt;
+				&lt;packing&gt;
+				  &lt;property name=&quot;left_attach&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;right_attach&quot;&gt;1&lt;/property&gt;
+				  &lt;property name=&quot;top_attach&quot;&gt;1&lt;/property&gt;
+				  &lt;property name=&quot;bottom_attach&quot;&gt;2&lt;/property&gt;
+				  &lt;property name=&quot;x_options&quot;&gt;fill&lt;/property&gt;
+				  &lt;property name=&quot;y_options&quot;&gt;&lt;/property&gt;
+				&lt;/packing&gt;
+			      &lt;/child&gt;
+
+			      &lt;child&gt;
+				&lt;widget class=&quot;GtkHBox&quot; id=&quot;hbox62&quot;&gt;
+				  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+				  &lt;child&gt;
+				    &lt;widget class=&quot;GtkEntry&quot; id=&quot;entry_nx_user&quot;&gt;
+				      &lt;property name=&quot;width_request&quot;&gt;160&lt;/property&gt;
+				      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				      &lt;property name=&quot;tooltip&quot; translatable=&quot;yes&quot;&gt;Mandatory: Enter a user name for the connection.&lt;/property&gt;
+				      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+				      &lt;property name=&quot;editable&quot;&gt;True&lt;/property&gt;
+				      &lt;property name=&quot;visibility&quot;&gt;True&lt;/property&gt;
+				      &lt;property name=&quot;max_length&quot;&gt;254&lt;/property&gt;
+				      &lt;property name=&quot;text&quot; translatable=&quot;yes&quot;&gt;&lt;/property&gt;
+				      &lt;property name=&quot;has_frame&quot;&gt;True&lt;/property&gt;
+				      &lt;property name=&quot;invisible_char&quot;&gt;*&lt;/property&gt;
+				      &lt;property name=&quot;activates_default&quot;&gt;False&lt;/property&gt;
+				    &lt;/widget&gt;
+				    &lt;packing&gt;
+				      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+				      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+				    &lt;/packing&gt;
+				  &lt;/child&gt;
+
+				  &lt;child&gt;
+				    &lt;placeholder/&gt;
+				  &lt;/child&gt;
+				&lt;/widget&gt;
+				&lt;packing&gt;
+				  &lt;property name=&quot;left_attach&quot;&gt;1&lt;/property&gt;
+				  &lt;property name=&quot;right_attach&quot;&gt;2&lt;/property&gt;
+				  &lt;property name=&quot;top_attach&quot;&gt;1&lt;/property&gt;
+				  &lt;property name=&quot;bottom_attach&quot;&gt;2&lt;/property&gt;
+				  &lt;property name=&quot;x_options&quot;&gt;shrink|fill&lt;/property&gt;
+				  &lt;property name=&quot;y_options&quot;&gt;fill&lt;/property&gt;
+				&lt;/packing&gt;
+			      &lt;/child&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkHBox&quot; id=&quot;hbox63&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+			      &lt;child&gt;
+				&lt;widget class=&quot;GtkCheckButton&quot; id=&quot;checkbutton_nx_save_password&quot;&gt;
+				  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;tooltip&quot; translatable=&quot;yes&quot;&gt;Whether your password is saved locally in an encrypted form on the thin client.&lt;/property&gt;
+				  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Save Password&lt;/property&gt;
+				  &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+				  &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;active&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;inconsistent&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;draw_indicator&quot;&gt;True&lt;/property&gt;
+				&lt;/widget&gt;
+				&lt;packing&gt;
+				  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+				&lt;/packing&gt;
+			      &lt;/child&gt;
+
+			      &lt;child&gt;
+				&lt;widget class=&quot;GtkLabel&quot; id=&quot;label185&quot;&gt;
+				  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt; &lt;/property&gt;
+				  &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+				  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+				  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+				  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+				&lt;/widget&gt;
+				&lt;packing&gt;
+				  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+				&lt;/packing&gt;
+			      &lt;/child&gt;
+
+			      &lt;child&gt;
+				&lt;widget class=&quot;GtkButton&quot; id=&quot;button_nx_manage_key&quot;&gt;
+				  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;tooltip&quot; translatable=&quot;yes&quot;&gt;Manage the SSL public key which will be used to connect to your NX server.&lt;/property&gt;
+				  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+				  &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+				  &lt;signal name=&quot;clicked&quot; handler=&quot;gtk_widget_show&quot; object=&quot;manage_nx_key&quot; last_modification_time=&quot;Tue, 18 Apr 2006 14:58:06 GMT&quot;/&gt;
+
+				  &lt;child&gt;
+				    &lt;widget class=&quot;GtkAlignment&quot; id=&quot;alignment25&quot;&gt;
+				      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+				      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+				      &lt;property name=&quot;xscale&quot;&gt;0&lt;/property&gt;
+				      &lt;property name=&quot;yscale&quot;&gt;0&lt;/property&gt;
+				      &lt;property name=&quot;top_padding&quot;&gt;0&lt;/property&gt;
+				      &lt;property name=&quot;bottom_padding&quot;&gt;0&lt;/property&gt;
+				      &lt;property name=&quot;left_padding&quot;&gt;0&lt;/property&gt;
+				      &lt;property name=&quot;right_padding&quot;&gt;0&lt;/property&gt;
+
+				      &lt;child&gt;
+					&lt;widget class=&quot;GtkHBox&quot; id=&quot;hbox64&quot;&gt;
+					  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+					  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+					  &lt;property name=&quot;spacing&quot;&gt;2&lt;/property&gt;
+
+					  &lt;child&gt;
+					    &lt;widget class=&quot;GtkImage&quot; id=&quot;image19&quot;&gt;
+					      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;stock&quot;&gt;gtk-network&lt;/property&gt;
+					      &lt;property name=&quot;icon_size&quot;&gt;4&lt;/property&gt;
+					      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+					      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+					      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+					      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+					    &lt;/widget&gt;
+					    &lt;packing&gt;
+					      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+					      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+					    &lt;/packing&gt;
+					  &lt;/child&gt;
+
+					  &lt;child&gt;
+					    &lt;widget class=&quot;GtkLabel&quot; id=&quot;label186&quot;&gt;
+					      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Manage Key&lt;/property&gt;
+					      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+					      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+					      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+					      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+					      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+					    &lt;/widget&gt;
+					    &lt;packing&gt;
+					      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+					      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+					    &lt;/packing&gt;
+					  &lt;/child&gt;
+					&lt;/widget&gt;
+				      &lt;/child&gt;
+				    &lt;/widget&gt;
+				  &lt;/child&gt;
+				&lt;/widget&gt;
+				&lt;packing&gt;
+				  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+				&lt;/packing&gt;
+			      &lt;/child&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+			&lt;/widget&gt;
+		      &lt;/child&gt;
+		    &lt;/widget&gt;
+		  &lt;/child&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkLabel&quot; id=&quot;label187&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;&lt;i&gt;Connection Details&lt;/i&gt;&lt;/property&gt;
+		      &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;use_markup&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+		      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+		    &lt;/widget&gt;
+		    &lt;packing&gt;
+		      &lt;property name=&quot;type&quot;&gt;label_item&lt;/property&gt;
+		    &lt;/packing&gt;
+		  &lt;/child&gt;
+		&lt;/widget&gt;
+		&lt;packing&gt;
+		  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+		&lt;/packing&gt;
+	      &lt;/child&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkFrame&quot; id=&quot;frame11&quot;&gt;
+		  &lt;property name=&quot;border_width&quot;&gt;5&lt;/property&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;label_xalign&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;label_yalign&quot;&gt;0.5&lt;/property&gt;
+		  &lt;property name=&quot;shadow_type&quot;&gt;GTK_SHADOW_OUT&lt;/property&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkAlignment&quot; id=&quot;alignment26&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;xscale&quot;&gt;1&lt;/property&gt;
+		      &lt;property name=&quot;yscale&quot;&gt;1&lt;/property&gt;
+		      &lt;property name=&quot;top_padding&quot;&gt;2&lt;/property&gt;
+		      &lt;property name=&quot;bottom_padding&quot;&gt;5&lt;/property&gt;
+		      &lt;property name=&quot;left_padding&quot;&gt;12&lt;/property&gt;
+		      &lt;property name=&quot;right_padding&quot;&gt;2&lt;/property&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkVBox&quot; id=&quot;vbox55&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkCheckButton&quot; id=&quot;checkbutton_nx_disable_no_delay&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;tooltip&quot; translatable=&quot;yes&quot;&gt;Disable TCP no-delay for the connection.&lt;/property&gt;
+			      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Disable No-delay&lt;/property&gt;
+			      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+			      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;active&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;inconsistent&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;draw_indicator&quot;&gt;True&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkCheckButton&quot; id=&quot;checkbutton_nx_disable_zlib&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;tooltip&quot; translatable=&quot;yes&quot;&gt;Disable compression of the data stream (use less cpu on high capacity networks).&lt;/property&gt;
+			      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Disable ZLIB stream compression&lt;/property&gt;
+			      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+			      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;active&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;inconsistent&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;draw_indicator&quot;&gt;True&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkCheckButton&quot; id=&quot;checkbutton_nx_enable_ssl_for_all&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;tooltip&quot; translatable=&quot;yes&quot;&gt;Pass all data through a SSL tunnel (more secure).&lt;/property&gt;
+			      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Enable SSL encryption of all traffic&lt;/property&gt;
+			      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+			      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;active&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;inconsistent&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;draw_indicator&quot;&gt;True&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkHScale&quot; id=&quot;hscale_nx_connection_capacity&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;draw_value&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;value_pos&quot;&gt;GTK_POS_TOP&lt;/property&gt;
+			      &lt;property name=&quot;digits&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_CONTINUOUS&lt;/property&gt;
+			      &lt;property name=&quot;inverted&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;adjustment&quot;&gt;3 1 5 1 0 0&lt;/property&gt;
+			      &lt;signal name=&quot;value_changed&quot; handler=&quot;on_hscale_nx_connection_capacity_value_changed&quot; last_modification_time=&quot;Tue, 18 Apr 2006 13:51:14 GMT&quot;/&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkLabel&quot; id=&quot;label_nx_connection_capacity&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Connection capacity: ADSL&lt;/property&gt;
+			      &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+			      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+			&lt;/widget&gt;
+		      &lt;/child&gt;
+		    &lt;/widget&gt;
+		  &lt;/child&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkLabel&quot; id=&quot;label189&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;&lt;i&gt;Network options&lt;/i&gt;&lt;/property&gt;
+		      &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;use_markup&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+		      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+		    &lt;/widget&gt;
+		    &lt;packing&gt;
+		      &lt;property name=&quot;type&quot;&gt;label_item&lt;/property&gt;
+		    &lt;/packing&gt;
+		  &lt;/child&gt;
+		&lt;/widget&gt;
+		&lt;packing&gt;
+		  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+		&lt;/packing&gt;
+	      &lt;/child&gt;
+	    &lt;/widget&gt;
+	    &lt;packing&gt;
+	      &lt;property name=&quot;tab_expand&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;tab_fill&quot;&gt;True&lt;/property&gt;
+	    &lt;/packing&gt;
+	  &lt;/child&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkLabel&quot; id=&quot;label190&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Network&lt;/property&gt;
+	      &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+	      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+	      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+	      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+	    &lt;/widget&gt;
+	    &lt;packing&gt;
+	      &lt;property name=&quot;type&quot;&gt;tab&lt;/property&gt;
+	    &lt;/packing&gt;
+	  &lt;/child&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkVBox&quot; id=&quot;vbox56&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkFrame&quot; id=&quot;frame12&quot;&gt;
+		  &lt;property name=&quot;border_width&quot;&gt;5&lt;/property&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;label_xalign&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;label_yalign&quot;&gt;0.5&lt;/property&gt;
+		  &lt;property name=&quot;shadow_type&quot;&gt;GTK_SHADOW_OUT&lt;/property&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkAlignment&quot; id=&quot;alignment27&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;xscale&quot;&gt;1&lt;/property&gt;
+		      &lt;property name=&quot;yscale&quot;&gt;1&lt;/property&gt;
+		      &lt;property name=&quot;top_padding&quot;&gt;2&lt;/property&gt;
+		      &lt;property name=&quot;bottom_padding&quot;&gt;5&lt;/property&gt;
+		      &lt;property name=&quot;left_padding&quot;&gt;12&lt;/property&gt;
+		      &lt;property name=&quot;right_padding&quot;&gt;2&lt;/property&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkVBox&quot; id=&quot;vbox57&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkComboBox&quot; id=&quot;combobox_nx_desktop_session&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;items&quot; translatable=&quot;yes&quot;&gt;KDE
+GNOME
+CDE
+XDM
+Console
+Default X client script on server
+Custom command&lt;/property&gt;
+			      &lt;signal name=&quot;changed&quot; handler=&quot;on_combobox_nx_desktop_session_changed&quot; last_modification_time=&quot;Thu, 13 Apr 2006 12:26:55 GMT&quot;/&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkFrame&quot; id=&quot;frame_nx_custom_settings&quot;&gt;
+			      &lt;property name=&quot;border_width&quot;&gt;5&lt;/property&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;label_xalign&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;label_yalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;shadow_type&quot;&gt;GTK_SHADOW_OUT&lt;/property&gt;
+
+			      &lt;child&gt;
+				&lt;widget class=&quot;GtkAlignment&quot; id=&quot;alignment28&quot;&gt;
+				  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+				  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+				  &lt;property name=&quot;xscale&quot;&gt;1&lt;/property&gt;
+				  &lt;property name=&quot;yscale&quot;&gt;1&lt;/property&gt;
+				  &lt;property name=&quot;top_padding&quot;&gt;2&lt;/property&gt;
+				  &lt;property name=&quot;bottom_padding&quot;&gt;5&lt;/property&gt;
+				  &lt;property name=&quot;left_padding&quot;&gt;12&lt;/property&gt;
+				  &lt;property name=&quot;right_padding&quot;&gt;2&lt;/property&gt;
+
+				  &lt;child&gt;
+				    &lt;widget class=&quot;GtkVBox&quot; id=&quot;vbox58&quot;&gt;
+				      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+				      &lt;child&gt;
+					&lt;widget class=&quot;GtkHBox&quot; id=&quot;hbox65&quot;&gt;
+					  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+					  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+					  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+					  &lt;child&gt;
+					    &lt;widget class=&quot;GtkLabel&quot; id=&quot;label_nx_custom_command&quot;&gt;
+					      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Command to run: &lt;/property&gt;
+					      &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+					      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+					      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+					      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+					      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+					    &lt;/widget&gt;
+					    &lt;packing&gt;
+					      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+					      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+					    &lt;/packing&gt;
+					  &lt;/child&gt;
+
+					  &lt;child&gt;
+					    &lt;widget class=&quot;GtkEntry&quot; id=&quot;entry_nx_custom_command&quot;&gt;
+					      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;tooltip&quot; translatable=&quot;yes&quot;&gt;Command to run on the NX server. 1023 characters max.&lt;/property&gt;
+					      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;editable&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;visibility&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;max_length&quot;&gt;1023&lt;/property&gt;
+					      &lt;property name=&quot;text&quot; translatable=&quot;yes&quot;&gt;&lt;/property&gt;
+					      &lt;property name=&quot;has_frame&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;invisible_char&quot;&gt;*&lt;/property&gt;
+					      &lt;property name=&quot;activates_default&quot;&gt;False&lt;/property&gt;
+					    &lt;/widget&gt;
+					    &lt;packing&gt;
+					      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+					      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+					    &lt;/packing&gt;
+					  &lt;/child&gt;
+					&lt;/widget&gt;
+					&lt;packing&gt;
+					  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+					  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+					  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+					&lt;/packing&gt;
+				      &lt;/child&gt;
+
+				      &lt;child&gt;
+					&lt;widget class=&quot;GtkRadioButton&quot; id=&quot;radiobutton_nx_new_virtual_desktop&quot;&gt;
+					  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+					  &lt;property name=&quot;sensitive&quot;&gt;False&lt;/property&gt;
+					  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+					  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;New virtual desktop&lt;/property&gt;
+					  &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+					  &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+					  &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+					  &lt;property name=&quot;active&quot;&gt;False&lt;/property&gt;
+					  &lt;property name=&quot;inconsistent&quot;&gt;False&lt;/property&gt;
+					  &lt;property name=&quot;draw_indicator&quot;&gt;True&lt;/property&gt;
+					  &lt;signal name=&quot;toggled&quot; handler=&quot;on_radiobutton_nx_new_virtual_desktop_toggled&quot; last_modification_time=&quot;Thu, 13 Apr 2006 12:38:51 GMT&quot;/&gt;
+					&lt;/widget&gt;
+					&lt;packing&gt;
+					  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+					  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+					  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+					&lt;/packing&gt;
+				      &lt;/child&gt;
+
+				      &lt;child&gt;
+					&lt;widget class=&quot;GtkVBox&quot; id=&quot;vbox59&quot;&gt;
+					  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+					  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+					  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+					  &lt;child&gt;
+					    &lt;widget class=&quot;GtkRadioButton&quot; id=&quot;radiobutton_nx_floating_window&quot;&gt;
+					      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Floating Window&lt;/property&gt;
+					      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+					      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;active&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;inconsistent&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;draw_indicator&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;group&quot;&gt;radiobutton_nx_new_virtual_desktop&lt;/property&gt;
+					      &lt;signal name=&quot;toggled&quot; handler=&quot;on_radiobutton_nx_new_virtual_desktop_toggled&quot; last_modification_time=&quot;Thu, 13 Apr 2006 12:38:51 GMT&quot;/&gt;
+					    &lt;/widget&gt;
+					    &lt;packing&gt;
+					      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+					      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+					    &lt;/packing&gt;
+					  &lt;/child&gt;
+
+					  &lt;child&gt;
+					    &lt;widget class=&quot;GtkCheckButton&quot; id=&quot;checkbutton_nx_disable_x_agent&quot;&gt;
+					      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;sensitive&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Disable X agent encoding&lt;/property&gt;
+					      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+					      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;active&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;inconsistent&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;draw_indicator&quot;&gt;True&lt;/property&gt;
+					      &lt;signal name=&quot;toggled&quot; handler=&quot;on_checkbutton_nx_disable_x_agent_toggled&quot; last_modification_time=&quot;Thu, 13 Apr 2006 12:40:39 GMT&quot;/&gt;
+					    &lt;/widget&gt;
+					    &lt;packing&gt;
+					      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+					      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+					    &lt;/packing&gt;
+					  &lt;/child&gt;
+
+					  &lt;child&gt;
+					    &lt;widget class=&quot;GtkCheckButton&quot; id=&quot;checkbutton_nx_disable_x_replies&quot;&gt;
+					      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;sensitive&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Disable taint of X replies&lt;/property&gt;
+					      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+					      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;active&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;inconsistent&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;draw_indicator&quot;&gt;True&lt;/property&gt;
+					    &lt;/widget&gt;
+					    &lt;packing&gt;
+					      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+					      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+					    &lt;/packing&gt;
+					  &lt;/child&gt;
+					&lt;/widget&gt;
+					&lt;packing&gt;
+					  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+					  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+					  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+					&lt;/packing&gt;
+				      &lt;/child&gt;
+				    &lt;/widget&gt;
+				  &lt;/child&gt;
+				&lt;/widget&gt;
+			      &lt;/child&gt;
+
+			      &lt;child&gt;
+				&lt;widget class=&quot;GtkLabel&quot; id=&quot;label_nx_custom_settings&quot;&gt;
+				  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;sensitive&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;&lt;i&gt;Custom Settings&lt;/i&gt;&lt;/property&gt;
+				  &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;use_markup&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+				  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+				  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+				  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+				&lt;/widget&gt;
+				&lt;packing&gt;
+				  &lt;property name=&quot;type&quot;&gt;label_item&lt;/property&gt;
+				&lt;/packing&gt;
+			      &lt;/child&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkFrame&quot; id=&quot;frame_nx_xdm&quot;&gt;
+			      &lt;property name=&quot;border_width&quot;&gt;5&lt;/property&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;label_xalign&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;label_yalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;shadow_type&quot;&gt;GTK_SHADOW_OUT&lt;/property&gt;
+
+			      &lt;child&gt;
+				&lt;widget class=&quot;GtkAlignment&quot; id=&quot;alignment31&quot;&gt;
+				  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+				  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+				  &lt;property name=&quot;xscale&quot;&gt;1&lt;/property&gt;
+				  &lt;property name=&quot;yscale&quot;&gt;1&lt;/property&gt;
+				  &lt;property name=&quot;top_padding&quot;&gt;2&lt;/property&gt;
+				  &lt;property name=&quot;bottom_padding&quot;&gt;5&lt;/property&gt;
+				  &lt;property name=&quot;left_padding&quot;&gt;12&lt;/property&gt;
+				  &lt;property name=&quot;right_padding&quot;&gt;2&lt;/property&gt;
+
+				  &lt;child&gt;
+				    &lt;widget class=&quot;GtkVBox&quot; id=&quot;vbox61&quot;&gt;
+				      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+				      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+				      &lt;child&gt;
+					&lt;widget class=&quot;GtkComboBox&quot; id=&quot;combobox_nx_xdm_mode&quot;&gt;
+					  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+					  &lt;property name=&quot;items&quot; translatable=&quot;yes&quot;&gt;Let NX server decide
+Send an XDM query to a host
+Broadcast an XDM query
+Get a list of available X display managers
+&lt;/property&gt;
+					  &lt;signal name=&quot;changed&quot; handler=&quot;on_combobox_nx_xdm_mode_changed&quot; last_modification_time=&quot;Thu, 13 Apr 2006 12:58:45 GMT&quot;/&gt;
+					&lt;/widget&gt;
+					&lt;packing&gt;
+					  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+					  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+					  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+					&lt;/packing&gt;
+				      &lt;/child&gt;
+
+				      &lt;child&gt;
+					&lt;widget class=&quot;GtkHBox&quot; id=&quot;hbox69&quot;&gt;
+					  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+					  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+					  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+					  &lt;child&gt;
+					    &lt;widget class=&quot;GtkLabel&quot; id=&quot;label_nx_xdm_host&quot;&gt;
+					      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Host: &lt;/property&gt;
+					      &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+					      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+					      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+					      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+					      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+					    &lt;/widget&gt;
+					    &lt;packing&gt;
+					      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+					      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+					    &lt;/packing&gt;
+					  &lt;/child&gt;
+
+					  &lt;child&gt;
+					    &lt;widget class=&quot;GtkEntry&quot; id=&quot;entry_nx_xdm_host&quot;&gt;
+					      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;tooltip&quot; translatable=&quot;yes&quot;&gt;The computer running the X display manager.&lt;/property&gt;
+					      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;editable&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;visibility&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;max_length&quot;&gt;0&lt;/property&gt;
+					      &lt;property name=&quot;text&quot; translatable=&quot;yes&quot;&gt;&lt;/property&gt;
+					      &lt;property name=&quot;has_frame&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;invisible_char&quot;&gt;*&lt;/property&gt;
+					      &lt;property name=&quot;activates_default&quot;&gt;False&lt;/property&gt;
+					    &lt;/widget&gt;
+					    &lt;packing&gt;
+					      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+					      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+					    &lt;/packing&gt;
+					  &lt;/child&gt;
+
+					  &lt;child&gt;
+					    &lt;widget class=&quot;GtkLabel&quot; id=&quot;label_nx_xdm_port&quot;&gt;
+					      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Port: &lt;/property&gt;
+					      &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+					      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+					      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+					      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+					      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+					    &lt;/widget&gt;
+					    &lt;packing&gt;
+					      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+					      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+					    &lt;/packing&gt;
+					  &lt;/child&gt;
+
+					  &lt;child&gt;
+					    &lt;widget class=&quot;GtkSpinButton&quot; id=&quot;spinbutton_nx_xdm_port&quot;&gt;
+					      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;tooltip&quot; translatable=&quot;yes&quot;&gt;The port for the XDM connection. Usually 177.&lt;/property&gt;
+					      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;climb_rate&quot;&gt;1&lt;/property&gt;
+					      &lt;property name=&quot;digits&quot;&gt;0&lt;/property&gt;
+					      &lt;property name=&quot;numeric&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_ALWAYS&lt;/property&gt;
+					      &lt;property name=&quot;snap_to_ticks&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+					      &lt;property name=&quot;adjustment&quot;&gt;177 1 32767 1 10 10&lt;/property&gt;
+					    &lt;/widget&gt;
+					    &lt;packing&gt;
+					      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+					      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+					      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+					    &lt;/packing&gt;
+					  &lt;/child&gt;
+					&lt;/widget&gt;
+					&lt;packing&gt;
+					  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+					  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+					  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+					&lt;/packing&gt;
+				      &lt;/child&gt;
+				    &lt;/widget&gt;
+				  &lt;/child&gt;
+				&lt;/widget&gt;
+			      &lt;/child&gt;
+
+			      &lt;child&gt;
+				&lt;widget class=&quot;GtkLabel&quot; id=&quot;label_nx_xdm&quot;&gt;
+				  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;sensitive&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;&lt;i&gt;XDM Settings&lt;/i&gt;&lt;/property&gt;
+				  &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;use_markup&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+				  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+				  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+				  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+				&lt;/widget&gt;
+				&lt;packing&gt;
+				  &lt;property name=&quot;type&quot;&gt;label_item&lt;/property&gt;
+				&lt;/packing&gt;
+			      &lt;/child&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+			&lt;/widget&gt;
+		      &lt;/child&gt;
+		    &lt;/widget&gt;
+		  &lt;/child&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkLabel&quot; id=&quot;label193&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;&lt;i&gt;Desktop Session&lt;/i&gt;&lt;/property&gt;
+		      &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;use_markup&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+		      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+		    &lt;/widget&gt;
+		    &lt;packing&gt;
+		      &lt;property name=&quot;type&quot;&gt;label_item&lt;/property&gt;
+		    &lt;/packing&gt;
+		  &lt;/child&gt;
+		&lt;/widget&gt;
+		&lt;packing&gt;
+		  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+		&lt;/packing&gt;
+	      &lt;/child&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkFrame&quot; id=&quot;frame14&quot;&gt;
+		  &lt;property name=&quot;border_width&quot;&gt;5&lt;/property&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;label_xalign&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;label_yalign&quot;&gt;0.5&lt;/property&gt;
+		  &lt;property name=&quot;shadow_type&quot;&gt;GTK_SHADOW_OUT&lt;/property&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkAlignment&quot; id=&quot;alignment29&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;xscale&quot;&gt;1&lt;/property&gt;
+		      &lt;property name=&quot;yscale&quot;&gt;1&lt;/property&gt;
+		      &lt;property name=&quot;top_padding&quot;&gt;2&lt;/property&gt;
+		      &lt;property name=&quot;bottom_padding&quot;&gt;5&lt;/property&gt;
+		      &lt;property name=&quot;left_padding&quot;&gt;12&lt;/property&gt;
+		      &lt;property name=&quot;right_padding&quot;&gt;2&lt;/property&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkVBox&quot; id=&quot;vbox60&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkHBox&quot; id=&quot;hbox66&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+			      &lt;child&gt;
+				&lt;widget class=&quot;GtkLabel&quot; id=&quot;label194&quot;&gt;
+				  &lt;property name=&quot;width_request&quot;&gt;170&lt;/property&gt;
+				  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Window Size&lt;/property&gt;
+				  &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+				  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+				  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+				  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+				&lt;/widget&gt;
+				&lt;packing&gt;
+				  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+				&lt;/packing&gt;
+			      &lt;/child&gt;
+
+			      &lt;child&gt;
+				&lt;widget class=&quot;GtkComboBox&quot; id=&quot;combobox_nx_window_size&quot;&gt;
+				  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;items&quot; translatable=&quot;yes&quot;&gt;640 x 480
+800 x 600
+1024 x 768
+1280 x 1024
+Custom
+Full Screen&lt;/property&gt;
+				  &lt;signal name=&quot;changed&quot; handler=&quot;on_combobox_nx_window_size_changed&quot; last_modification_time=&quot;Thu, 13 Apr 2006 12:28:43 GMT&quot;/&gt;
+				&lt;/widget&gt;
+				&lt;packing&gt;
+				  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+				&lt;/packing&gt;
+			      &lt;/child&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkHBox&quot; id=&quot;hbox67&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+			      &lt;child&gt;
+				&lt;widget class=&quot;GtkLabel&quot; id=&quot;label195&quot;&gt;
+				  &lt;property name=&quot;width_request&quot;&gt;90&lt;/property&gt;
+				  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Width&lt;/property&gt;
+				  &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+				  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+				  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+				  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+				&lt;/widget&gt;
+				&lt;packing&gt;
+				  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+				&lt;/packing&gt;
+			      &lt;/child&gt;
+
+			      &lt;child&gt;
+				&lt;widget class=&quot;GtkSpinButton&quot; id=&quot;spinbutton_nx_width&quot;&gt;
+				  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;climb_rate&quot;&gt;1&lt;/property&gt;
+				  &lt;property name=&quot;digits&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;numeric&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_ALWAYS&lt;/property&gt;
+				  &lt;property name=&quot;snap_to_ticks&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;adjustment&quot;&gt;640 100 100000 10 100 100&lt;/property&gt;
+				&lt;/widget&gt;
+				&lt;packing&gt;
+				  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+				&lt;/packing&gt;
+			      &lt;/child&gt;
+
+			      &lt;child&gt;
+				&lt;widget class=&quot;GtkLabel&quot; id=&quot;label196&quot;&gt;
+				  &lt;property name=&quot;width_request&quot;&gt;90&lt;/property&gt;
+				  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Height&lt;/property&gt;
+				  &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+				  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+				  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+				  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+				&lt;/widget&gt;
+				&lt;packing&gt;
+				  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+				&lt;/packing&gt;
+			      &lt;/child&gt;
+
+			      &lt;child&gt;
+				&lt;widget class=&quot;GtkSpinButton&quot; id=&quot;spinbutton_nx_height&quot;&gt;
+				  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;climb_rate&quot;&gt;1&lt;/property&gt;
+				  &lt;property name=&quot;digits&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;numeric&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_ALWAYS&lt;/property&gt;
+				  &lt;property name=&quot;snap_to_ticks&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;adjustment&quot;&gt;480 60 10000 10 100 100&lt;/property&gt;
+				&lt;/widget&gt;
+				&lt;packing&gt;
+				  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+				&lt;/packing&gt;
+			      &lt;/child&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+			&lt;/widget&gt;
+		      &lt;/child&gt;
+		    &lt;/widget&gt;
+		  &lt;/child&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkLabel&quot; id=&quot;label197&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;&lt;i&gt;Window Size&lt;/i&gt;&lt;/property&gt;
+		      &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;use_markup&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+		      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+		    &lt;/widget&gt;
+		    &lt;packing&gt;
+		      &lt;property name=&quot;type&quot;&gt;label_item&lt;/property&gt;
+		    &lt;/packing&gt;
+		  &lt;/child&gt;
+		&lt;/widget&gt;
+		&lt;packing&gt;
+		  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+		&lt;/packing&gt;
+	      &lt;/child&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkFrame&quot; id=&quot;frame15&quot;&gt;
+		  &lt;property name=&quot;border_width&quot;&gt;5&lt;/property&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;label_xalign&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;label_yalign&quot;&gt;0.5&lt;/property&gt;
+		  &lt;property name=&quot;shadow_type&quot;&gt;GTK_SHADOW_OUT&lt;/property&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkAlignment&quot; id=&quot;alignment30&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;xscale&quot;&gt;1&lt;/property&gt;
+		      &lt;property name=&quot;yscale&quot;&gt;1&lt;/property&gt;
+		      &lt;property name=&quot;top_padding&quot;&gt;2&lt;/property&gt;
+		      &lt;property name=&quot;bottom_padding&quot;&gt;5&lt;/property&gt;
+		      &lt;property name=&quot;left_padding&quot;&gt;12&lt;/property&gt;
+		      &lt;property name=&quot;right_padding&quot;&gt;2&lt;/property&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkHBox&quot; id=&quot;hbox68&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkComboBox&quot; id=&quot;combobox_nx_image_encoding&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;items&quot; translatable=&quot;yes&quot;&gt;Default
+PNG
+JPEG
+X Bitmap&lt;/property&gt;
+			      &lt;signal name=&quot;changed&quot; handler=&quot;on_combobox_nx_image_encoding_changed&quot; last_modification_time=&quot;Tue, 18 Apr 2006 12:29:08 GMT&quot;/&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkLabel&quot; id=&quot;label_nx_jpeg_quality&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Quality: &lt;/property&gt;
+			      &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+			      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkSpinButton&quot; id=&quot;spinbutton_nx_jpeg_quality&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;tooltip&quot; translatable=&quot;yes&quot;&gt;Lower JPEG quality is equivalent to greater image compression and is good for low capacity links (modem, ISDN and ADSL).&lt;/property&gt;
+			      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;climb_rate&quot;&gt;1&lt;/property&gt;
+			      &lt;property name=&quot;digits&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;numeric&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;update_policy&quot;&gt;GTK_UPDATE_ALWAYS&lt;/property&gt;
+			      &lt;property name=&quot;snap_to_ticks&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;wrap&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;adjustment&quot;&gt;9 0 9 1 3 3&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+			&lt;/widget&gt;
+		      &lt;/child&gt;
+		    &lt;/widget&gt;
+		  &lt;/child&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkLabel&quot; id=&quot;label199&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;&lt;i&gt;Image Encoding&lt;/i&gt;&lt;/property&gt;
+		      &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;use_markup&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+		      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+		    &lt;/widget&gt;
+		    &lt;packing&gt;
+		      &lt;property name=&quot;type&quot;&gt;label_item&lt;/property&gt;
+		    &lt;/packing&gt;
+		  &lt;/child&gt;
+		&lt;/widget&gt;
+		&lt;packing&gt;
+		  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+		&lt;/packing&gt;
+	      &lt;/child&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkFrame&quot; id=&quot;frame16&quot;&gt;
+		  &lt;property name=&quot;border_width&quot;&gt;5&lt;/property&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;label_xalign&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;label_yalign&quot;&gt;0.5&lt;/property&gt;
+		  &lt;property name=&quot;shadow_type&quot;&gt;GTK_SHADOW_OUT&lt;/property&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkAlignment&quot; id=&quot;alignment41&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;xscale&quot;&gt;1&lt;/property&gt;
+		      &lt;property name=&quot;yscale&quot;&gt;1&lt;/property&gt;
+		      &lt;property name=&quot;top_padding&quot;&gt;2&lt;/property&gt;
+		      &lt;property name=&quot;bottom_padding&quot;&gt;5&lt;/property&gt;
+		      &lt;property name=&quot;left_padding&quot;&gt;12&lt;/property&gt;
+		      &lt;property name=&quot;right_padding&quot;&gt;2&lt;/property&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkCheckButton&quot; id=&quot;checkbutton_nx_enable_sound&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Enable sound support&lt;/property&gt;
+			  &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+			  &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;active&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;inconsistent&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;draw_indicator&quot;&gt;True&lt;/property&gt;
+			&lt;/widget&gt;
+		      &lt;/child&gt;
+		    &lt;/widget&gt;
+		  &lt;/child&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkLabel&quot; id=&quot;label222&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;&lt;i&gt;Services&lt;/i&gt;&lt;/property&gt;
+		      &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;use_markup&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+		      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+		    &lt;/widget&gt;
+		    &lt;packing&gt;
+		      &lt;property name=&quot;type&quot;&gt;label_item&lt;/property&gt;
+		    &lt;/packing&gt;
+		  &lt;/child&gt;
+		&lt;/widget&gt;
+		&lt;packing&gt;
+		  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+		&lt;/packing&gt;
+	      &lt;/child&gt;
+	    &lt;/widget&gt;
+	    &lt;packing&gt;
+	      &lt;property name=&quot;tab_expand&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;tab_fill&quot;&gt;True&lt;/property&gt;
+	    &lt;/packing&gt;
+	  &lt;/child&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkLabel&quot; id=&quot;label200&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Desktop&lt;/property&gt;
+	      &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+	      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+	      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+	      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+	    &lt;/widget&gt;
+	    &lt;packing&gt;
+	      &lt;property name=&quot;type&quot;&gt;tab&lt;/property&gt;
+	    &lt;/packing&gt;
+	  &lt;/child&gt;
+	&lt;/widget&gt;
+	&lt;packing&gt;
+	  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+	&lt;/packing&gt;
+      &lt;/child&gt;
+    &lt;/widget&gt;
+  &lt;/child&gt;
+&lt;/widget&gt;
+
+&lt;widget class=&quot;GtkWindow&quot; id=&quot;manage_nx_key&quot;&gt;
+  &lt;property name=&quot;title&quot; translatable=&quot;yes&quot;&gt;Public SSL Key&lt;/property&gt;
+  &lt;property name=&quot;type&quot;&gt;GTK_WINDOW_TOPLEVEL&lt;/property&gt;
+  &lt;property name=&quot;window_position&quot;&gt;GTK_WIN_POS_CENTER_ON_PARENT&lt;/property&gt;
+  &lt;property name=&quot;modal&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;default_width&quot;&gt;600&lt;/property&gt;
+  &lt;property name=&quot;default_height&quot;&gt;300&lt;/property&gt;
+  &lt;property name=&quot;resizable&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;destroy_with_parent&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;icon&quot;&gt;nx-icon.png&lt;/property&gt;
+  &lt;property name=&quot;decorated&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;skip_taskbar_hint&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;skip_pager_hint&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;type_hint&quot;&gt;GDK_WINDOW_TYPE_HINT_DIALOG&lt;/property&gt;
+  &lt;property name=&quot;gravity&quot;&gt;GDK_GRAVITY_CENTER&lt;/property&gt;
+
+  &lt;child&gt;
+    &lt;widget class=&quot;GtkVBox&quot; id=&quot;vbox62&quot;&gt;
+      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+      &lt;child&gt;
+	&lt;widget class=&quot;GtkScrolledWindow&quot; id=&quot;scrolledwindow_nx_key&quot;&gt;
+	  &lt;property name=&quot;border_width&quot;&gt;1&lt;/property&gt;
+	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;hscrollbar_policy&quot;&gt;GTK_POLICY_ALWAYS&lt;/property&gt;
+	  &lt;property name=&quot;vscrollbar_policy&quot;&gt;GTK_POLICY_ALWAYS&lt;/property&gt;
+	  &lt;property name=&quot;shadow_type&quot;&gt;GTK_SHADOW_IN&lt;/property&gt;
+	  &lt;property name=&quot;window_placement&quot;&gt;GTK_CORNER_TOP_LEFT&lt;/property&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkTextView&quot; id=&quot;textview_nx_key&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;editable&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;overwrite&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;accepts_tab&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;justification&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+	      &lt;property name=&quot;wrap_mode&quot;&gt;GTK_WRAP_NONE&lt;/property&gt;
+	      &lt;property name=&quot;cursor_visible&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;pixels_above_lines&quot;&gt;1&lt;/property&gt;
+	      &lt;property name=&quot;pixels_below_lines&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;pixels_inside_wrap&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;left_margin&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;right_margin&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;indent&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;text&quot; translatable=&quot;yes&quot;&gt;SSL Key goes here...&lt;/property&gt;
+	    &lt;/widget&gt;
+	  &lt;/child&gt;
+	&lt;/widget&gt;
+	&lt;packing&gt;
+	  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+	&lt;/packing&gt;
+      &lt;/child&gt;
+
+      &lt;child&gt;
+	&lt;widget class=&quot;GtkHButtonBox&quot; id=&quot;hbuttonbox16&quot;&gt;
+	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;layout_style&quot;&gt;GTK_BUTTONBOX_END&lt;/property&gt;
+	  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkButton&quot; id=&quot;button_change_ssl_key&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;tooltip&quot; translatable=&quot;yes&quot;&gt;Choose a new key from a usb key drive or a downloaded file.&lt;/property&gt;
+	      &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+	      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+	      &lt;signal name=&quot;clicked&quot; handler=&quot;gtk_widget_show&quot; object=&quot;filechooserdialog_nx_key&quot; last_modification_time=&quot;Tue, 18 Apr 2006 15:00:23 GMT&quot;/&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkAlignment&quot; id=&quot;alignment32&quot;&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+		  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+		  &lt;property name=&quot;xscale&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;yscale&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;top_padding&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;bottom_padding&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;left_padding&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;right_padding&quot;&gt;0&lt;/property&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkHBox&quot; id=&quot;hbox70&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;spacing&quot;&gt;2&lt;/property&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkImage&quot; id=&quot;image20&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;stock&quot;&gt;gtk-open&lt;/property&gt;
+			  &lt;property name=&quot;icon_size&quot;&gt;4&lt;/property&gt;
+			  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+			  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+			  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkLabel&quot; id=&quot;label203&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;C_hange Key&lt;/property&gt;
+			  &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+			  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+			  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+			  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+		    &lt;/widget&gt;
+		  &lt;/child&gt;
+		&lt;/widget&gt;
+	      &lt;/child&gt;
+	    &lt;/widget&gt;
+	  &lt;/child&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkButton&quot; id=&quot;button_nx_revert_ssl_key&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;tooltip&quot; translatable=&quot;yes&quot;&gt;Revert to the default NX server public SSL key.&lt;/property&gt;
+	      &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+	      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+	      &lt;signal name=&quot;clicked&quot; handler=&quot;on_button_nx_revert_ssl_key_clicked&quot; last_modification_time=&quot;Thu, 20 Apr 2006 09:22:08 GMT&quot;/&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkAlignment&quot; id=&quot;alignment33&quot;&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+		  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+		  &lt;property name=&quot;xscale&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;yscale&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;top_padding&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;bottom_padding&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;left_padding&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;right_padding&quot;&gt;0&lt;/property&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkHBox&quot; id=&quot;hbox71&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;spacing&quot;&gt;2&lt;/property&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkImage&quot; id=&quot;image21&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;stock&quot;&gt;gtk-revert-to-saved&lt;/property&gt;
+			  &lt;property name=&quot;icon_size&quot;&gt;4&lt;/property&gt;
+			  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+			  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+			  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkLabel&quot; id=&quot;label204&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;label&quot;&gt;Revert to _Default&lt;/property&gt;
+			  &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+			  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+			  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+			  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+		    &lt;/widget&gt;
+		  &lt;/child&gt;
+		&lt;/widget&gt;
+	      &lt;/child&gt;
+	    &lt;/widget&gt;
+	  &lt;/child&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkButton&quot; id=&quot;button27&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+	      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+	      &lt;signal name=&quot;clicked&quot; handler=&quot;gtk_widget_hide&quot; object=&quot;manage_nx_key&quot; last_modification_time=&quot;Thu, 20 Apr 2006 08:16:48 GMT&quot;/&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkAlignment&quot; id=&quot;alignment34&quot;&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+		  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+		  &lt;property name=&quot;xscale&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;yscale&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;top_padding&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;bottom_padding&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;left_padding&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;right_padding&quot;&gt;0&lt;/property&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkHBox&quot; id=&quot;hbox72&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+		      &lt;property name=&quot;spacing&quot;&gt;2&lt;/property&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkImage&quot; id=&quot;image22&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;stock&quot;&gt;gtk-close&lt;/property&gt;
+			  &lt;property name=&quot;icon_size&quot;&gt;4&lt;/property&gt;
+			  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+			  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+			  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkLabel&quot; id=&quot;label205&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;_Close Window&lt;/property&gt;
+			  &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+			  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+			  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+			  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+			&lt;/widget&gt;
+			&lt;packing&gt;
+			  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			&lt;/packing&gt;
+		      &lt;/child&gt;
+		    &lt;/widget&gt;
+		  &lt;/child&gt;
+		&lt;/widget&gt;
+	      &lt;/child&gt;
+	    &lt;/widget&gt;
+	  &lt;/child&gt;
+	&lt;/widget&gt;
+	&lt;packing&gt;
+	  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+	  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+	&lt;/packing&gt;
+      &lt;/child&gt;
+    &lt;/widget&gt;
+  &lt;/child&gt;
+&lt;/widget&gt;
+
+&lt;widget class=&quot;GtkFileChooserDialog&quot; id=&quot;filechooserdialog_nx_key&quot;&gt;
+  &lt;property name=&quot;action&quot;&gt;GTK_FILE_CHOOSER_ACTION_OPEN&lt;/property&gt;
+  &lt;property name=&quot;local_only&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;select_multiple&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;show_hidden&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;title&quot; translatable=&quot;yes&quot;&gt;Locate SSL Public Key text file&lt;/property&gt;
+  &lt;property name=&quot;type&quot;&gt;GTK_WINDOW_TOPLEVEL&lt;/property&gt;
+  &lt;property name=&quot;window_position&quot;&gt;GTK_WIN_POS_CENTER_ON_PARENT&lt;/property&gt;
+  &lt;property name=&quot;modal&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;resizable&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;destroy_with_parent&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;icon&quot;&gt;nx-icon.png&lt;/property&gt;
+  &lt;property name=&quot;decorated&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;skip_taskbar_hint&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;skip_pager_hint&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;type_hint&quot;&gt;GDK_WINDOW_TYPE_HINT_DIALOG&lt;/property&gt;
+  &lt;property name=&quot;gravity&quot;&gt;GDK_GRAVITY_CENTER&lt;/property&gt;
+
+  &lt;child internal-child=&quot;vbox&quot;&gt;
+    &lt;widget class=&quot;GtkVBox&quot; id=&quot;dialog-vbox7&quot;&gt;
+      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+      &lt;property name=&quot;spacing&quot;&gt;24&lt;/property&gt;
+
+      &lt;child internal-child=&quot;action_area&quot;&gt;
+	&lt;widget class=&quot;GtkHButtonBox&quot; id=&quot;dialog-action_area7&quot;&gt;
+	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;layout_style&quot;&gt;GTK_BUTTONBOX_END&lt;/property&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkButton&quot; id=&quot;button23&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;label&quot;&gt;gtk-cancel&lt;/property&gt;
+	      &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+	      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;response_id&quot;&gt;-6&lt;/property&gt;
+	      &lt;signal name=&quot;clicked&quot; handler=&quot;gtk_widget_hide&quot; object=&quot;filechooserdialog_nx_key&quot; last_modification_time=&quot;Tue, 18 Apr 2006 15:01:06 GMT&quot;/&gt;
+	    &lt;/widget&gt;
+	  &lt;/child&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkButton&quot; id=&quot;button24&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;has_default&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;label&quot;&gt;gtk-open&lt;/property&gt;
+	      &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+	      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;response_id&quot;&gt;-5&lt;/property&gt;
+	      &lt;signal name=&quot;clicked&quot; handler=&quot;on_nx_key_file_chosen&quot; last_modification_time=&quot;Tue, 18 Apr 2006 15:01:42 GMT&quot;/&gt;
+	    &lt;/widget&gt;
+	  &lt;/child&gt;
+	&lt;/widget&gt;
+	&lt;packing&gt;
+	  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+	  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;pack_type&quot;&gt;GTK_PACK_END&lt;/property&gt;
+	&lt;/packing&gt;
+      &lt;/child&gt;
+    &lt;/widget&gt;
+  &lt;/child&gt;
+&lt;/widget&gt;
+
+&lt;/glade-interface&gt;

Added: nxlaunch/src/nxlaunch.c
===================================================================
--- nxlaunch/src/nxlaunch.c	2007-09-16 20:16:05 UTC (rev 380)
+++ nxlaunch/src/nxlaunch.c	2007-09-17 12:30:56 UTC (rev 381)
@@ -0,0 +1,1697 @@
+/***************************************************************************
+                   nxlaunch: A GTK NX Client based on nxcl
+                   ---------------------------------------
+    begin                : September 2007
+    copyright            : (C) 2007 Embedded Software Foundry Ltd. (U.K.)
+                         :     Author: Sebastian James
+    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/freenx-cvs">seb at esfnet.co.uk</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#include &quot;i18n.h&quot;
+
+/*! 
+ * config.h is created by the configure script and contains
+ * configure/compile time choices made by the program compiler.
+ */
+#include &quot;../config.h&quot;
+
+#include &lt;glade/glade.h&gt;
+#include &lt;gtk/gtk.h&gt;
+#include &lt;stdlib.h&gt;
+#include &lt;stdio.h&gt;
+#include &lt;sys/types.h&gt;
+#include &lt;sys/wait.h&gt;
+#include &lt;sys/stat.h&gt;
+#include &lt;fcntl.h&gt;
+#include &lt;locale.h&gt;
+#include &lt;dirent.h&gt;
+#include &lt;string.h&gt;
+#include &lt;unistd.h&gt;
+#define DBUS_API_SUBJECT_TO_CHANGE 1
+#include &lt;dbus/dbus.h&gt;
+
+#include &quot;nxlaunch.h&quot;
+#include &quot;../lib/callbacks_nx.h&quot;
+
+/* Use a global for the xml tree */
+extern GladeXML * xml_nxlaunch_glob;
+#if BUILT_IN_CONFIGURATION==1
+extern GladeXML * xml_glob;
+#endif
+
+extern GtkListStore * conn_store;
+extern GtkTreeIter    conn_iter;
+extern GtkTreeIter    active_iter_glob;
+extern guint          next_conn_type;
+extern GtkListStore * sess_store;
+extern GtkTreeIter    sess_iter;
+extern guint          next_sess_type;
+
+/*!
+ * Lazily use some globals for the send/receive dbus interfaces.
+ */
+extern gchar * dbusSendInterface;
+extern gchar * dbusRecvInterface;
+extern gchar * dbusMatchString;
+extern int              dbusNum;
+extern DBusConnection * dbusConn;
+extern DBusError        dbusErr;
+
+/*!
+ * The modus operandi. See main.c and nxlaunch.h
+ */
+extern int nxlaunch_mode;
+
+/*!
+ * Oh, look, another global! This one is used to hold connection
+ * information pulled out of the gtk_tree_model of connections when
+ * the user launches nxlaunch with a connection name argument. This
+ * one is local to nxlaunch.o
+ *
+ * WARNING: This is a possible source of a hanging pointer!
+ */
+struct nx_connection * nx_conn_glob = NULL;
+
+/*!
+ * Callback Functions are first in nxlaunch.c
+ */
+//@{
+
+/*!
+ * Callback for the delete-event signal 
+ */
+gboolean on_main_win_delete_event (GtkWidget * widget, 
+				   GdkEvent * event,
+				   gpointer user_data)
+{
+	return FALSE;
+}
+
+/*!
+ * There's a password entry on the main window and then a standalone
+ * password entry box. 
+ *
+ * If we are launching from the main window, then we use the
+ * password entry box on the main window, which is filled in from the
+ * configuration file if applicable.
+ *
+ * If the user presses launch without entering a password, then we
+ * either prompt him to enter on on the main window or we throw up
+ * the dedicated password window for him to enter the password there.
+ *
+ * If we are launching a connection from a name supplied on the cmd
+ * line then we don't show the main window, instead we give the user
+ * the dedicated password window.
+ *
+ * If we are launching a connection from a file given on the cmd line,
+ * then we do as for a name given on the cmd line.
+ *
+ * This implies we start up in different modes; something like:
+ * MODE_MAIN - no switches given
+ * MODE_NAMED - just a name given
+ * MODE_FILE - a file switch given
+ * MODE_EDIT_NAMED - name and --edit switch given
+ * MODE_EDIT_FILE - file and --edit switch given
+ *
+ * Do we want a global to hold the mode?
+ */
+void on_button_nxlaunch_launch_clicked (GtkButton * button)
+{
+	GtkWidget * widget;
+	struct nx_connection * nx_conn = NULL;	
+
+	int flags = checkActiveConnectionPassword();
+
+	/* Malloc and get active connection if state is correct */
+	if ((flags &amp; STORED_PASSWORD) || 
+	    (nxlaunch_mode == MODE_MAIN &amp;&amp; (flags &amp; ENTERED_PASSWORD)) ) {
+		printerr (&quot;Have entered or stored password\n&quot;);
+
+		/* Get the currently activated connection */
+		nx_conn = g_malloc0 (sizeof(struct nx_connection));
+		getActiveConnection (nx_conn);
+
+		/* Grey out the main window */
+		widget = glade_xml_get_widget (xml_nxlaunch_glob, &quot;nxlauncher&quot;);
+		gtk_widget_set_sensitive (widget, FALSE);
+		while (gtk_events_pending()) gtk_main_iteration();
+	}
+
+
+	if (flags &amp; STORED_PASSWORD) {
+
+		printerr (&quot;There's a stored password, just launch connection\n&quot;);
+		launch_connection (nx_conn);
+
+	} else if (nxlaunch_mode == MODE_MAIN &amp;&amp; (flags &amp; ENTERED_PASSWORD)) {
+
+		printerr (&quot;User entered password; get password into nx_conn then launch.\n&quot;);
+		/* Read the password into nx_conn-&gt;Pass, mallocing if necessary */
+		widget = glade_xml_get_widget (xml_nxlaunch_glob, &quot;entry_nxlaunch_password&quot;);
+		if (!(nx_conn-&gt;Pass = g_try_realloc (nx_conn-&gt;Pass, 
+						     NX_FIELDLEN * sizeof(gchar)))) {
+			printerr (&quot;NXLAUNCH&gt; Failed g_try_realloc in %s\n&quot;, __FUNCTION__);
+		}
+		strncpy (nx_conn-&gt;Pass, gtk_entry_get_text (GTK_ENTRY(widget)), NX_FIELDLEN);
+		gtk_entry_set_text (GTK_ENTRY(widget), &quot;&quot;);
+
+		launch_connection (nx_conn);
+
+	} else {
+		/* In this case, nx_conn should not have been
+		   g_malloc0ed */
+		if (nx_conn != NULL) {
+			g_error (&quot;We seem to have allocated memory when we shouldn't have\n&quot;);
+			_exit(-1);
+		}
+		
+		/* Prompt user to enter password in the password box */
+		widget = glade_xml_get_widget (xml_nxlaunch_glob, &quot;dialog_password&quot;);
+		gtk_widget_show_all (widget);
+		while (gtk_events_pending()) gtk_main_iteration();
+		widget = glade_xml_get_widget (xml_nxlaunch_glob, &quot;nxlauncher&quot;);
+		gtk_widget_set_sensitive (widget, FALSE);
+	}
+	return;
+}
+
+#if BUILT_IN_CONFIGURATION==1
+void on_button_nxlaunch_new_clicked (GtkButton * button)
+{
+	GtkWidget * widget;
+
+	widget = glade_xml_get_widget (xml_glob, &quot;conn_new_nx&quot;);
+	gtk_widget_show_all (widget);
+
+	return;
+}
+
+void on_button_nxlaunch_edit_clicked (GtkButton * button)
+{
+	GtkWidget * widget;
+	struct nx_connection * nx_conn;
+
+	widget = glade_xml_get_widget (xml_glob, &quot;conn_new_nx&quot;);
+	gtk_widget_show_all (widget);
+
+	// Read in nx_conn for the highlighted entry
+	nx_conn = g_malloc0 (sizeof (struct nx_connection));
+	getActiveConnection (nx_conn);
+	setup_nx_popup (nx_conn);
+	nx_connection_free (nx_conn);
+
+	return;
+}
+
+void on_button_nxlaunch_delete_clicked (GtkButton * button)
+{
+	printerr (&quot;%s\n&quot;, __FUNCTION__);
+	return;
+}
+
+void on_conn_new_ok_clicked (GtkButton * button)
+{
+	GtkTreeView * list_tree;
+	GtkTreeSelection * selected;
+	GtkTreeIter iter;
+	GtkTreeModel * tree_model;
+
+	gchar dummy_name[NX_FIELDLEN];
+	gchar dummy_server[NX_FIELDLEN];
+	gchar dummy_uname[NX_FIELDLEN];
+	int dummy_fullscreen = 0;
+	struct nx_connection * nx_conn;
+
+	/*
+	 * read_nx_popup() into nx_conn. Update the connection list
+	 * entry from the data.
+	 */
+	nx_conn = nx_connection_malloc();
+	read_nx_popup (dummy_name, dummy_server, dummy_uname, &amp;dummy_fullscreen, nx_conn);
+
+	/* Get iter for current row and update connection list. */
+	list_tree = GTK_TREE_VIEW (glade_xml_get_widget (xml_nxlaunch_glob, &quot;treeview_nxconnection&quot;));
+	selected = gtk_tree_view_get_selection (list_tree);
+	tree_model = GTK_TREE_MODEL (conn_store);
+	if (gtk_tree_selection_get_selected (selected, &amp;tree_model, &amp;iter)) {
+		gtk_list_store_set (conn_store, &amp;conn_iter,
+				    CONN_CONNECTIONNAME,    nx_conn-&gt;ConnectionName,
+				    CONN_SERVERHOST,        nx_conn-&gt;ServerHost,
+				    CONN_SERVERPORT,        nx_conn-&gt;ServerPort,
+				    CONN_USER,              nx_conn-&gt;User,
+				    CONN_PASS,              nx_conn-&gt;Pass,
+				    CONN_REMEMBERPASS,      nx_conn-&gt;RememberPassword ? TRUE : FALSE,
+				    CONN_DISABLENODELAY,    nx_conn-&gt;DisableNoDelay ? TRUE : FALSE,
+				    CONN_DISABLEZLIB,       nx_conn-&gt;DisableZLIB ? TRUE : FALSE,
+				    CONN_ENABLESSLONLY,     nx_conn-&gt;EnableSSLOnly ? TRUE : FALSE,
+				    CONN_LINKSPEED,         nx_conn-&gt;LinkSpeed,
+				    CONN_PUBLICKEY,         nx_conn-&gt;PublicKey,
+				    CONN_DESKTOP,           nx_conn-&gt;Desktop,
+				    CONN_CUSTOMUNIXDESKTOP, nx_conn-&gt;CustomUnixDesktop,
+				    CONN_COMMANDLINE,       nx_conn-&gt;CommandLine,
+				    CONN_VIRTUALDESKTOP,    nx_conn-&gt;VirtualDesktop ? TRUE : FALSE,
+				    CONN_XAGENTENCODING,    nx_conn-&gt;XAgentEncoding ? TRUE : FALSE,
+				    CONN_USETAINT,          nx_conn-&gt;UseTaint ? TRUE : FALSE,
+				    CONN_XDMMODE,           nx_conn-&gt;XdmMode,
+				    CONN_XDMHOST,           nx_conn-&gt;XdmHost,
+				    CONN_XDMPORT,           nx_conn-&gt;XdmPort,
+				    CONN_FULLSCREEN,        nx_conn-&gt;FullScreen ? TRUE : FALSE,	    
+				    CONN_RESOLUTIONWIDTH,   nx_conn-&gt;ResolutionWidth,
+				    CONN_RESOLUTIONHEIGHT,  nx_conn-&gt;ResolutionHeight,
+				    CONN_GEOMETRY,          nx_conn-&gt;Geometry,
+				    CONN_IMAGEENCODING,     nx_conn-&gt;ImageEncoding,
+				    CONN_JPEGQUALITY,       nx_conn-&gt;JPEGQuality,
+				    CONN_ENABLESOUND,       nx_conn-&gt;enableSound ? TRUE : FALSE,
+				    CONN_IPPPORT,           nx_conn-&gt;IPPPort,
+				    CONN_IPPPRINTING,       nx_conn-&gt;IPPPrinting ? TRUE : FALSE,
+				    CONN_SHARES,            nx_conn-&gt;Shares ? TRUE : FALSE,
+				    CONN_AGENTSERVER,       nx_conn-&gt;agentServer,
+				    CONN_AGENTUSER,         nx_conn-&gt;agentUser,
+				    CONN_AGENTPASS,         nx_conn-&gt;agentPass,
+				    -1);
+	}
+
+	nx_connection_free (nx_conn);
+	return;
+}
+#endif	
+
+void on_button_nxlaunch_quit_clicked (GtkButton * button)
+{
+	gtk_main_quit();
+	return;
+}
+
+/*!
+ * Connect to the highlighted connection
+ */
+void on_button_nxsession_connect_clicked (GtkButton * button)
+{
+	GtkTreeView * list_tree;
+	GtkTreeSelection * selected;
+	GtkTreeIter iter;
+	GtkTreeModel * tree_model;
+	int sessionNum = -1;
+
+	printerr (&quot;%s() called\n&quot;, __FUNCTION__);
+
+	/* Get the highlighted row in the nxsession list window */
+	list_tree = GTK_TREE_VIEW (glade_xml_get_widget (xml_nxlaunch_glob, &quot;treeview_nxsession&quot;));
+	selected = gtk_tree_view_get_selection (list_tree);
+	tree_model = GTK_TREE_MODEL (conn_store);
+	if (gtk_tree_selection_get_selected (selected, &amp;tree_model, &amp;iter)) {
+		/* Get the sessionNum out. */
+		gtk_tree_model_get (tree_model, &amp;iter, SESS_INDEX, &amp;sessionNum, -1);
+	}
+
+	/* Call the &quot;session connect dbus message&quot; fn */
+	if (sessionNum &gt; -1) {
+		sendReply (dbusConn, sessionNum);
+	} else {
+		printerr (&quot;NXLAUNCH&gt; %s(): Failed to set sessionNum from the session list gtk tree model\n&quot;,
+			  __FUNCTION__);
+	}
+
+	nxlaunch_display_progress();
+}
+
+/*!
+ * Send a launch message, saying &quot;launch new&quot;
+ */
+void on_button_nxsession_launch_clicked (GtkButton * button)
+{
+	sendReply (dbusConn, -1);
+	nxlaunch_display_progress();
+}
+
+void on_button_nxsession_terminate_clicked (GtkButton * button)
+{
+	GtkTreeView * list_tree;
+	GtkTreeSelection * selected;
+	GtkTreeIter iter;
+	GtkTreeModel * tree_model;
+	int sessionNum = -1;
+
+	printerr (&quot;%s() called\n&quot;, __FUNCTION__);
+
+	/* Get the highlighted row in the nxsession list window */
+	list_tree = GTK_TREE_VIEW (glade_xml_get_widget (xml_nxlaunch_glob, &quot;treeview_nxsession&quot;));
+	selected = gtk_tree_view_get_selection (list_tree);
+	tree_model = GTK_TREE_MODEL (conn_store);
+	if (gtk_tree_selection_get_selected (selected, &amp;tree_model, &amp;iter)) {
+		/* Get the sessionNum out. */
+		gtk_tree_model_get (tree_model, &amp;iter, SESS_INDEX, &amp;sessionNum, -1);
+	}
+
+	if (sessionNum &gt; -1) {
+		terminateSession (dbusConn, sessionNum);
+	} else {
+		printerr (&quot;NXLAUNCH&gt; %s(): Failed to set sessionNum from the session list gtk tree model\n&quot;,
+			  __FUNCTION__);
+	}
+	
+	return;
+}
+
+void on_button_nxsession_cancel_clicked (GtkButton * button)
+{
+	GtkWidget * widget;
+
+	widget = glade_xml_get_widget (xml_nxlaunch_glob, &quot;session_list&quot;);
+	gtk_widget_hide (widget);
+	widget = glade_xml_get_widget (xml_nxlaunch_glob, &quot;nxlauncher&quot;);
+	gtk_widget_set_sensitive (widget, TRUE);
+	gtk_widget_show (widget);
+
+	return;
+}
+
+void on_treeview_connection_cursor_changed (GtkWidget * widget)
+{
+	/* We get passed the treeview_nxconnection object here */
+	GtkTreeSelection * selected;
+	GtkTreeIter iter;
+	GtkTreeModel * tree_model;
+	gchar * the_user, * the_pass;
+	GtkWidget * entrybox;
+
+	/* We get passed the gtktreeview */
+	selected = gtk_tree_view_get_selection (GTK_TREE_VIEW (widget));
+	tree_model = GTK_TREE_MODEL (conn_store);
+	if (gtk_tree_selection_get_selected (selected, &amp;tree_model, &amp;iter)) {
+
+		/* Get all the information out of the row */
+		gtk_tree_model_get (tree_model, &amp;iter,
+				    CONN_USER, &amp;the_user, 
+				    CONN_PASS, &amp;the_pass,
+				    -1);
+	}	
+
+	/*
+	 * Now place the user in entry_nxlaunch_user
+	 */
+	entrybox = glade_xml_get_widget (xml_nxlaunch_glob, &quot;entry_nxlaunch_user&quot;);
+	if (strlen (the_user) &lt; 1) {
+		the_user = g_realloc (the_user, sizeof(gchar)&lt;&lt;3); // 8 gchars
+		snprintf (the_user, 6, &quot;%s&quot;, &quot;noone&quot;);
+	}
+	gtk_entry_set_text (GTK_ENTRY(entrybox), the_user);
+
+	/*
+	 * Fill in the password if it has been set in the
+	 * configuration file
+	 */
+	entrybox = glade_xml_get_widget (xml_nxlaunch_glob, &quot;entry_nxlaunch_password&quot;);
+	if (strlen (the_pass) &gt; 0) {
+		gtk_entry_set_text (GTK_ENTRY(entrybox), the_pass);
+	}
+	
+	g_free (the_user);
+	g_free (the_pass);
+
+	// Place the focus on the password entry box
+	//gtk_widget_grab_focus (entrybox);
+	
+	return;
+}
+
+//@} Callbacks
+
+
+int nxconnection_buildlist (void)
+{
+	DIR *dp;
+	struct dirent *ep;
+	int nlen = 0, rtn = 0;
+	gchar config[1024];
+
+	snprintf (config, 1023, &quot;%s/.nx/config&quot;, getenv(&quot;HOME&quot;));
+
+	dp = opendir (config);
+	if (dp == NULL) {
+		printerr (&quot;Couldn't opendir...\n&quot;);
+		return 0;
+	}
+
+	while ((ep = readdir (dp))) {
+
+		/* If d_name ends in .nxs, it should be an NX config file. */
+		nlen = strlen (ep-&gt;d_name);
+		if ( ep-&gt;d_name[--nlen] == 's'
+		     &amp;&amp; ep-&gt;d_name[--nlen] == 'x'
+		     &amp;&amp; ep-&gt;d_name[--nlen] == 'n'
+		     &amp;&amp; ep-&gt;d_name[--nlen] == '.' ) {
+			
+			gchar nxname[128];
+			snprintf (nxname, ++nlen, ep-&gt;d_name);
+			struct nx_connection * nx_conn;
+			nx_conn = nx_connection_malloc();
+			/* Read in the connection using the callbacks_nx library fn */
+			if (0 == read_nx_connection (nx_conn, nxname)) {
+				/* Now place it in the connection store list */
+				gtk_list_store_append (conn_store, &amp;conn_iter);
+				gtk_list_store_set (conn_store, &amp;conn_iter,
+						    CONN_CONNECTIONNAME,    nx_conn-&gt;ConnectionName,
+						    CONN_SERVERHOST,        nx_conn-&gt;ServerHost,
+						    CONN_SERVERPORT,        nx_conn-&gt;ServerPort,
+						    CONN_USER,              nx_conn-&gt;User,
+						    CONN_PASS,              nx_conn-&gt;Pass,
+						    CONN_REMEMBERPASS,      nx_conn-&gt;RememberPassword ? TRUE : FALSE,
+						    CONN_DISABLENODELAY,    nx_conn-&gt;DisableNoDelay ? TRUE : FALSE,
+						    CONN_DISABLEZLIB,       nx_conn-&gt;DisableZLIB ? TRUE : FALSE,
+						    CONN_ENABLESSLONLY,     nx_conn-&gt;EnableSSLOnly ? TRUE : FALSE,
+						    CONN_LINKSPEED,         nx_conn-&gt;LinkSpeed,
+						    CONN_PUBLICKEY,         nx_conn-&gt;PublicKey,
+						    CONN_DESKTOP,           nx_conn-&gt;Desktop,
+						    CONN_CUSTOMUNIXDESKTOP, nx_conn-&gt;CustomUnixDesktop,
+						    CONN_COMMANDLINE,       nx_conn-&gt;CommandLine,
+						    CONN_VIRTUALDESKTOP,    nx_conn-&gt;VirtualDesktop ? TRUE : FALSE,
+						    CONN_XAGENTENCODING,    nx_conn-&gt;XAgentEncoding ? TRUE : FALSE,
+						    CONN_USETAINT,          nx_conn-&gt;UseTaint ? TRUE : FALSE,
+						    CONN_XDMMODE,           nx_conn-&gt;XdmMode,
+						    CONN_XDMHOST,           nx_conn-&gt;XdmHost,
+						    CONN_XDMPORT,           nx_conn-&gt;XdmPort,
+						    CONN_FULLSCREEN,        nx_conn-&gt;FullScreen ? TRUE : FALSE,	    
+						    CONN_RESOLUTIONWIDTH,   nx_conn-&gt;ResolutionWidth,
+						    CONN_RESOLUTIONHEIGHT,  nx_conn-&gt;ResolutionHeight,
+						    CONN_GEOMETRY,          nx_conn-&gt;Geometry,
+						    CONN_IMAGEENCODING,     nx_conn-&gt;ImageEncoding,
+						    CONN_JPEGQUALITY,       nx_conn-&gt;JPEGQuality,
+						    CONN_ENABLESOUND,       nx_conn-&gt;enableSound ? TRUE : FALSE,
+						    CONN_IPPPORT,           nx_conn-&gt;IPPPort,
+						    CONN_IPPPRINTING,       nx_conn-&gt;IPPPrinting ? TRUE : FALSE,
+						    CONN_SHARES,            nx_conn-&gt;Shares ? TRUE : FALSE,
+						    CONN_AGENTSERVER,       nx_conn-&gt;agentServer,
+						    CONN_AGENTUSER,         nx_conn-&gt;agentUser,
+						    CONN_AGENTPASS,         nx_conn-&gt;agentPass,
+						    -1);
+				rtn++;
+			}
+			nx_connection_free (nx_conn);
+		}
+	}
+	closedir (dp);
+
+	if (rtn &gt; 0) {
+		GtkTreeIter treeIter;
+		GtkTreeView * list_tree;
+		GtkTreeSelection * select;
+
+		list_tree = GTK_TREE_VIEW (glade_xml_get_widget (xml_nxlaunch_glob,
+								 &quot;treeview_nxconnection&quot;));
+
+		/* Get the first iter */
+		gtk_tree_model_get_iter_first (GTK_TREE_MODEL (conn_store), &amp;treeIter);
+		/* Now set it as the selected row somehow */
+		select = gtk_tree_view_get_selection (list_tree);
+		gtk_tree_selection_select_iter (select, &amp;treeIter);
+		
+		on_treeview_connection_cursor_changed (GTK_WIDGET(list_tree));
+	}
+
+	return rtn;
+}
+
+void nxlaunch_create_nxconnection_list (void)
+{
+	GtkTreeViewColumn * column;
+	GtkCellRenderer * renderer;
+	GtkTreeView * list_tree;
+
+	list_tree = GTK_TREE_VIEW (glade_xml_get_widget (xml_nxlaunch_glob, &quot;treeview_nxconnection&quot;));
+	gtk_tree_view_set_model (list_tree, GTK_TREE_MODEL (conn_store));
+
+	/* Connection Name Column */
+	renderer = gtk_cell_renderer_text_new ();
+	column = gtk_tree_view_column_new_with_attributes (_(&quot;Name&quot;), renderer,
+							   &quot;text&quot;, CONN_CONNECTIONNAME,
+							   NULL);
+	gtk_tree_view_column_set_resizable (column, TRUE);
+	g_object_set (renderer, &quot;width&quot;, 200, NULL);
+	gtk_tree_view_append_column (list_tree, column);
+
+
+	/* Server column */
+	renderer = gtk_cell_renderer_text_new ();
+	column = gtk_tree_view_column_new_with_attributes (_(&quot;Server&quot;), renderer,
+							   &quot;text&quot;, CONN_SERVERHOST,
+							   NULL);
+	g_object_set (renderer, &quot;width&quot;, 100, NULL);
+	gtk_tree_view_append_column (list_tree, column);
+
+	/* User column */
+	renderer = gtk_cell_renderer_text_new ();
+	column = gtk_tree_view_column_new_with_attributes (_(&quot;Username&quot;), renderer,
+							   &quot;text&quot;, CONN_USER,
+							   NULL);
+	g_object_set (renderer, &quot;width&quot;, 60, NULL);
+	gtk_tree_view_append_column (list_tree, column);
+
+	/* Type column */
+	renderer = gtk_cell_renderer_text_new ();
+	column = gtk_tree_view_column_new_with_attributes (_(&quot;Session Type&quot;), renderer,
+							   &quot;text&quot;, CONN_DESKTOP,
+							   NULL);
+	g_object_set (renderer, &quot;width&quot;, 60, NULL);
+	gtk_tree_view_append_column (list_tree, column);
+
+	/* Geometry column */
+	renderer = gtk_cell_renderer_text_new ();
+	column = gtk_tree_view_column_new_with_attributes (_(&quot;Geometry&quot;), renderer,
+							   &quot;text&quot;, CONN_GEOMETRY,
+							   NULL);
+	g_object_set (renderer, &quot;width&quot;, 100, NULL);
+	gtk_tree_view_append_column (list_tree, column);
+
+	return;
+}
+
+void nxlaunch_create_nxsession_list (void)
+{
+	GtkTreeViewColumn * column;
+	GtkCellRenderer * renderer;
+	GtkTreeView * list_tree;
+
+	list_tree = GTK_TREE_VIEW (glade_xml_get_widget (xml_nxlaunch_glob, &quot;treeview_nxsession&quot;));
+	gtk_tree_view_set_model (list_tree, GTK_TREE_MODEL (sess_store));
+
+	/* Name Column */
+	renderer = gtk_cell_renderer_text_new ();
+	column = gtk_tree_view_column_new_with_attributes (_(&quot;Name&quot;), renderer,
+							   &quot;text&quot;, SESS_SESSIONNAME,
+							   NULL);
+	gtk_tree_view_column_set_resizable (column, TRUE);
+        g_object_set (renderer, &quot;width&quot;, 200, NULL);
+	gtk_tree_view_append_column (list_tree, column);
+
+	/* Icon column (icon representing type) with type as text */
+	column = gtk_tree_view_column_new();
+	gtk_tree_view_column_set_title (column, _(&quot;Type&quot;));
+
+	renderer = gtk_cell_renderer_pixbuf_new();
+	gtk_tree_view_column_pack_start (column, renderer, FALSE);
+	gtk_tree_view_column_set_attributes (column, renderer, &quot;pixbuf&quot;, SESS_TYPEICON, NULL);
+	g_object_set (renderer, &quot;width&quot;, 32, NULL);
+
+	renderer = gtk_cell_renderer_text_new();
+	gtk_tree_view_column_pack_start (column, renderer, TRUE);
+	gtk_tree_view_column_set_attributes (column, renderer, &quot;text&quot;, SESS_SESSIONTYPE, NULL);
+	g_object_set (renderer, &quot;width&quot;, 100, NULL);
+
+	gtk_tree_view_append_column (list_tree, column);
+
+	/* Status column (add icon later, as above.) */
+	renderer = gtk_cell_renderer_text_new ();
+	column = gtk_tree_view_column_new_with_attributes (_(&quot;Status&quot;), renderer,
+							   &quot;text&quot;, SESS_AVAILABLE,
+							   NULL);
+	g_object_set (renderer, &quot;width&quot;, 100, NULL);
+	gtk_tree_view_append_column (list_tree, column);
+
+	/* Display column */
+	renderer = gtk_cell_renderer_text_new ();
+	column = gtk_tree_view_column_new_with_attributes (_(&quot;Display&quot;), renderer,
+							   &quot;text&quot;, SESS_DISPLAY,
+							   NULL);
+	g_object_set (renderer, &quot;width&quot;, 100, NULL);
+	gtk_tree_view_append_column (list_tree, column);
+
+	return;
+}
+
+int sendSettings (DBusConnection *bus, struct nx_connection * nx_conn)
+{
+	DBusMessage *message;
+
+	/* Create a new setting signal on the &quot;org.freenx.nxcl.client&quot;
+	 * interface, from the object &quot;/org/freenx/nxcl/dbus/settingSignal&quot;. */
+	message = dbus_message_new_signal (&quot;/org/freenx/nxcl/dbus/settingSignal&quot;,
+					   dbusSendInterface, 
+					   &quot;sessionConfig&quot;);
+	if (NULL == message) {
+		printerr (&quot;NXLAUNCH&gt; Message Null\n&quot;);
+		return -1;
+	}
+
+	int media=0, enc=0, fs=0, cups=0;
+	if (nx_conn-&gt;enableSound == TRUE) { media = 1; }
+	if (nx_conn-&gt;EnableSSLOnly == TRUE) { enc = 1; }
+	if (nx_conn-&gt;FullScreen == TRUE) { fs = 1; }
+	if (nx_conn-&gt;IPPPrinting == TRUE) { cups = 1; }
+	int cache = 8, images = 24, render = 1;
+	const char * backingstore = &quot;when_requested&quot;;
+	/* FIXME: Would like to store these in the .nxs file */
+	const char * keyboard = &quot;&quot;;
+	const char * kbtype = &quot;&quot;;
+	printerr (&quot;Sending settings for connection %s, to Server %s\n&quot;,
+		  nx_conn-&gt;ConnectionName, nx_conn-&gt;ServerHost);
+	dbus_message_append_args 
+		(message,
+		 DBUS_TYPE_STRING, &amp;nx_conn-&gt;ServerHost,     //0
+		 DBUS_TYPE_INT32,  &amp;nx_conn-&gt;ServerPort,
+		 DBUS_TYPE_STRING, &amp;nx_conn-&gt;User,           //2
+		 DBUS_TYPE_STRING, &amp;nx_conn-&gt;Pass,
+		 DBUS_TYPE_STRING, &amp;nx_conn-&gt;ConnectionName, //4
+		 DBUS_TYPE_STRING, &amp;nx_conn-&gt;Desktop,        // FIXME - but not exactly.. If Desktop == gnome, sessionType == unix-gnome.
+		 DBUS_TYPE_INT32,  &amp;cache,                //6
+		 DBUS_TYPE_INT32,  &amp;images,
+		 DBUS_TYPE_STRING, &amp;nx_conn-&gt;LinkSpeed,      //8
+		 DBUS_TYPE_INT32,  &amp;render, 
+		 DBUS_TYPE_STRING, &amp;backingstore,         //10
+		 DBUS_TYPE_INT32,  &amp;nx_conn-&gt;ImageEncoding,
+		 DBUS_TYPE_INT32,  &amp;nx_conn-&gt;JPEGQuality,    //12
+		 DBUS_TYPE_STRING, &amp;nx_conn-&gt;Geometry,
+		 DBUS_TYPE_STRING, &amp;keyboard,             //14
+		 DBUS_TYPE_STRING, &amp;kbtype,
+		 DBUS_TYPE_INT32,  &amp;media,                //16
+		 DBUS_TYPE_STRING, &amp;nx_conn-&gt;agentServer,
+		 DBUS_TYPE_STRING, &amp;nx_conn-&gt;agentUser,      //18
+		 DBUS_TYPE_STRING, &amp;nx_conn-&gt;agentPass,
+		 DBUS_TYPE_INT32,  &amp;cups,                 //20
+		 DBUS_TYPE_STRING, &amp;nx_conn-&gt;PublicKey,
+		 DBUS_TYPE_INT32,  &amp;enc,                  //22
+		 DBUS_TYPE_INT32,  &amp;fs,
+		 DBUS_TYPE_STRING, &amp;nx_conn-&gt;CommandLine,    //24
+		 DBUS_TYPE_INVALID);
+	printerr (&quot;Sent settings to server\n&quot;);
+	/* Send the signal */
+	if (!dbus_connection_send (bus, message, NULL)) {
+		printerr (&quot;NXLAUNCH&gt; Out Of Memory!\n&quot;);
+		_exit(1);
+	}
+
+	/* Clean up */
+	dbus_message_unref (message);
+	dbus_connection_flush (bus);
+	printerr (&quot;Returning\n&quot;);
+	return 1;
+}
+
+int sendReply (DBusConnection *bus, int sessionNum)
+{
+	DBusMessage *message;
+	DBusMessageIter args;
+
+	/* Create a new session choice signal on the &quot;org.freenx.nxcl.client&quot;
+	 * interface, from the object &quot;/org/freenx/nxcl/dbus/sessionChoice&quot;. */
+	message = dbus_message_new_signal (&quot;/org/freenx/nxcl/dbus/sessionChoice&quot;,
+					   dbusSendInterface,
+					   &quot;sessionChoice&quot;);
+	if (NULL == message) {
+		printerr (&quot;NXLAUNCH&gt; Message Null\n&quot;);
+		return -1;
+	}
+
+	dbus_message_iter_init_append (message, &amp;args);
+	if (!dbus_message_iter_append_basic (&amp;args,
+					     DBUS_TYPE_INT32,
+					     (const void*)&amp;sessionNum)) {
+		printerr (&quot;NXLAUNCH&gt; Out Of Memory!\n&quot;);
+		_exit(1);
+	}
+
+	/* Send the signal */
+	if (!dbus_connection_send (bus, message, NULL)) {
+		printerr (&quot;NXLAUNCH&gt; Out Of Memory!\n&quot;);
+		_exit(1);	  
+	}
+
+	/* Clean up */
+	dbus_message_unref (message);
+	dbus_connection_flush (bus);
+
+	return 1;
+}
+
+
+int terminateSession (DBusConnection *bus, int sessionNum)
+{
+	DBusMessage *message;
+	DBusMessageIter args;
+
+	/* Create a new session choice signal on the &quot;org.freenx.nxcl.client&quot;
+	 * interface, from the object &quot;/org/freenx/nxcl/dbus/sessionChoice&quot;. */
+	message = dbus_message_new_signal (&quot;/org/freenx/nxcl/dbus/sessionChoice&quot;,
+					   dbusSendInterface,
+					   &quot;terminateSession&quot;);
+	if (NULL == message) { 
+		printerr (&quot;NXLAUNCH&gt; Message Null\n&quot;);
+		return -1;
+	}
+
+	dbus_message_iter_init_append (message, &amp;args);
+	if (!dbus_message_iter_append_basic (&amp;args,
+					     DBUS_TYPE_INT32,
+					     (const void*)&amp;sessionNum)) {
+		printerr (&quot;NXLAUNCH&gt; Out Of Memory!\n&quot;);
+		_exit(1);
+	}
+
+	/* Send the signal */
+	if (!dbus_connection_send (bus, message, NULL)) {
+		printerr (&quot;NXLAUNCH&gt; Out Of Memory!\n&quot;);
+		_exit(1);	  
+	}
+
+	/* Clean up */
+	dbus_message_unref (message);
+	dbus_connection_flush (bus);
+
+	/* Now we terminated, we listen to nxcl to receive an updated
+	 * list of sessions, or for notification that we are now
+	 * starting a new session. */
+	callReceiveSession (TRUE);
+
+	return 1;
+}
+
+void callReceiveSession (gboolean relist_call)
+{
+	int ret = 0;
+
+	if (REPLY_REQUIRED == (ret = receiveSession (dbusConn))) {
+		/* Session window should have been populated
+		 * by receiveSession, so we now return and
+		 * wait for a button press event (the choice
+		 * of session) */
+
+	} else if (SERVER_CAPACITY == ret) {
+		/* Have run out of capacity (licences) on the server. */
+		nxlaunch_error_requiring_quit (_(&quot;Out of licences on server.&quot;));
+
+		/* Ok. The above call will lead to quitting the
+		 * program. Ideally we should show a list of sessions
+		 * so user can terminate one if possible.
+		 *
+		 * But how to get a list of sessions to terminate?
+		 * Does NX actually return that information? I think
+		 * it just returns the &quot;out of capacity&quot; message, and
+		 * that's that.
+		 */
+
+	} else {
+
+		printerr (&quot;NXLAUNCH&gt; receiveSession() returned %d\n&quot;, ret);
+
+		/*
+		 * Now, in this case, if we have called
+		 * callReceiveSession from terminate session, we don't
+		 * just want to launch a new session, unless the user
+		 * actually presses the new connection button. The
+		 * sequence here is: 1) Enter user/pass for the
+		 * session. 2) Get back list of 1 suspended session 3)
+		 * Terminate it 4) get presented with empty session
+		 * window in which you can either click &quot;cancel&quot; to go
+		 * back to the connection list, or &quot;new&quot; to create a
+		 * new session.
+		 */
+
+		if (!relist_call) {
+			nxlaunch_display_progress();
+		}
+	}
+
+	return;
+}
+
+/*
+ * Wait for and receive a message with available sessions, or a
+ * message saying there are no available sessions
+ */
+#define RECEIVE_TIMEOUT_SECONDS 30
+int receiveSession (DBusConnection* conn)
+{
+	GtkWidget * widget;
+	GdkPixbuf * icon;
+	GError * gerror = NULL;
+	DBusMessage * message;
+	DBusMessageIter args;
+	DBusError error;
+	char * parameter = NULL;
+	dbus_int32_t iparam = 0, t = 0;
+	int count = 0;
+	int timeout = 0;
+	gboolean sessions_obtained = FALSE;
+	int rtn = 0;
+
+	printerr (_(&quot;NXLAUNCH&gt; Waiting to receive session information\n&quot;));
+
+	// Clear the list store we're about to populate.
+	gtk_list_store_clear (sess_store);
+
+	dbus_error_init (&amp;error);
+
+	int sessionNum = 0;
+
+	// loop listening for signals being emitted
+	while ((sessions_obtained == FALSE) &amp;&amp; (++timeout &lt; RECEIVE_TIMEOUT_SECONDS)) {
+		
+		if (dbus_error_is_set(&amp;error)) { 
+			printerr (&quot;NXLAUNCH&gt; Name Error (%s)\n&quot;, error.message); 
+			dbus_error_free(&amp;error); 
+		}
+
+		count = 0;
+
+		// non blocking read of the next available message
+		dbus_connection_read_write (conn, 0);
+		message = dbus_connection_pop_message (conn);
+
+		// loop again if we haven't read a message
+		if (NULL == message) {
+			usleep (1000000);
+			continue;
+		}
+
+		// Is the message the one we're interested in?
+		if (dbus_message_is_signal (message, dbusRecvInterface, &quot;AvailableSession&quot;)) {
+
+			if (!dbus_message_iter_init (message, &amp;args)) {
+				printerr (&quot;NXLAUNCH&gt; Message has no arguments!\n&quot;);
+				dbus_connection_flush (conn);
+				dbus_message_unref (message);
+				continue;
+			}
+
+			/* Now we have a message containing an
+			 * available session, append an entry to the
+			 * gtk_list_store of available connections. */
+			gtk_list_store_append (sess_store, &amp;sess_iter);
+
+			/* Read the parameters of the message into the sess_store gtk_list_store.
+			 * The order of session parameters passed in the dbus message is:
+			 * [0]Display(i) | [1]Type(s)   | [2]Session ID(s) | [3]Options(s)
+			 * [4]Depth(i)   | [5]Screen(s) | [6]Status(s)     | [7]Session Name(s)
+			 */
+
+			gtk_list_store_set (sess_store, &amp;sess_iter, SESS_INDEX, sessionNum, -1);
+			printerr (&quot;N-%2d: &quot;, sessionNum++);
+			do {
+				if (DBUS_TYPE_STRING == (t = dbus_message_iter_get_arg_type(&amp;args))) {
+					dbus_message_iter_get_basic(&amp;args, &amp;parameter);
+					printerr (&quot; '%s'&quot;, parameter);
+					switch (count) {
+					case 1: // Type
+						gtk_list_store_set (sess_store, &amp;sess_iter, SESS_SESSIONTYPE, parameter, -1);
+						if (!strcmp (&quot;unix-gnome&quot;, parameter)) {
+							icon = gdk_pixbuf_new_from_file(PACKAGE_DATA_DIR&quot;/gnome-nx-session.png&quot;, &amp;gerror);
+							gtk_list_store_set (sess_store, &amp;sess_iter, SESS_TYPEICON, icon, -1);
+						} else if (!strcmp (&quot;unix-kde&quot;, parameter)) {
+							icon = gdk_pixbuf_new_from_file(PACKAGE_DATA_DIR&quot;/kde-nx-session.png&quot;, &amp;gerror);
+							gtk_list_store_set (sess_store, &amp;sess_iter, SESS_TYPEICON, icon, -1);
+						} else {
+							icon = gdk_pixbuf_new_from_file(PACKAGE_DATA_DIR&quot;/unknown-nx-session.png&quot;, &amp;gerror);
+							gtk_list_store_set (sess_store, &amp;sess_iter, SESS_TYPEICON, icon, -1);
+						}
+						break;
+					case 2: // Session ID
+						gtk_list_store_set (sess_store, &amp;sess_iter, SESS_SESSIONID, parameter, -1);
+						break;
+					case 3: // Options
+						gtk_list_store_set (sess_store, &amp;sess_iter, SESS_OPTIONS, parameter, -1);
+						break;
+					case 5: // Screen
+						gtk_list_store_set (sess_store, &amp;sess_iter, SESS_SCREEN, parameter, -1);
+						break;
+					case 6: // Status
+						gtk_list_store_set (sess_store, &amp;sess_iter, SESS_AVAILABLE, parameter, -1);
+						break;
+					case 7: // Session Name
+						gtk_list_store_set (sess_store, &amp;sess_iter, SESS_SESSIONNAME, parameter, -1);
+						break;
+					default:
+						break;
+					}
+					count++;
+
+				} else if (t == DBUS_TYPE_INT32) {
+					dbus_message_iter_get_basic (&amp;args, &amp;iparam);
+					printerr (&quot; d%d&quot;, iparam);
+					//snprintf (parameter, 16, &quot;%d&quot;, iparam);
+					switch (count) {
+					case 0:
+						gtk_list_store_set (sess_store, &amp;sess_iter, SESS_DISPLAY, iparam, -1);
+						break;
+					case 4: // Depth
+						gtk_list_store_set (sess_store, &amp;sess_iter, SESS_DEPTH, iparam, -1);
+						break;
+					default:
+						break;
+					}
+					count++;
+
+				} else {
+					printerr (&quot;NXLAUNCH&gt; Error, parameter is not string or int.\n&quot;);
+				}
+
+			} while (dbus_message_iter_next (&amp;args));
+
+			printerr (&quot;\n&quot;);
+		
+			/*
+			 * The session box should now have been populated, so just reveal it
+			 */
+			widget = glade_xml_get_widget (xml_nxlaunch_glob, &quot;session_list&quot;);
+			gtk_widget_show (widget);
+			while (gtk_events_pending()) gtk_main_iteration();
+			rtn = REPLY_REQUIRED;
+
+		} else if (dbus_message_is_signal (message,
+						   dbusRecvInterface,
+						   &quot;NoMoreAvailable&quot;)) {
+			printerr (&quot;NXLAUNCH&gt; Server says \&quot;NoMoreAvailable\&quot;\n&quot;);
+			sessions_obtained = TRUE;
+			rtn = REPLY_REQUIRED;
+
+		} else if (dbus_message_is_signal (message,
+						   dbusRecvInterface,
+						   &quot;Connecting&quot;)) {
+			printerr (&quot;NXLAUNCH&gt; Server says \&quot;Connection\&quot;\n&quot;);
+			sessions_obtained = TRUE;
+			rtn = NEW_CONNECTION;
+
+		} else if (dbus_message_is_signal (message,
+						   dbusRecvInterface,
+						   &quot;ServerCapacityReached&quot;)) {
+			printerr (&quot;NXLAUNCH&gt; Server says \&quot;ServerCapacityReached\&quot;\n&quot;);
+			sessions_obtained = TRUE;
+			rtn = SERVER_CAPACITY;
+
+		} else {
+			/* Nothing */
+		}	
+
+		dbus_connection_flush (conn);
+		dbus_message_unref (message);
+
+	} // while()
+
+	return rtn;
+}
+
+
+/*!
+ * This populates global variables
+ */
+int obtainDbusConnection (void)
+{
+	gboolean gotName = FALSE;
+	gboolean gotSendName = FALSE;
+	gboolean gotRecvName = FALSE;
+	int i = 0, ret = 0;
+	
+	dbusSendInterface = g_malloc0 (64*sizeof (gchar));
+	dbusRecvInterface = g_malloc0 (64*sizeof (gchar));
+	dbusMatchString   = g_malloc0 (128*sizeof (gchar));
+
+	/* Get a connection to the session bus */
+	dbus_error_init (&amp;dbusErr);
+	dbusConn = dbus_bus_get (DBUS_BUS_SESSION, &amp;dbusErr);
+	if (!dbusConn) {
+		printerr (&quot;Failed to connect to the D-BUS daemon: %s\n&quot;, dbusErr.message);
+		dbus_error_free (&amp;dbusErr);
+		return -1;
+	}
+
+	/*
+	 * Here, we try to get the interface org.freenx.nxcl.client0
+	 * in case any other clients are running. We also try to get
+	 * the interface org.freenx.nxcl.nxcl0, in case any other nxcl
+	 * daemons are running, but we have to release that name, one
+	 * we established that it is available.
+	 */
+	while (gotName == FALSE) {
+
+		snprintf (dbusSendInterface, 63, &quot;org.freenx.nxcl.client%d&quot;, i);
+		snprintf (dbusRecvInterface, 63, &quot;org.freenx.nxcl.nxcl%d&quot;, i);
+		snprintf (dbusMatchString, 127, &quot;type='signal',interface='org.freenx.nxcl.nxcl%d'&quot;, i);
+
+		// We request a name on the bus which is the same string as the send interface.
+		ret = dbus_bus_request_name (dbusConn, dbusSendInterface,
+					     DBUS_NAME_FLAG_REPLACE_EXISTING, 
+					     &amp;dbusErr);
+
+		if (dbus_error_is_set (&amp;dbusErr)) { 
+			printerr (&quot;NXLAUNCH&gt; Name Error (%s)\n&quot;, dbusErr.message); 
+			dbus_error_free(&amp;dbusErr);
+		}
+
+		if (DBUS_REQUEST_NAME_REPLY_PRIMARY_OWNER != ret) {
+			printerr (&quot;NXLAUNCH&gt; Couldn't get the send name this iteration\n&quot;);
+		} else {
+			printerr (&quot;NXLAUNCH&gt; Got the send name '%s' on the dbus\n&quot;, dbusSendInterface);
+			gotSendName = TRUE;
+		}
+
+		ret = dbus_bus_request_name (dbusConn, dbusRecvInterface,
+					     DBUS_NAME_FLAG_REPLACE_EXISTING, 
+					     &amp;dbusErr);
+
+		if (dbus_error_is_set (&amp;dbusErr)) { 
+			printerr (&quot;NXLAUNCH&gt; Name Error (%s)\n&quot;, dbusErr.message); 
+			dbus_error_free(&amp;dbusErr);
+		}
+
+		if (DBUS_REQUEST_NAME_REPLY_PRIMARY_OWNER != ret) {
+			printerr (&quot;NXLAUNCH&gt; Couldn't get the receive name in this iteration\n&quot;);
+		} else {
+			printerr (&quot;NXLAUNCH&gt; Got the recv name '%s' on the dbus\n&quot;, dbusRecvInterface);
+			gotRecvName = TRUE;
+			dbus_bus_release_name (dbusConn, dbusRecvInterface, &amp;dbusErr);
+		}
+
+		if (gotSendName &amp;&amp; gotRecvName) {
+			gotName = TRUE;
+		} else {
+			gotSendName = FALSE;
+			gotRecvName = FALSE;
+			i++;
+		}
+	}
+
+	printerr (&quot;NXLAUNCH&gt; obtainDbusConnection() returning %d\n&quot;, i);
+	return i;
+}
+
+void execNxcl (void)
+{
+	pid_t pid = 0;
+	char argStr[8];
+	char progLocn[128];
+	char prog[32];
+	int theError = 0;
+
+	snprintf (argStr, 7, &quot;%d&quot;, dbusNum);
+	snprintf (progLocn, 127, PACKAGE_BIN_DIR&quot;/nxcl&quot;);
+	snprintf (prog, 31, &quot;nxcl&quot;);
+
+	printerr (&quot;NXLAUNCH&gt; About to exec '%s %s'\n&quot;, prog, argStr);
+
+	/* fork and exec the nxcl */
+	pid = fork();
+	switch (pid) {
+	case -1:
+		printerr (&quot;Can't fork()!\n&quot;);
+		_exit(1);
+	case 0:
+		// This is the CHILD process
+		// Allocate memory for the program arguments
+		// 1+ to allow space for NULL terminating pointer
+		
+
+		// FIXME: This isn't passing the argument correctly to nxcl.
+		execl (progLocn, prog, argStr, (char*)NULL);
+		// If process returns, error occurred
+		theError = errno;
+		// This'll get picked up by parseResponse
+		printerr (&quot;NXLAUNCH&gt; Process error: %d crashed. errno:%d\n&quot;, pid, theError);
+		// Child should exit now.
+		_exit(1);
+
+	default:
+		// This is the PARENT process
+		printerr (&quot;NXLAUNCH&gt; forked the nxcl process; continuing.\n&quot;);
+		break;
+	}
+}
+
+
+void sendNxclSettings (struct nx_connection * nx_conn)
+{
+	/* Prepare interface - add a rule for which messages we want
+	   to see - those that are sent to us from the nxcl
+	   connection. */
+	dbus_bus_add_match (dbusConn, dbusMatchString, &amp;dbusErr);
+	dbus_connection_flush (dbusConn);
+	if (dbus_error_is_set(&amp;dbusErr)) { 
+		printerr (&quot;NXLAUNCH&gt; Match Error (%s)\n&quot;, dbusErr.message);
+		_exit(1);
+	} else {
+		printerr (&quot;NXLAUNCH&gt; Added match '%s'\n&quot;, dbusMatchString);
+	}
+
+	if (waitForAlive() == FALSE) {
+		printerr (&quot;NXLAUNCH&gt; nxcl didn't start!&quot;);
+		_exit (-1);		
+	}
+
+	// ...and then send it on dbus.
+	sendSettings (dbusConn, nx_conn);
+	printerr (&quot;NXLAUNCH&gt; sent settings\n&quot;);
+	
+	return;
+}
+
+/*!
+ * This is a callback, but is better placed here in the code near
+ * getActiveConnection.
+ */
+void on_button_password_ok_clicked (GtkButton * button)
+{
+	struct nx_connection * nx_conn = NULL;
+	GtkWidget * widget;
+
+	printerr (&quot;NXLAUNCH&gt; %s() called\n&quot;, __FUNCTION__);
+
+	if (nx_conn_glob == NULL) {
+		printerr (&quot;NXLAUNCH&gt; Reading the active connection from the tree model\n&quot;);
+		nx_conn = g_malloc0 (sizeof (struct nx_connection));
+		getActiveConnection (nx_conn);
+	} else { /* we already populated nx_conn in launch_named_connection() */
+		printerr (&quot;NXLAUNCH&gt; Using global nx_conn pointer, which is 0x%x\n&quot;, 
+			  (unsigned int)nx_conn_glob);
+		nx_conn = nx_conn_glob;
+		nx_conn_glob = NULL;
+		printerr (&quot;NXLAUNCH&gt; nx_conn is still 0x%x\n&quot;, (int)nx_conn);
+	}
+
+	/* Read the password into nx_conn-&gt;Pass, mallocing if necessary */
+	widget = glade_xml_get_widget (xml_nxlaunch_glob, &quot;entry_password_dialog&quot;);
+	if (!(nx_conn-&gt;Pass = g_try_realloc (nx_conn-&gt;Pass, NX_FIELDLEN * sizeof(gchar)))) {
+		printerr (&quot;NXLAUNCH&gt; Failed g_try_realloc\n&quot;);
+	}
+	strncpy (nx_conn-&gt;Pass, gtk_entry_get_text (GTK_ENTRY (widget)),  NX_FIELDLEN);
+
+	/* Hide the password window (this may not happen until this
+	 * callback returns, which is not what we want, really) */
+	widget = glade_xml_get_widget (xml_nxlaunch_glob, &quot;dialog_password&quot;);
+	gtk_widget_hide_all (widget);
+	while (gtk_events_pending()) gtk_main_iteration();
+	/* We still have an un-redrawn patch on the greyed out nxlauncher main window... */
+	widget = glade_xml_get_widget (xml_nxlaunch_glob, &quot;nxlauncher&quot;);
+	gtk_widget_show_all (widget);
+	while (gtk_events_pending()) gtk_main_iteration();
+	launch_connection (nx_conn);
+	return;
+}
+
+void on_button_password_cancel_clicked (GtkButton * button)
+{
+	GtkWidget * widget;
+	widget = glade_xml_get_widget (xml_nxlaunch_glob, &quot;nxlauncher&quot;);
+	gtk_widget_set_sensitive (widget, TRUE);
+	gtk_widget_show (widget);
+	return;
+}
+
+void getActiveConnection (struct nx_connection * nx_conn)
+{
+	GtkTreeView * list_tree;
+	GtkTreeSelection * selected;
+	GtkTreeIter iter;
+	GtkTreeModel * tree_model;
+
+	printerr (&quot;%s() called\n&quot;, __FUNCTION__);
+
+	list_tree = GTK_TREE_VIEW (glade_xml_get_widget (xml_nxlaunch_glob, &quot;treeview_nxconnection&quot;));
+	selected = gtk_tree_view_get_selection (list_tree);
+	tree_model = GTK_TREE_MODEL (conn_store);
+
+	if (gtk_tree_selection_get_selected (selected, &amp;tree_model, &amp;iter)) {
+
+		/* Get all the information out of the row */
+		gtk_tree_model_get (tree_model, &amp;iter,
+				    CONN_CONNECTIONNAME,    &amp;nx_conn-&gt;ConnectionName,//
+				    CONN_SERVERHOST,        &amp;nx_conn-&gt;ServerHost,//
+				    CONN_SERVERPORT,        &amp;nx_conn-&gt;ServerPort,
+				    CONN_USER,              &amp;nx_conn-&gt;User,//
+				    CONN_PASS,              &amp;nx_conn-&gt;Pass,//
+				    CONN_REMEMBERPASS,      &amp;nx_conn-&gt;RememberPassword,
+				    CONN_DISABLENODELAY,    &amp;nx_conn-&gt;DisableNoDelay,
+				    CONN_DISABLEZLIB,       &amp;nx_conn-&gt;DisableZLIB,
+				    CONN_ENABLESSLONLY,     &amp;nx_conn-&gt;EnableSSLOnly,
+				    CONN_LINKSPEED,         &amp;nx_conn-&gt;LinkSpeed,//
+				    CONN_PUBLICKEY,         &amp;nx_conn-&gt;PublicKey,//
+				    CONN_DESKTOP,           &amp;nx_conn-&gt;Desktop,//
+				    CONN_CUSTOMUNIXDESKTOP, &amp;nx_conn-&gt;CustomUnixDesktop,//
+				    CONN_COMMANDLINE,       &amp;nx_conn-&gt;CommandLine,//
+				    CONN_VIRTUALDESKTOP,    &amp;nx_conn-&gt;VirtualDesktop,
+				    CONN_XAGENTENCODING,    &amp;nx_conn-&gt;XAgentEncoding,
+				    CONN_USETAINT,          &amp;nx_conn-&gt;UseTaint,
+				    CONN_XDMMODE,           &amp;nx_conn-&gt;XdmMode,//
+				    CONN_XDMHOST,           &amp;nx_conn-&gt;XdmHost,//
+				    CONN_XDMPORT,           &amp;nx_conn-&gt;XdmPort,
+				    CONN_FULLSCREEN,        &amp;nx_conn-&gt;FullScreen,	    
+				    CONN_RESOLUTIONWIDTH,   &amp;nx_conn-&gt;ResolutionWidth,
+				    CONN_RESOLUTIONHEIGHT,  &amp;nx_conn-&gt;ResolutionHeight,
+				    CONN_GEOMETRY,          &amp;nx_conn-&gt;Geometry,//
+				    CONN_IMAGEENCODING,     &amp;nx_conn-&gt;ImageEncoding,
+				    CONN_JPEGQUALITY,       &amp;nx_conn-&gt;JPEGQuality,
+				    CONN_ENABLESOUND,       &amp;nx_conn-&gt;enableSound,
+				    CONN_IPPPORT,           &amp;nx_conn-&gt;IPPPort,
+				    CONN_IPPPRINTING,       &amp;nx_conn-&gt;IPPPrinting,
+				    CONN_SHARES,            &amp;nx_conn-&gt;Shares,
+				    CONN_AGENTSERVER,       &amp;nx_conn-&gt;agentServer,//
+				    CONN_AGENTUSER,         &amp;nx_conn-&gt;agentUser,//
+				    CONN_AGENTPASS,         &amp;nx_conn-&gt;agentPass,//
+				    -1);
+
+		/* Put this iter in the global iter */
+		conn_iter = iter;
+	}
+}
+
+/*!
+ * Returns true if we have a named connection, but we are waiting for
+ * user to input a password.
+ */
+gboolean launch_named_connection (gchar * connection_name)
+{
+	/* Set the iter to point to the named connection, and if we
+	 * have a match, called on_button_nxlaunch_launch_clicked */
+	GtkWidget * widget;
+	GtkWidget * tree;
+	GtkTreeIter iter;
+	gchar * str_data;
+	gboolean valid;
+	gboolean got_connection = FALSE;
+	struct nx_connection * nx_conn;
+
+	nx_conn = g_malloc0 (sizeof (struct nx_connection));
+
+	/* Need to get the associated treemodel */
+	tree = glade_xml_get_widget (xml_nxlaunch_glob, &quot;treeview_nxconnection&quot;);
+	valid = gtk_tree_model_get_iter_first (GTK_TREE_MODEL (conn_store), &amp;iter);
+	while (valid) {
+		gtk_tree_model_get (GTK_TREE_MODEL (conn_store), &amp;iter, 
+				    CONN_CONNECTIONNAME, &amp;str_data,
+				    -1);
+		printerr (&quot;Got connection named '%s'\n&quot;, str_data);
+		if (!strcmp (connection_name, str_data)) {
+			printerr (&quot;This is the connection to activate\n&quot;);
+			got_connection = TRUE;
+
+			/* NB: This function mallocs the data for the strings */
+			gtk_tree_model_get (GTK_TREE_MODEL(conn_store), &amp;iter,
+					    CONN_CONNECTIONNAME,    &amp;nx_conn-&gt;ConnectionName,
+					    CONN_SERVERHOST,        &amp;nx_conn-&gt;ServerHost,
+					    CONN_SERVERPORT,        &amp;nx_conn-&gt;ServerPort,
+					    CONN_USER,              &amp;nx_conn-&gt;User,
+					    CONN_PASS,              &amp;nx_conn-&gt;Pass,
+					    CONN_REMEMBERPASS,      &amp;nx_conn-&gt;RememberPassword,
+					    CONN_DISABLENODELAY,    &amp;nx_conn-&gt;DisableNoDelay,
+					    CONN_DISABLEZLIB,       &amp;nx_conn-&gt;DisableZLIB,
+					    CONN_ENABLESSLONLY,     &amp;nx_conn-&gt;EnableSSLOnly,
+					    CONN_LINKSPEED,         &amp;nx_conn-&gt;LinkSpeed,
+					    CONN_PUBLICKEY,         &amp;nx_conn-&gt;PublicKey,
+					    CONN_DESKTOP,           &amp;nx_conn-&gt;Desktop,
+					    CONN_CUSTOMUNIXDESKTOP, &amp;nx_conn-&gt;CustomUnixDesktop,
+					    CONN_COMMANDLINE,       &amp;nx_conn-&gt;CommandLine,
+					    CONN_VIRTUALDESKTOP,    &amp;nx_conn-&gt;VirtualDesktop,
+					    CONN_XAGENTENCODING,    &amp;nx_conn-&gt;XAgentEncoding,
+					    CONN_USETAINT,          &amp;nx_conn-&gt;UseTaint,
+					    CONN_XDMMODE,           &amp;nx_conn-&gt;XdmMode,
+					    CONN_XDMHOST,           &amp;nx_conn-&gt;XdmHost,
+					    CONN_XDMPORT,           &amp;nx_conn-&gt;XdmPort,
+					    CONN_FULLSCREEN,        &amp;nx_conn-&gt;FullScreen,	    
+					    CONN_RESOLUTIONWIDTH,   &amp;nx_conn-&gt;ResolutionWidth,
+					    CONN_RESOLUTIONHEIGHT,  &amp;nx_conn-&gt;ResolutionHeight,
+					    CONN_GEOMETRY,          &amp;nx_conn-&gt;Geometry,
+					    CONN_IMAGEENCODING,     &amp;nx_conn-&gt;ImageEncoding,
+					    CONN_JPEGQUALITY,       &amp;nx_conn-&gt;JPEGQuality,
+					    CONN_ENABLESOUND,       &amp;nx_conn-&gt;enableSound,
+					    CONN_IPPPORT,           &amp;nx_conn-&gt;IPPPort,
+					    CONN_IPPPRINTING,       &amp;nx_conn-&gt;IPPPrinting,
+					    CONN_SHARES,            &amp;nx_conn-&gt;Shares,
+					    CONN_AGENTSERVER,       &amp;nx_conn-&gt;agentServer,
+					    CONN_AGENTUSER,         &amp;nx_conn-&gt;agentUser,
+					    CONN_AGENTPASS,         &amp;nx_conn-&gt;agentPass,
+					    -1);
+			printerr (&quot;nx_conn-&gt;ServerHost: %s\n&quot;, nx_conn-&gt;ServerHost);
+			g_free (str_data);
+			break;
+		}
+		g_free (str_data);
+		valid = gtk_tree_model_iter_next (GTK_TREE_MODEL (conn_store), &amp;iter);
+	}
+	
+	if (!got_connection) {
+		printerr (&quot;NXLAUNCH&gt; Couldn't find the connection '%s'\n&quot;, connection_name);
+		return FALSE;
+	}
+
+	if (nx_conn-&gt;RememberPassword == FALSE) {
+		/* Show the window to enter the password */
+		/* Set the global pointer to point to the memory we
+		 * just malloced. */
+		nx_conn_glob = nx_conn;
+		widget = glade_xml_get_widget (xml_nxlaunch_glob, &quot;dialog_password&quot;);
+		gtk_widget_show_all (widget);
+		return TRUE;
+
+	} else {
+		launch_connection (nx_conn);
+		nx_connection_free (nx_conn);
+		return FALSE;
+	}
+}
+
+/*!
+ * nx_conn should be malloced already when passed to this fn.
+ * This function will then free that memory, and exit the program.
+ */
+void launch_connection (struct nx_connection * nx_conn)
+{
+	GtkWidget * widget;
+	gchar temp[32];
+
+	printerr (&quot;%s() called\n&quot;, __FUNCTION__);
+
+	/* FIXME
+	 * Not quite sure what to do with nx_conn-&gt;Desktop
+	 * here. Mostly, gnome goes to unix-gnome, kde to unix-kde and
+	 * so on, but not sure what sessionType should be for console,
+	 * custom and RDP/VNC sessions.
+	 * For now, apply this hack:
+	 */
+	snprintf (temp, 31, &quot;unix-%s&quot;, nx_conn-&gt;Desktop);
+	snprintf (nx_conn-&gt;Desktop, 255, &quot;%s&quot;, temp);
+
+	execNxcl();
+	sendNxclSettings (nx_conn);
+	callReceiveSession (FALSE);
+	printerr (&quot;NXLAUNCH&gt; Received session\n&quot;);
+
+	if (!(nx_conn-&gt;Pass = g_try_realloc (nx_conn-&gt;Pass, NX_FIELDLEN * sizeof(gchar)))) {
+		printerr (&quot;NXLAUNCH&gt; Failed g_try_realloc in %s()\n&quot;, __FUNCTION__);
+	}
+	memset (nx_conn-&gt;Pass, 0, NX_FIELDLEN);
+
+	/* Clear the password GTK entry here where necessary */
+	widget = glade_xml_get_widget (xml_nxlaunch_glob, &quot;entry_nxlaunch_password&quot;);
+	gtk_entry_set_text (GTK_ENTRY(widget), &quot;&quot;);
+	widget = glade_xml_get_widget (xml_nxlaunch_glob, &quot;entry_password_dialog&quot;);
+	gtk_entry_set_text (GTK_ENTRY(widget), &quot;&quot;);
+
+	nx_connection_free (nx_conn);
+	return;
+}
+
+void nxlauncher_hide (void)
+{
+	GtkWidget * widget;
+	widget = glade_xml_get_widget (xml_nxlaunch_glob, &quot;nxlauncher&quot;);
+	printerr (&quot;NXLAUNCH&gt; Hide all\n&quot;);
+	gtk_widget_hide_all (widget);
+	return;
+}
+
+void nxlauncher_show (void)
+{
+	GtkWidget * widget;
+	widget = glade_xml_get_widget (xml_nxlaunch_glob, &quot;nxlauncher&quot;);
+	printerr (&quot;NXLAUNCH&gt; Show all\n&quot;);
+	gtk_widget_show_all (widget);
+	return;
+}
+
+int checkActiveConnectionPassword (void)
+{
+	GtkWidget * widget;
+	GtkTreeView * list_tree;
+	GtkTreeSelection * selected;
+	GtkTreeIter iter;
+	GtkTreeModel * tree_model;
+	gchar * str;
+	int flags = 0;
+
+	/* Check active row in treeview */
+	list_tree = GTK_TREE_VIEW (glade_xml_get_widget (xml_nxlaunch_glob, &quot;treeview_nxconnection&quot;));
+	selected = gtk_tree_view_get_selection (list_tree);
+	tree_model = GTK_TREE_MODEL (conn_store);
+	if (gtk_tree_selection_get_selected (selected, &amp;tree_model, &amp;iter)) {
+		gtk_tree_model_get (tree_model, &amp;iter, CONN_PASS, &amp;str, -1);		
+		if (strlen (str) &gt; 0) {
+			flags |= STORED_PASSWORD;
+		}
+		g_free (str);
+	}
+
+	widget = glade_xml_get_widget (xml_nxlaunch_glob, &quot;entry_nxlaunch_password&quot;);
+	str = g_malloc0 (NX_FIELDLEN * sizeof (gchar));
+	strncpy (str, gtk_entry_get_text (GTK_ENTRY(widget)), NX_FIELDLEN);
+	if (strlen (str) &gt; 0) {
+		flags |= ENTERED_PASSWORD;
+	}
+	g_free (str);
+	return flags;
+}
+
+/*
+ * Likely to become obsolete.
+ */
+void nxlaunch_quit_with_window (void)
+{
+	printerr (&quot;%s called\n&quot;, __FUNCTION__);
+	GtkWidget * widget;
+	printerr (&quot;NXLAUNCH&gt; Quitting in 8 seconds...\n&quot;);
+	widget = glade_xml_get_widget (xml_nxlaunch_glob, &quot;dialog_quitting&quot;);
+	gtk_widget_show_all (widget);
+	while (gtk_events_pending()) gtk_main_iteration();
+	widget = glade_xml_get_widget (xml_nxlaunch_glob, &quot;label_reason_for_exit&quot;);
+	gtk_widget_show (widget);
+	while (gtk_events_pending()) gtk_main_iteration();
+	printerr (&quot;About to sleep.. it would be better to pass control back to the main loop for a few seconds before quitting here.\n&quot;);
+	usleep (8000000);
+	printerr (&quot;Slept, now quit..\n&quot;);
+	while (gtk_events_pending()) gtk_main_iteration();
+	gtk_main_quit();
+}
+
+void nxlaunch_display_progress (void)
+{
+	GtkWidget * widget;
+	widget = glade_xml_get_widget (xml_nxlaunch_glob, &quot;nxlaunch_progress&quot;);
+	gtk_widget_show (widget);
+	while (gtk_events_pending()) gtk_main_iteration();
+	widget = glade_xml_get_widget (xml_nxlaunch_glob, &quot;label_progress&quot;);
+	gtk_widget_show (widget);
+	/* Add a status message listener - this will update the status
+	   message in the nxlaunch_progress window, and the messages will
+	   be used to set the progress bar, too. */
+	g_timeout_add (500, &amp;nxlaunch_status_listener, NULL);
+	return;
+}
+
+gboolean nxlaunch_status_listener (gpointer data)
+{
+	GtkWidget * widget;
+	DBusMessage * message;
+	DBusMessageIter args;
+	DBusError error;
+	char * parameter = NULL;
+	dbus_int32_t iparam = 0, t = 0;
+
+	//printerr (_(&quot;NXLAUNCH&gt; Listening for status information\n&quot;));
+
+	dbus_error_init (&amp;error);
+
+	if (dbus_error_is_set(&amp;error)) { 
+		printerr (&quot;NXLAUNCH&gt; Name Error (%s)\n&quot;, error.message); 
+		dbus_error_free(&amp;error); 
+	}
+
+	// non blocking read of the next available message
+	dbus_connection_read_write(dbusConn, 0);
+	message = dbus_connection_pop_message(dbusConn);
+
+	// return if no message
+	if (NULL == message) { return TRUE; }
+
+	if (dbus_message_is_signal (message, dbusRecvInterface, &quot;InfoMessage&quot;)) {
+
+		if (!dbus_message_iter_init (message, &amp;args)) {
+			printerr (&quot;NXLAUNCH&gt; That message had no arguments.\n&quot;);
+			dbus_connection_flush (dbusConn);
+			dbus_message_unref (message);
+			return TRUE;
+		}
+		printerr (&quot;(NXCL)&gt; Info: &quot;);
+		do {
+			if (DBUS_TYPE_STRING == (t = dbus_message_iter_get_arg_type(&amp;args))) {
+				dbus_message_iter_get_basic(&amp;args, &amp;parameter);
+				printerr (&quot; '%s'&quot;, parameter);
+				widget = glade_xml_get_widget (xml_nxlaunch_glob, &quot;label_progress&quot;);
+				gtk_label_set_text (GTK_LABEL (widget), parameter);
+			} else if (t == DBUS_TYPE_INT32) {
+		 			dbus_message_iter_get_basic (&amp;args, &amp;iparam);
+					printerr (&quot; d%d&quot;, iparam);
+					/* We used the integer passed with these progress signals to set the progress bar */
+					widget = glade_xml_get_widget (xml_nxlaunch_glob, &quot;progressbar&quot;);
+					switch (iparam) {
+					case 700: /* 'Got a session ID' */
+						gtk_progress_bar_set_fraction (GTK_PROGRESS_BAR (widget), 0.125);
+						break;
+					case 702: /* 'Got a proxy IP' or 'All data will be SSL tunnelled' */
+						if (gtk_progress_bar_get_fraction (GTK_PROGRESS_BAR (widget)) &lt; 0.300) {
+							gtk_progress_bar_set_fraction (GTK_PROGRESS_BAR (widget), 0.250);
+						} else {
+							gtk_progress_bar_set_fraction (GTK_PROGRESS_BAR (widget), 0.500);
+						}
+						break;
+					case 706: /* 'Got an agent cookie' */
+						gtk_progress_bar_set_fraction (GTK_PROGRESS_BAR (widget), 0.375);
+						break;
+					case 710: /* 'Session status is &quot;running&quot;' */
+						gtk_progress_bar_set_fraction (GTK_PROGRESS_BAR (widget), 0.625);
+						break;
+					case 1000007: /* 'Starting NX session' */
+						gtk_progress_bar_set_fraction (GTK_PROGRESS_BAR (widget), 0.750);
+						break;
+					case 1000001: /* 'nxproxy process started' */
+						gtk_progress_bar_set_fraction (GTK_PROGRESS_BAR (widget), 0.825);
+						break;
+					case 287: /* 'The session has been started successfully' */
+						gtk_progress_bar_set_fraction (GTK_PROGRESS_BAR (widget), 1.000);
+						while (gtk_events_pending()) gtk_main_iteration();
+						usleep (2000000);
+						gtk_main_quit();
+						break;
+					default:
+						break;
+					}
+			} else {
+				printerr (&quot;NXLAUNCH&gt; Error, parameter is not string or int.\n&quot;);
+			}
+
+		} while (dbus_message_iter_next (&amp;args));
+		printerr (&quot;\n&quot;);
+
+	} else if (dbus_message_is_signal (message, dbusRecvInterface, &quot;ErrorMessage&quot;)) {
+
+		if (!dbus_message_iter_init (message, &amp;args)) {
+			printerr (&quot;NXLAUNCH&gt; That message had no arguments.\n&quot;);
+			dbus_connection_flush (dbusConn);
+			dbus_message_unref (message);
+			return TRUE;
+		}
+
+		printerr (&quot;(NXCL)&gt; Error: &quot;);
+		do {
+			if (DBUS_TYPE_STRING == (t = dbus_message_iter_get_arg_type(&amp;args))) {
+				dbus_message_iter_get_basic(&amp;args, &amp;parameter);
+				printerr (&quot; '%s'&quot;, parameter);
+				widget = glade_xml_get_widget (xml_nxlaunch_glob, &quot;label_progress&quot;);
+				gtk_label_set_text (GTK_LABEL (widget), parameter);
+
+			} else if (t == DBUS_TYPE_INT32) {
+					dbus_message_iter_get_basic (&amp;args, &amp;iparam);
+					printerr (&quot; d%d&quot;, iparam);
+			} else {
+				printerr (&quot;NXLAUNCH&gt; Error, parameter is not string or int.\n&quot;);
+			}
+
+		} while (dbus_message_iter_next (&amp;args));
+		printerr (&quot;\n&quot;);
+
+	} else {
+		/* Nothing */
+	}	
+	
+	dbus_connection_flush (dbusConn);
+	dbus_message_unref (message);
+
+	return TRUE;
+}
+
+gboolean waitForAlive (void)
+{
+	DBusMessage * message = NULL;
+	DBusMessageIter args;
+	DBusError error;
+	char * parameter = NULL;
+	dbus_int32_t iparam = 0, t = 0;
+	gboolean nxclAlive = FALSE;
+	int i = 0;
+
+	dbus_error_init (&amp;error);
+
+	while (nxclAlive == FALSE &amp;&amp; i&lt;60) {
+
+		i++;
+
+		if (dbus_error_is_set(&amp;error)) { 
+			printerr (&quot;NXLAUNCH&gt; Name Error (%s)\n&quot;, error.message); 
+			dbus_error_free(&amp;error); 
+		}
+
+		// non blocking read of the next available message
+		dbus_connection_read_write(dbusConn, 0);
+		message = dbus_connection_pop_message(dbusConn);
+
+		// return if no message
+		if (NULL == message) {
+			usleep (1000000);
+			continue;
+		}
+
+		if (dbus_message_is_signal (message, dbusRecvInterface, &quot;InfoMessage&quot;)) {
+
+			if (!dbus_message_iter_init (message, &amp;args)) {
+				printerr (&quot;NXLAUNCH&gt; That message had no arguments.\n&quot;);
+				dbus_connection_flush (dbusConn);
+				dbus_message_unref (message);
+				continue;
+			}
+
+			do {
+				if (DBUS_TYPE_STRING == (t = dbus_message_iter_get_arg_type(&amp;args))) {
+					dbus_message_iter_get_basic(&amp;args, &amp;parameter);
+				} else if (t == DBUS_TYPE_INT32) {
+		 			dbus_message_iter_get_basic (&amp;args, &amp;iparam);
+					if (iparam == NXCL_ALIVE) {
+						/* Set global variable to say we're alive */
+						nxclAlive = TRUE;
+					}
+				} else {
+					printerr (&quot;NXLAUNCH&gt; Error, parameter is not string or int.\n&quot;);
+				}
+
+			} while (dbus_message_iter_next (&amp;args));
+
+		} else {
+			/* Nothing */
+		}	
+	}
+	dbus_connection_flush (dbusConn);
+	dbus_message_unref (message);
+
+	if (i&lt;60 &amp;&amp; nxclAlive == TRUE) {
+		return TRUE;
+	} else {
+		return FALSE;
+	}
+}
+
+void nxlaunch_error_requiring_quit (const char * message)
+{
+	GtkWidget * widget;
+	
+	/* Grey out all the other windows */
+	widget = glade_xml_get_widget (xml_nxlaunch_glob, &quot;nxlauncher&quot;);
+	gtk_widget_set_sensitive (widget, FALSE);
+	widget = glade_xml_get_widget (xml_nxlaunch_glob, &quot;session_list&quot;);
+	gtk_widget_set_sensitive (widget, FALSE);
+	widget = glade_xml_get_widget (xml_nxlaunch_glob, &quot;nxlaunch_progress&quot;);
+	gtk_widget_set_sensitive (widget, FALSE);
+	widget = glade_xml_get_widget (xml_nxlaunch_glob, &quot;dialog_password&quot;);
+	gtk_widget_set_sensitive (widget, FALSE);
+	while (gtk_events_pending()) gtk_main_iteration();
+
+	/* Bring up the general error window, with quit button */
+	widget = glade_xml_get_widget (xml_nxlaunch_glob, &quot;unrecoverable_error_message&quot;);
+	gtk_label_set_text (GTK_LABEL(widget), message);
+	widget = glade_xml_get_widget (xml_nxlaunch_glob, &quot;unrecoverable_error&quot;);
+	gtk_widget_set_sensitive (widget, TRUE);
+	gtk_widget_show_all (widget);
+
+	return;
+}

Added: nxlaunch/src/nxlaunch.glade
===================================================================
--- nxlaunch/src/nxlaunch.glade	2007-09-16 20:16:05 UTC (rev 380)
+++ nxlaunch/src/nxlaunch.glade	2007-09-17 12:30:56 UTC (rev 381)
@@ -0,0 +1,1144 @@
+&lt;?xml version=&quot;1.0&quot; standalone=&quot;no&quot;?&gt; &lt;!--*- mode: xml -*--&gt;
+&lt;!DOCTYPE glade-interface SYSTEM &quot;<A HREF="http://glade.gnome.org/glade-2.0.dtd">http://glade.gnome.org/glade-2.0.dtd</A>&quot;&gt;
+
+&lt;glade-interface&gt;
+
+&lt;widget class=&quot;GtkWindow&quot; id=&quot;nxlauncher&quot;&gt;
+  &lt;property name=&quot;title&quot; translatable=&quot;yes&quot;&gt;NXLaunch&lt;/property&gt;
+  &lt;property name=&quot;type&quot;&gt;GTK_WINDOW_TOPLEVEL&lt;/property&gt;
+  &lt;property name=&quot;window_position&quot;&gt;GTK_WIN_POS_CENTER&lt;/property&gt;
+  &lt;property name=&quot;modal&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;default_width&quot;&gt;690&lt;/property&gt;
+  &lt;property name=&quot;default_height&quot;&gt;200&lt;/property&gt;
+  &lt;property name=&quot;resizable&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;destroy_with_parent&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;icon&quot;&gt;nx-icon.png&lt;/property&gt;
+  &lt;property name=&quot;decorated&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;skip_taskbar_hint&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;skip_pager_hint&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;type_hint&quot;&gt;GDK_WINDOW_TYPE_HINT_NORMAL&lt;/property&gt;
+  &lt;property name=&quot;gravity&quot;&gt;GDK_GRAVITY_NORTH_WEST&lt;/property&gt;
+  &lt;signal name=&quot;destroy&quot; handler=&quot;gtk_main_quit&quot; last_modification_time=&quot;Thu, 02 Sep 2004 09:22:11 GMT&quot;/&gt;
+  &lt;signal name=&quot;delete-event&quot; handler=&quot;on_main_win_delete_event&quot; last_modification_time=&quot;Thu, 02 Sep 2004 09:22:26 GMT&quot;/&gt;
+
+  &lt;child&gt;
+    &lt;widget class=&quot;GtkHBox&quot; id=&quot;hbox_nxlaunch1&quot;&gt;
+      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+      &lt;child&gt;
+	&lt;widget class=&quot;GtkVBox&quot; id=&quot;vbox_nxlaunch1&quot;&gt;
+	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+	  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkHBox&quot; id=&quot;hbox87&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkScrolledWindow&quot; id=&quot;scrolledwindow_nxlaunch&quot;&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;hscrollbar_policy&quot;&gt;GTK_POLICY_ALWAYS&lt;/property&gt;
+		  &lt;property name=&quot;vscrollbar_policy&quot;&gt;GTK_POLICY_ALWAYS&lt;/property&gt;
+		  &lt;property name=&quot;shadow_type&quot;&gt;GTK_SHADOW_NONE&lt;/property&gt;
+		  &lt;property name=&quot;window_placement&quot;&gt;GTK_CORNER_TOP_LEFT&lt;/property&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkViewport&quot; id=&quot;viewport_nxlaunch&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;shadow_type&quot;&gt;GTK_SHADOW_IN&lt;/property&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkTreeView&quot; id=&quot;treeview_nxconnection&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;headers_visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;rules_hint&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;reorderable&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;enable_search&quot;&gt;True&lt;/property&gt;
+			  &lt;signal name=&quot;row_activated&quot; handler=&quot;on_button_nxlaunch_launch_clicked&quot; last_modification_time=&quot;Tue, 21 Aug 2007 14:02:34 GMT&quot;/&gt;
+			  &lt;signal name=&quot;cursor_changed&quot; handler=&quot;on_treeview_connection_cursor_changed&quot; last_modification_time=&quot;Wed, 12 Sep 2007 12:45:25 GMT&quot;/&gt;
+			&lt;/widget&gt;
+		      &lt;/child&gt;
+		    &lt;/widget&gt;
+		  &lt;/child&gt;
+		&lt;/widget&gt;
+		&lt;packing&gt;
+		  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+		&lt;/packing&gt;
+	      &lt;/child&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkVButtonBox&quot; id=&quot;vbuttonbox1&quot;&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;layout_style&quot;&gt;GTK_BUTTONBOX_START&lt;/property&gt;
+		  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkButton&quot; id=&quot;button_nxlaunch_new&quot;&gt;
+		      &lt;property name=&quot;tooltip&quot; translatable=&quot;yes&quot;&gt;Configure a new NX connection&lt;/property&gt;
+		      &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;label&quot;&gt;gtk-new&lt;/property&gt;
+		      &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+		      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+		      &lt;signal name=&quot;clicked&quot; handler=&quot;on_button_nxlaunch_new_clicked&quot; last_modification_time=&quot;Mon, 20 Aug 2007 15:10:34 GMT&quot;/&gt;
+		    &lt;/widget&gt;
+		  &lt;/child&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkButton&quot; id=&quot;button_nxlaunch_edit&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;tooltip&quot; translatable=&quot;yes&quot;&gt;Edit the selected NX connection&lt;/property&gt;
+		      &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;label&quot;&gt;gtk-edit&lt;/property&gt;
+		      &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+		      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+		      &lt;signal name=&quot;clicked&quot; handler=&quot;on_button_nxlaunch_edit_clicked&quot; last_modification_time=&quot;Mon, 20 Aug 2007 15:10:27 GMT&quot;/&gt;
+		    &lt;/widget&gt;
+		  &lt;/child&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkButton&quot; id=&quot;button_nxlaunch_delete&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;tooltip&quot; translatable=&quot;yes&quot;&gt;Delete the selected NX connection&lt;/property&gt;
+		      &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;label&quot;&gt;gtk-delete&lt;/property&gt;
+		      &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+		      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+		      &lt;signal name=&quot;clicked&quot; handler=&quot;on_button_nxlaunch_delete_clicked&quot; last_modification_time=&quot;Mon, 20 Aug 2007 15:10:19 GMT&quot;/&gt;
+		    &lt;/widget&gt;
+		  &lt;/child&gt;
+		&lt;/widget&gt;
+		&lt;packing&gt;
+		  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+		&lt;/packing&gt;
+	      &lt;/child&gt;
+	    &lt;/widget&gt;
+	    &lt;packing&gt;
+	      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+	    &lt;/packing&gt;
+	  &lt;/child&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkHBox&quot; id=&quot;hbox86&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkLabel&quot; id=&quot;label223&quot;&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Username:&lt;/property&gt;
+		  &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+		  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+		  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+		  &lt;property name=&quot;xpad&quot;&gt;5&lt;/property&gt;
+		  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+		&lt;/widget&gt;
+		&lt;packing&gt;
+		  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+		&lt;/packing&gt;
+	      &lt;/child&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkEntry&quot; id=&quot;entry_nxlaunch_user&quot;&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;editable&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;visibility&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;max_length&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;text&quot; translatable=&quot;yes&quot;&gt;&lt;/property&gt;
+		  &lt;property name=&quot;has_frame&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;invisible_char&quot;&gt;*&lt;/property&gt;
+		  &lt;property name=&quot;activates_default&quot;&gt;False&lt;/property&gt;
+		&lt;/widget&gt;
+		&lt;packing&gt;
+		  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+		&lt;/packing&gt;
+	      &lt;/child&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkLabel&quot; id=&quot;label224&quot;&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Password:&lt;/property&gt;
+		  &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+		  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+		  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+		  &lt;property name=&quot;xpad&quot;&gt;5&lt;/property&gt;
+		  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+		&lt;/widget&gt;
+		&lt;packing&gt;
+		  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+		&lt;/packing&gt;
+	      &lt;/child&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkEntry&quot; id=&quot;entry_nxlaunch_password&quot;&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;has_focus&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;editable&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;visibility&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;max_length&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;text&quot; translatable=&quot;yes&quot;&gt;&lt;/property&gt;
+		  &lt;property name=&quot;has_frame&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;invisible_char&quot;&gt;*&lt;/property&gt;
+		  &lt;property name=&quot;activates_default&quot;&gt;True&lt;/property&gt;
+		&lt;/widget&gt;
+		&lt;packing&gt;
+		  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+		&lt;/packing&gt;
+	      &lt;/child&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkHButtonBox&quot; id=&quot;hbuttonbox1&quot;&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;layout_style&quot;&gt;GTK_BUTTONBOX_EDGE&lt;/property&gt;
+		  &lt;property name=&quot;spacing&quot;&gt;20&lt;/property&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkButton&quot; id=&quot;button_nxlaunch_launch&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;has_default&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+		      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+		      &lt;signal name=&quot;clicked&quot; handler=&quot;on_button_nxlaunch_launch_clicked&quot; last_modification_time=&quot;Tue, 11 Sep 2007 15:54:42 GMT&quot;/&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkAlignment&quot; id=&quot;alignment46&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+			  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+			  &lt;property name=&quot;xscale&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;yscale&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;top_padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;bottom_padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;left_padding&quot;&gt;0&lt;/property&gt;
+			  &lt;property name=&quot;right_padding&quot;&gt;0&lt;/property&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkHBox&quot; id=&quot;hbox88&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;spacing&quot;&gt;2&lt;/property&gt;
+
+			      &lt;child&gt;
+				&lt;widget class=&quot;GtkImage&quot; id=&quot;image37&quot;&gt;
+				  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;stock&quot;&gt;gtk-network&lt;/property&gt;
+				  &lt;property name=&quot;icon_size&quot;&gt;4&lt;/property&gt;
+				  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+				  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+				  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+				&lt;/widget&gt;
+				&lt;packing&gt;
+				  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+				&lt;/packing&gt;
+			      &lt;/child&gt;
+
+			      &lt;child&gt;
+				&lt;widget class=&quot;GtkLabel&quot; id=&quot;label225&quot;&gt;
+				  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;_Launch&lt;/property&gt;
+				  &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+				  &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+				  &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+				  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+				  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+				&lt;/widget&gt;
+				&lt;packing&gt;
+				  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+				  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+				  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+				&lt;/packing&gt;
+			      &lt;/child&gt;
+			    &lt;/widget&gt;
+			  &lt;/child&gt;
+			&lt;/widget&gt;
+		      &lt;/child&gt;
+		    &lt;/widget&gt;
+		  &lt;/child&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkButton&quot; id=&quot;button_nxlaunch_quit&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;label&quot;&gt;gtk-quit&lt;/property&gt;
+		      &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+		      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+		      &lt;signal name=&quot;clicked&quot; handler=&quot;on_button_nxlaunch_quit_clicked&quot; last_modification_time=&quot;Tue, 11 Sep 2007 15:54:36 GMT&quot;/&gt;
+		    &lt;/widget&gt;
+		  &lt;/child&gt;
+		&lt;/widget&gt;
+		&lt;packing&gt;
+		  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+		&lt;/packing&gt;
+	      &lt;/child&gt;
+	    &lt;/widget&gt;
+	    &lt;packing&gt;
+	      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+	    &lt;/packing&gt;
+	  &lt;/child&gt;
+	&lt;/widget&gt;
+	&lt;packing&gt;
+	  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+	&lt;/packing&gt;
+      &lt;/child&gt;
+    &lt;/widget&gt;
+  &lt;/child&gt;
+&lt;/widget&gt;
+
+&lt;widget class=&quot;GtkWindow&quot; id=&quot;session_list&quot;&gt;
+  &lt;property name=&quot;title&quot; translatable=&quot;yes&quot;&gt;Available Sessions&lt;/property&gt;
+  &lt;property name=&quot;type&quot;&gt;GTK_WINDOW_TOPLEVEL&lt;/property&gt;
+  &lt;property name=&quot;window_position&quot;&gt;GTK_WIN_POS_CENTER_ON_PARENT&lt;/property&gt;
+  &lt;property name=&quot;modal&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;default_width&quot;&gt;600&lt;/property&gt;
+  &lt;property name=&quot;default_height&quot;&gt;220&lt;/property&gt;
+  &lt;property name=&quot;resizable&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;destroy_with_parent&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;icon&quot;&gt;nx-icon.png&lt;/property&gt;
+  &lt;property name=&quot;decorated&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;skip_taskbar_hint&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;skip_pager_hint&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;type_hint&quot;&gt;GDK_WINDOW_TYPE_HINT_NORMAL&lt;/property&gt;
+  &lt;property name=&quot;gravity&quot;&gt;GDK_GRAVITY_NORTH_WEST&lt;/property&gt;
+
+  &lt;child&gt;
+    &lt;widget class=&quot;GtkVBox&quot; id=&quot;vbox_nxsession1&quot;&gt;
+      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+      &lt;child&gt;
+	&lt;widget class=&quot;GtkScrolledWindow&quot; id=&quot;scrolledwindow_nxsession&quot;&gt;
+	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;hscrollbar_policy&quot;&gt;GTK_POLICY_ALWAYS&lt;/property&gt;
+	  &lt;property name=&quot;vscrollbar_policy&quot;&gt;GTK_POLICY_ALWAYS&lt;/property&gt;
+	  &lt;property name=&quot;shadow_type&quot;&gt;GTK_SHADOW_NONE&lt;/property&gt;
+	  &lt;property name=&quot;window_placement&quot;&gt;GTK_CORNER_TOP_LEFT&lt;/property&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkViewport&quot; id=&quot;viewport_nxsession&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;shadow_type&quot;&gt;GTK_SHADOW_IN&lt;/property&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkTreeView&quot; id=&quot;treeview_nxsession&quot;&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;headers_visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;rules_hint&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;reorderable&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;enable_search&quot;&gt;True&lt;/property&gt;
+		  &lt;signal name=&quot;row_activated&quot; handler=&quot;on_button_nxsession_connect_clicked&quot; last_modification_time=&quot;Mon, 20 Aug 2007 15:45:22 GMT&quot;/&gt;
+		  &lt;signal name=&quot;toggle_cursor_row&quot; handler=&quot;on_nxsession_toggle_cursor_row&quot; last_modification_time=&quot;Fri, 07 Sep 2007 13:22:11 GMT&quot;/&gt;
+		&lt;/widget&gt;
+	      &lt;/child&gt;
+	    &lt;/widget&gt;
+	  &lt;/child&gt;
+	&lt;/widget&gt;
+	&lt;packing&gt;
+	  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+	&lt;/packing&gt;
+      &lt;/child&gt;
+
+      &lt;child&gt;
+	&lt;widget class=&quot;GtkHBox&quot; id=&quot;hbox_nxsession1&quot;&gt;
+	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+	  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkHButtonBox&quot; id=&quot;hbuttonbox_nxsession_l&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;layout_style&quot;&gt;GTK_BUTTONBOX_START&lt;/property&gt;
+	      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkButton&quot; id=&quot;button_nxsession_connect&quot;&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;tooltip&quot; translatable=&quot;yes&quot;&gt;Connect to the selected NX session&lt;/property&gt;
+		  &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+		  &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+		  &lt;signal name=&quot;clicked&quot; handler=&quot;on_button_nxsession_connect_clicked&quot; last_modification_time=&quot;Mon, 20 Aug 2007 15:12:07 GMT&quot;/&gt;
+		  &lt;signal name=&quot;clicked&quot; handler=&quot;gtk_widget_hide&quot; after=&quot;yes&quot; object=&quot;session_list&quot; last_modification_time=&quot;Fri, 07 Sep 2007 15:02:26 GMT&quot;/&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkAlignment&quot; id=&quot;alignment44&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;xscale&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;yscale&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;top_padding&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;bottom_padding&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;left_padding&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;right_padding&quot;&gt;0&lt;/property&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkHBox&quot; id=&quot;hbox84&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;spacing&quot;&gt;2&lt;/property&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkImage&quot; id=&quot;image35&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;stock&quot;&gt;gtk-ok&lt;/property&gt;
+			      &lt;property name=&quot;icon_size&quot;&gt;4&lt;/property&gt;
+			      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkLabel&quot; id=&quot;label221&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;_Connect&lt;/property&gt;
+			      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+			      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+			&lt;/widget&gt;
+		      &lt;/child&gt;
+		    &lt;/widget&gt;
+		  &lt;/child&gt;
+		&lt;/widget&gt;
+	      &lt;/child&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkButton&quot; id=&quot;button_nxsession_launch&quot;&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;tooltip&quot; translatable=&quot;yes&quot;&gt;Start a new NX session&lt;/property&gt;
+		  &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+		  &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+		  &lt;signal name=&quot;clicked&quot; handler=&quot;on_button_nxsession_launch_clicked&quot; after=&quot;yes&quot; last_modification_time=&quot;Mon, 20 Aug 2007 15:12:19 GMT&quot;/&gt;
+		  &lt;signal name=&quot;clicked&quot; handler=&quot;gtk_widget_hide&quot; after=&quot;yes&quot; object=&quot;session_list&quot; last_modification_time=&quot;Fri, 07 Sep 2007 15:02:10 GMT&quot;/&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkAlignment&quot; id=&quot;alignment43&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;xscale&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;yscale&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;top_padding&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;bottom_padding&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;left_padding&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;right_padding&quot;&gt;0&lt;/property&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkHBox&quot; id=&quot;hbox83&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;spacing&quot;&gt;2&lt;/property&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkImage&quot; id=&quot;image34&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;stock&quot;&gt;gtk-network&lt;/property&gt;
+			      &lt;property name=&quot;icon_size&quot;&gt;4&lt;/property&gt;
+			      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkLabel&quot; id=&quot;label220&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;label&quot;&gt;_Launch New&lt;/property&gt;
+			      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+			      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+			&lt;/widget&gt;
+		      &lt;/child&gt;
+		    &lt;/widget&gt;
+		  &lt;/child&gt;
+		&lt;/widget&gt;
+	      &lt;/child&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkButton&quot; id=&quot;button_nxsession_terminate&quot;&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;tooltip&quot; translatable=&quot;yes&quot;&gt;Terminate the selected NX session&lt;/property&gt;
+		  &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+		  &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+		  &lt;signal name=&quot;clicked&quot; handler=&quot;on_button_nxsession_terminate_clicked&quot; last_modification_time=&quot;Mon, 20 Aug 2007 15:12:35 GMT&quot;/&gt;
+
+		  &lt;child&gt;
+		    &lt;widget class=&quot;GtkAlignment&quot; id=&quot;alignment42&quot;&gt;
+		      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+		      &lt;property name=&quot;xscale&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;yscale&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;top_padding&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;bottom_padding&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;left_padding&quot;&gt;0&lt;/property&gt;
+		      &lt;property name=&quot;right_padding&quot;&gt;0&lt;/property&gt;
+
+		      &lt;child&gt;
+			&lt;widget class=&quot;GtkHBox&quot; id=&quot;hbox82&quot;&gt;
+			  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+			  &lt;property name=&quot;spacing&quot;&gt;2&lt;/property&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkImage&quot; id=&quot;image33&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;stock&quot;&gt;gtk-delete&lt;/property&gt;
+			      &lt;property name=&quot;icon_size&quot;&gt;4&lt;/property&gt;
+			      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+
+			  &lt;child&gt;
+			    &lt;widget class=&quot;GtkLabel&quot; id=&quot;label219&quot;&gt;
+			      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Terminate&lt;/property&gt;
+			      &lt;property name=&quot;use_underline&quot;&gt;True&lt;/property&gt;
+			      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+			      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+			      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+			    &lt;/widget&gt;
+			    &lt;packing&gt;
+			      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+			      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+			      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+			    &lt;/packing&gt;
+			  &lt;/child&gt;
+			&lt;/widget&gt;
+		      &lt;/child&gt;
+		    &lt;/widget&gt;
+		  &lt;/child&gt;
+		&lt;/widget&gt;
+	      &lt;/child&gt;
+	    &lt;/widget&gt;
+	    &lt;packing&gt;
+	      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+	    &lt;/packing&gt;
+	  &lt;/child&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkHButtonBox&quot; id=&quot;hbuttonbox_nxsession_r&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;layout_style&quot;&gt;GTK_BUTTONBOX_END&lt;/property&gt;
+	      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkButton&quot; id=&quot;button_nxsession_cancel&quot;&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;tooltip&quot; translatable=&quot;yes&quot;&gt;Return to the main NXLaunch window&lt;/property&gt;
+		  &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;label&quot;&gt;gtk-cancel&lt;/property&gt;
+		  &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+		  &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+		  &lt;signal name=&quot;clicked&quot; handler=&quot;on_button_nxsession_cancel_clicked&quot; last_modification_time=&quot;Mon, 20 Aug 2007 15:12:41 GMT&quot;/&gt;
+		&lt;/widget&gt;
+	      &lt;/child&gt;
+	    &lt;/widget&gt;
+	    &lt;packing&gt;
+	      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+	    &lt;/packing&gt;
+	  &lt;/child&gt;
+	&lt;/widget&gt;
+	&lt;packing&gt;
+	  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+	  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+	&lt;/packing&gt;
+      &lt;/child&gt;
+    &lt;/widget&gt;
+  &lt;/child&gt;
+&lt;/widget&gt;
+
+&lt;widget class=&quot;GtkDialog&quot; id=&quot;dialog_password&quot;&gt;
+  &lt;property name=&quot;title&quot; translatable=&quot;yes&quot;&gt;Password&lt;/property&gt;
+  &lt;property name=&quot;type&quot;&gt;GTK_WINDOW_TOPLEVEL&lt;/property&gt;
+  &lt;property name=&quot;window_position&quot;&gt;GTK_WIN_POS_CENTER_ON_PARENT&lt;/property&gt;
+  &lt;property name=&quot;modal&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;resizable&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;destroy_with_parent&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;icon&quot;&gt;nx-icon.png&lt;/property&gt;
+  &lt;property name=&quot;decorated&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;skip_taskbar_hint&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;skip_pager_hint&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;type_hint&quot;&gt;GDK_WINDOW_TYPE_HINT_DIALOG&lt;/property&gt;
+  &lt;property name=&quot;gravity&quot;&gt;GDK_GRAVITY_NORTH_WEST&lt;/property&gt;
+  &lt;property name=&quot;has_separator&quot;&gt;True&lt;/property&gt;
+
+  &lt;child internal-child=&quot;vbox&quot;&gt;
+    &lt;widget class=&quot;GtkVBox&quot; id=&quot;dialog-vbox1&quot;&gt;
+      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+      &lt;child internal-child=&quot;action_area&quot;&gt;
+	&lt;widget class=&quot;GtkHButtonBox&quot; id=&quot;dialog-action_area1&quot;&gt;
+	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;layout_style&quot;&gt;GTK_BUTTONBOX_END&lt;/property&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkButton&quot; id=&quot;cancelbutton1&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;label&quot;&gt;gtk-cancel&lt;/property&gt;
+	      &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+	      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;response_id&quot;&gt;-6&lt;/property&gt;
+	      &lt;signal name=&quot;clicked&quot; handler=&quot;on_button_password_cancel_clicked&quot; last_modification_time=&quot;Fri, 07 Sep 2007 15:49:16 GMT&quot;/&gt;
+	      &lt;signal name=&quot;clicked&quot; handler=&quot;gtk_widget_hide&quot; after=&quot;yes&quot; object=&quot;dialog_password&quot; last_modification_time=&quot;Fri, 07 Sep 2007 15:49:33 GMT&quot;/&gt;
+	    &lt;/widget&gt;
+	  &lt;/child&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkButton&quot; id=&quot;okbutton1&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;has_default&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;label&quot;&gt;gtk-ok&lt;/property&gt;
+	      &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+	      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;response_id&quot;&gt;-5&lt;/property&gt;
+	      &lt;signal name=&quot;clicked&quot; handler=&quot;on_button_password_ok_clicked&quot; after=&quot;yes&quot; last_modification_time=&quot;Sun, 02 Sep 2007 09:44:23 GMT&quot;/&gt;
+	    &lt;/widget&gt;
+	  &lt;/child&gt;
+	&lt;/widget&gt;
+	&lt;packing&gt;
+	  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+	  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;pack_type&quot;&gt;GTK_PACK_END&lt;/property&gt;
+	&lt;/packing&gt;
+      &lt;/child&gt;
+
+      &lt;child&gt;
+	&lt;widget class=&quot;GtkFrame&quot; id=&quot;frame1&quot;&gt;
+	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;label_xalign&quot;&gt;0&lt;/property&gt;
+	  &lt;property name=&quot;label_yalign&quot;&gt;0.5&lt;/property&gt;
+	  &lt;property name=&quot;shadow_type&quot;&gt;GTK_SHADOW_NONE&lt;/property&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkAlignment&quot; id=&quot;alignment45&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+	      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+	      &lt;property name=&quot;xscale&quot;&gt;1&lt;/property&gt;
+	      &lt;property name=&quot;yscale&quot;&gt;1&lt;/property&gt;
+	      &lt;property name=&quot;top_padding&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;bottom_padding&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;left_padding&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;right_padding&quot;&gt;0&lt;/property&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkEntry&quot; id=&quot;entry_password_dialog&quot;&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;has_focus&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;editable&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;visibility&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;max_length&quot;&gt;255&lt;/property&gt;
+		  &lt;property name=&quot;text&quot; translatable=&quot;yes&quot;&gt;&lt;/property&gt;
+		  &lt;property name=&quot;has_frame&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;invisible_char&quot;&gt;*&lt;/property&gt;
+		  &lt;property name=&quot;activates_default&quot;&gt;True&lt;/property&gt;
+		&lt;/widget&gt;
+	      &lt;/child&gt;
+	    &lt;/widget&gt;
+	  &lt;/child&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkLabel&quot; id=&quot;label222&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;&lt;i&gt;Enter the session password:&lt;/i&gt;&lt;/property&gt;
+	      &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;use_markup&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+	      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+	      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+	      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+	    &lt;/widget&gt;
+	    &lt;packing&gt;
+	      &lt;property name=&quot;type&quot;&gt;label_item&lt;/property&gt;
+	    &lt;/packing&gt;
+	  &lt;/child&gt;
+	&lt;/widget&gt;
+	&lt;packing&gt;
+	  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+	&lt;/packing&gt;
+      &lt;/child&gt;
+    &lt;/widget&gt;
+  &lt;/child&gt;
+&lt;/widget&gt;
+
+&lt;widget class=&quot;GtkDialog&quot; id=&quot;nxlaunch_progress&quot;&gt;
+  &lt;property name=&quot;title&quot; translatable=&quot;yes&quot;&gt;Launch Status&lt;/property&gt;
+  &lt;property name=&quot;type&quot;&gt;GTK_WINDOW_TOPLEVEL&lt;/property&gt;
+  &lt;property name=&quot;window_position&quot;&gt;GTK_WIN_POS_CENTER_ON_PARENT&lt;/property&gt;
+  &lt;property name=&quot;modal&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;default_width&quot;&gt;350&lt;/property&gt;
+  &lt;property name=&quot;resizable&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;destroy_with_parent&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;icon&quot;&gt;nx-icon.png&lt;/property&gt;
+  &lt;property name=&quot;decorated&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;skip_taskbar_hint&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;skip_pager_hint&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;type_hint&quot;&gt;GDK_WINDOW_TYPE_HINT_DIALOG&lt;/property&gt;
+  &lt;property name=&quot;gravity&quot;&gt;GDK_GRAVITY_NORTH_WEST&lt;/property&gt;
+  &lt;property name=&quot;has_separator&quot;&gt;True&lt;/property&gt;
+
+  &lt;child internal-child=&quot;vbox&quot;&gt;
+    &lt;widget class=&quot;GtkVBox&quot; id=&quot;dialog-vbox3&quot;&gt;
+      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+      &lt;child internal-child=&quot;action_area&quot;&gt;
+	&lt;widget class=&quot;GtkHButtonBox&quot; id=&quot;dialog-action_area3&quot;&gt;
+	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;layout_style&quot;&gt;GTK_BUTTONBOX_END&lt;/property&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkButton&quot; id=&quot;button1&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;label&quot;&gt;gtk-cancel&lt;/property&gt;
+	      &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+	      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;response_id&quot;&gt;-6&lt;/property&gt;
+	    &lt;/widget&gt;
+	  &lt;/child&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkButton&quot; id=&quot;button_progress_quit&quot;&gt;
+	      &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;label&quot;&gt;gtk-quit&lt;/property&gt;
+	      &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+	      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;response_id&quot;&gt;0&lt;/property&gt;
+	    &lt;/widget&gt;
+	  &lt;/child&gt;
+	&lt;/widget&gt;
+	&lt;packing&gt;
+	  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+	  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;pack_type&quot;&gt;GTK_PACK_END&lt;/property&gt;
+	&lt;/packing&gt;
+      &lt;/child&gt;
+
+      &lt;child&gt;
+	&lt;widget class=&quot;GtkVBox&quot; id=&quot;vbox1&quot;&gt;
+	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+	  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkAlignment&quot; id=&quot;alignment47&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+	      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+	      &lt;property name=&quot;xscale&quot;&gt;1&lt;/property&gt;
+	      &lt;property name=&quot;yscale&quot;&gt;1&lt;/property&gt;
+	      &lt;property name=&quot;top_padding&quot;&gt;8&lt;/property&gt;
+	      &lt;property name=&quot;bottom_padding&quot;&gt;8&lt;/property&gt;
+	      &lt;property name=&quot;left_padding&quot;&gt;8&lt;/property&gt;
+	      &lt;property name=&quot;right_padding&quot;&gt;8&lt;/property&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkProgressBar&quot; id=&quot;progressbar&quot;&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;orientation&quot;&gt;GTK_PROGRESS_LEFT_TO_RIGHT&lt;/property&gt;
+		  &lt;property name=&quot;fraction&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;pulse_step&quot;&gt;0.10000000149&lt;/property&gt;
+		&lt;/widget&gt;
+	      &lt;/child&gt;
+	    &lt;/widget&gt;
+	    &lt;packing&gt;
+	      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+	    &lt;/packing&gt;
+	  &lt;/child&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkHSeparator&quot; id=&quot;hseparator1&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	    &lt;/widget&gt;
+	    &lt;packing&gt;
+	      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+	    &lt;/packing&gt;
+	  &lt;/child&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkHBox&quot; id=&quot;hbox89&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkImage&quot; id=&quot;image38&quot;&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;pixbuf&quot;&gt;nx-icon.png&lt;/property&gt;
+		  &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+		  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+		  &lt;property name=&quot;xpad&quot;&gt;9&lt;/property&gt;
+		  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+		&lt;/widget&gt;
+		&lt;packing&gt;
+		  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+		&lt;/packing&gt;
+	      &lt;/child&gt;
+
+	      &lt;child&gt;
+		&lt;widget class=&quot;GtkLabel&quot; id=&quot;label_progress&quot;&gt;
+		  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Launching session...&lt;/property&gt;
+		  &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+		  &lt;property name=&quot;wrap&quot;&gt;True&lt;/property&gt;
+		  &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;xalign&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+		  &lt;property name=&quot;xpad&quot;&gt;7&lt;/property&gt;
+		  &lt;property name=&quot;ypad&quot;&gt;10&lt;/property&gt;
+		&lt;/widget&gt;
+		&lt;packing&gt;
+		  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+		  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+		  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+		&lt;/packing&gt;
+	      &lt;/child&gt;
+	    &lt;/widget&gt;
+	    &lt;packing&gt;
+	      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+	    &lt;/packing&gt;
+	  &lt;/child&gt;
+	&lt;/widget&gt;
+	&lt;packing&gt;
+	  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+	&lt;/packing&gt;
+      &lt;/child&gt;
+    &lt;/widget&gt;
+  &lt;/child&gt;
+&lt;/widget&gt;
+
+&lt;widget class=&quot;GtkDialog&quot; id=&quot;unrecoverable_error&quot;&gt;
+  &lt;property name=&quot;title&quot; translatable=&quot;yes&quot;&gt;Error&lt;/property&gt;
+  &lt;property name=&quot;type&quot;&gt;GTK_WINDOW_TOPLEVEL&lt;/property&gt;
+  &lt;property name=&quot;window_position&quot;&gt;GTK_WIN_POS_CENTER_ON_PARENT&lt;/property&gt;
+  &lt;property name=&quot;modal&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;resizable&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;destroy_with_parent&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;decorated&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;skip_taskbar_hint&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;skip_pager_hint&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;type_hint&quot;&gt;GDK_WINDOW_TYPE_HINT_DIALOG&lt;/property&gt;
+  &lt;property name=&quot;gravity&quot;&gt;GDK_GRAVITY_NORTH_WEST&lt;/property&gt;
+  &lt;property name=&quot;has_separator&quot;&gt;True&lt;/property&gt;
+
+  &lt;child internal-child=&quot;vbox&quot;&gt;
+    &lt;widget class=&quot;GtkVBox&quot; id=&quot;dialog-vbox4&quot;&gt;
+      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+      &lt;child internal-child=&quot;action_area&quot;&gt;
+	&lt;widget class=&quot;GtkHButtonBox&quot; id=&quot;dialog-action_area4&quot;&gt;
+	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;layout_style&quot;&gt;GTK_BUTTONBOX_END&lt;/property&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkButton&quot; id=&quot;button2&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;label&quot;&gt;gtk-quit&lt;/property&gt;
+	      &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+	      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;response_id&quot;&gt;0&lt;/property&gt;
+	      &lt;signal name=&quot;clicked&quot; handler=&quot;gtk_main_quit&quot; last_modification_time=&quot;Sat, 15 Sep 2007 21:00:52 GMT&quot;/&gt;
+	    &lt;/widget&gt;
+	  &lt;/child&gt;
+	&lt;/widget&gt;
+	&lt;packing&gt;
+	  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+	  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;pack_type&quot;&gt;GTK_PACK_END&lt;/property&gt;
+	&lt;/packing&gt;
+      &lt;/child&gt;
+
+      &lt;child&gt;
+	&lt;widget class=&quot;GtkHBox&quot; id=&quot;hbox90&quot;&gt;
+	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+	  &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkImage&quot; id=&quot;image39&quot;&gt;
+	      &lt;property name=&quot;width_request&quot;&gt;32&lt;/property&gt;
+	      &lt;property name=&quot;height_request&quot;&gt;32&lt;/property&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;pixbuf&quot;&gt;nx-icon.png&lt;/property&gt;
+	      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+	      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+	      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+	    &lt;/widget&gt;
+	    &lt;packing&gt;
+	      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+	    &lt;/packing&gt;
+	  &lt;/child&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkLabel&quot; id=&quot;unrecoverable_error_message&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Error...&lt;/property&gt;
+	      &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_LEFT&lt;/property&gt;
+	      &lt;property name=&quot;wrap&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;xalign&quot;&gt;0.5&lt;/property&gt;
+	      &lt;property name=&quot;yalign&quot;&gt;0.5&lt;/property&gt;
+	      &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+	    &lt;/widget&gt;
+	    &lt;packing&gt;
+	      &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	      &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+	      &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+	    &lt;/packing&gt;
+	  &lt;/child&gt;
+	&lt;/widget&gt;
+	&lt;packing&gt;
+	  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+	  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+	&lt;/packing&gt;
+      &lt;/child&gt;
+    &lt;/widget&gt;
+  &lt;/child&gt;
+&lt;/widget&gt;
+
+&lt;widget class=&quot;GtkDialog&quot; id=&quot;dialog_general_error&quot;&gt;
+  &lt;property name=&quot;title&quot; translatable=&quot;yes&quot;&gt;Error&lt;/property&gt;
+  &lt;property name=&quot;type&quot;&gt;GTK_WINDOW_TOPLEVEL&lt;/property&gt;
+  &lt;property name=&quot;window_position&quot;&gt;GTK_WIN_POS_CENTER_ON_PARENT&lt;/property&gt;
+  &lt;property name=&quot;modal&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;default_width&quot;&gt;400&lt;/property&gt;
+  &lt;property name=&quot;default_height&quot;&gt;200&lt;/property&gt;
+  &lt;property name=&quot;resizable&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;destroy_with_parent&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;icon&quot;&gt;nx-icon.png&lt;/property&gt;
+  &lt;property name=&quot;decorated&quot;&gt;True&lt;/property&gt;
+  &lt;property name=&quot;skip_taskbar_hint&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;skip_pager_hint&quot;&gt;False&lt;/property&gt;
+  &lt;property name=&quot;type_hint&quot;&gt;GDK_WINDOW_TYPE_HINT_DIALOG&lt;/property&gt;
+  &lt;property name=&quot;gravity&quot;&gt;GDK_GRAVITY_NORTH_WEST&lt;/property&gt;
+  &lt;property name=&quot;has_separator&quot;&gt;True&lt;/property&gt;
+  &lt;signal name=&quot;delete_event&quot; handler=&quot;gtk_widget_hide&quot; object=&quot;dialog_failed_download&quot; last_modification_time=&quot;Fri, 14 Oct 2005 14:06:55 GMT&quot;/&gt;
+
+  &lt;child internal-child=&quot;vbox&quot;&gt;
+    &lt;widget class=&quot;GtkVBox&quot; id=&quot;vbox63&quot;&gt;
+      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+      &lt;property name=&quot;homogeneous&quot;&gt;False&lt;/property&gt;
+      &lt;property name=&quot;spacing&quot;&gt;0&lt;/property&gt;
+
+      &lt;child internal-child=&quot;action_area&quot;&gt;
+	&lt;widget class=&quot;GtkHButtonBox&quot; id=&quot;hbuttonbox17&quot;&gt;
+	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;layout_style&quot;&gt;GTK_BUTTONBOX_END&lt;/property&gt;
+
+	  &lt;child&gt;
+	    &lt;widget class=&quot;GtkButton&quot; id=&quot;button_general_error_ok&quot;&gt;
+	      &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_default&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;can_focus&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;label&quot;&gt;gtk-ok&lt;/property&gt;
+	      &lt;property name=&quot;use_stock&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;relief&quot;&gt;GTK_RELIEF_NORMAL&lt;/property&gt;
+	      &lt;property name=&quot;focus_on_click&quot;&gt;True&lt;/property&gt;
+	      &lt;property name=&quot;response_id&quot;&gt;-5&lt;/property&gt;
+	      &lt;signal name=&quot;clicked&quot; handler=&quot;gtk_widget_hide&quot; object=&quot;dialog_general_error&quot; last_modification_time=&quot;Thu, 29 Sep 2005 20:59:53 GMT&quot;/&gt;
+	    &lt;/widget&gt;
+	  &lt;/child&gt;
+	&lt;/widget&gt;
+	&lt;packing&gt;
+	  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	  &lt;property name=&quot;expand&quot;&gt;False&lt;/property&gt;
+	  &lt;property name=&quot;fill&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;pack_type&quot;&gt;GTK_PACK_END&lt;/property&gt;
+	&lt;/packing&gt;
+      &lt;/child&gt;
+
+      &lt;child&gt;
+	&lt;widget class=&quot;GtkLabel&quot; id=&quot;label_general_error&quot;&gt;
+	  &lt;property name=&quot;visible&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;label&quot; translatable=&quot;yes&quot;&gt;Error&lt;/property&gt;
+	  &lt;property name=&quot;use_underline&quot;&gt;False&lt;/property&gt;
+	  &lt;property name=&quot;use_markup&quot;&gt;False&lt;/property&gt;
+	  &lt;property name=&quot;justify&quot;&gt;GTK_JUSTIFY_CENTER&lt;/property&gt;
+	  &lt;property name=&quot;wrap&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;selectable&quot;&gt;False&lt;/property&gt;
+	  &lt;property name=&quot;xalign&quot;&gt;0.469999998808&lt;/property&gt;
+	  &lt;property name=&quot;yalign&quot;&gt;0.509999990463&lt;/property&gt;
+	  &lt;property name=&quot;xpad&quot;&gt;0&lt;/property&gt;
+	  &lt;property name=&quot;ypad&quot;&gt;0&lt;/property&gt;
+	&lt;/widget&gt;
+	&lt;packing&gt;
+	  &lt;property name=&quot;padding&quot;&gt;0&lt;/property&gt;
+	  &lt;property name=&quot;expand&quot;&gt;True&lt;/property&gt;
+	  &lt;property name=&quot;fill&quot;&gt;False&lt;/property&gt;
+	&lt;/packing&gt;
+      &lt;/child&gt;
+    &lt;/widget&gt;
+  &lt;/child&gt;
+&lt;/widget&gt;
+
+&lt;/glade-interface&gt;

Added: nxlaunch/src/nxlaunch.h
===================================================================
--- nxlaunch/src/nxlaunch.h	2007-09-16 20:16:05 UTC (rev 380)
+++ nxlaunch/src/nxlaunch.h	2007-09-17 12:30:56 UTC (rev 381)
@@ -0,0 +1,356 @@
+/***************************************************************************
+                   nxlaunch: A GTK NX Client based on nxcl
+                   ---------------------------------------
+    begin                : September 2007
+    copyright            : (C) 2007 Embedded Software Foundry Ltd. (U.K.)
+                         :     Author: Sebastian James
+    email                : <A HREF="https://lists.berlios.de/mailman/listinfo/freenx-cvs">seb at esfnet.co.uk</A>
+ ***************************************************************************/
+
+/***************************************************************************
+ *                                                                         *
+ *   This program is free software; you can redistribute it and/or modify  *
+ *   it under the terms of the GNU General Public License as published by  *
+ *   the Free Software Foundation; either version 2 of the License, or     *
+ *   (at your option) any later version.                                   *
+ *                                                                         *
+ ***************************************************************************/
+#ifndef _NXLAUNCH_H_
+#define _NXLAUNCH_H_ 1
+
+#define DBUS_API_SUBJECT_TO_CHANGE 1
+#include &lt;dbus/dbus.h&gt;
+#include &quot;../lib/callbacks_nx.h&quot;
+
+#ifdef DEBUG
+# if DEBUG==0
+# undef DEBUG
+# endif
+#endif
+
+#ifndef PRINTERR_DEFINED
+# define PRINTERR_DEFINED 1
+# ifdef DEBUG
+#  define printerr(args...)	fprintf(stderr, ## args);
+#  define printdbg(args...)	fprintf(stdout, ## args);
+# else
+#  define printerr(args...)
+#  define printdbg(args...)
+# endif
+#endif
+
+/*!
+ * Some definitions of numbers that we can send over to the frontend
+ * client to tell it how we're getting along with the connection...
+ * These should be the same as those found in nxcl/lib/nxdata.h.
+ */
+#define NXCL_PROCESS_STARTED        1000001
+#define NXCL_PROCESS_EXITED         1000002
+#define NXCL_AUTH_FAILED            1000003
+#define NXCL_AUTHENTICATING         1000004
+#define NXCL_LOGIN_FAILED           1000005
+#define NXCL_HOST_KEY_VERIFAILED    1000006
+#define NXCL_INVOKE_PROXY           1000007
+#define NXCL_STARTING               1000008
+#define NXCL_FINISHED               1000009
+#define NXCL_ALIVE                  1000010
+
+/*
+ * Column ids for NX Connection List - the list of configured NX connections 
+ * This mirrors nx_connection in callbacks_nx.h
+ */
+enum
+{
+	CONN_CONNECTIONNAME,
+	CONN_SERVERHOST,
+	CONN_SERVERPORT,
+	CONN_USER,
+	CONN_PASS,
+	CONN_REMEMBERPASS,
+	CONN_DISABLENODELAY,
+	CONN_DISABLEZLIB,
+	CONN_ENABLESSLONLY,
+	CONN_LINKSPEED,
+	CONN_PUBLICKEY,
+	CONN_DESKTOP,
+	CONN_CUSTOMUNIXDESKTOP,
+	CONN_COMMANDLINE,
+	CONN_VIRTUALDESKTOP,
+	CONN_XAGENTENCODING,
+	CONN_USETAINT,
+	CONN_XDMMODE,
+	CONN_XDMHOST,
+	CONN_XDMPORT,
+	CONN_FULLSCREEN,
+	CONN_RESOLUTIONWIDTH,
+	CONN_RESOLUTIONHEIGHT,
+	CONN_GEOMETRY,
+	CONN_IMAGEENCODING,
+	CONN_JPEGQUALITY,
+	CONN_ENABLESOUND,
+	CONN_IPPPORT,
+	CONN_IPPPRINTING,
+	CONN_SHARES,
+	CONN_AGENTSERVER,
+	CONN_AGENTUSER,
+	CONN_AGENTPASS,
+	N_CONN_COLUMNS        /* the number of entries here */
+};
+
+/*! Similar to NXResumeData in nxcl, but with gchar* instead of string*/
+struct NXResumeData {
+	int display;
+	gchar * sessionType;
+	gchar * sessionID;
+	gchar * options;
+	int depth;
+	gchar * screen;
+	gchar * available;
+	gchar * sessionName;
+};
+
+/*!
+ * Column ids for NX Session resume list. This appears when you
+ * connect to a server on which there are some running and suspended
+ * sessions that you could connect to.
+ * This mirrors NXResumeData above.
+ */
+enum
+{
+	SESS_INDEX,
+	SESS_DISPLAY,
+	SESS_SESSIONTYPE,
+	SESS_TYPEICON,
+	SESS_SESSIONID,
+	SESS_OPTIONS,
+	SESS_DEPTH,
+	SESS_SCREEN,
+	SESS_AVAILABLE,
+	SESS_SESSIONNAME,
+	N_SESS_COLUMNS        /* the number of entries here */
+};
+
+/*!
+ * Modes in which nxlaunch can be started
+ *
+ * MODE_MAIN - no switches given
+ * MODE_NAMED - just a name given
+ * MODE_FILE - a file switch given
+ * MODE_EDIT_NAMED - name and --edit switch given
+ * MODE_EDIT_FILE - file and --edit switch given
+ */
+enum
+{
+	MODE_MAIN,
+	MODE_NAMED,
+	MODE_FILE,
+	MODE_EDIT_NAMED,
+	MODE_EDIT_FILE,
+	N_MODES
+};
+
+/*!
+ * Function Declarations
+ */
+//@{
+
+/*!
+ * Callbacks for User Interface
+ */
+//@{
+void on_button_nxlaunch_launch_clicked (GtkButton * button);
+#if BUILT_IN_CONFIGURATION==1
+void on_button_nxlaunch_new_clicked (GtkButton * button);
+void on_button_nxlaunch_edit_clicked (GtkButton * button);
+void on_button_nxlaunch_delete_clicked (GtkButton * button);
+/*!
+ * Called when the OK button is clicked in the config window. On this
+ * callback we need to read the data from the window into an nx_conn
+ * structure then read that data into the relevant field in the
+ * connection list.
+ */
+void on_conn_new_ok_clicked (GtkButton * button);
+#endif
+void on_button_nxlaunch_quit_clicked (GtkButton * button);
+void on_button_nxsession_connect_clicked (GtkButton * button);
+void on_button_nxsession_launch_clicked (GtkButton * button);
+void on_button_nxsession_terminate_clicked (GtkButton * button);
+void on_button_nxsession_cancel_clicked (GtkButton * button);
+/*!
+ * \brief Set the password in nx_conn and launch the connection.
+ *
+ * This callback will check if there is an nx_connection structure in
+ * memory, pointed to by the global pointer nx_conn_glob. If there
+ * _is_ one, it will launch that connection using launch connection,
+ * after setting the password from the password dialogue box. If there
+ * is no nx_connection pointed to by the global pointer, it will
+ * malloc space for nx_conn, read in the active row from the
+ * tree_model in the main window, and then launch that connection.
+ */
+void on_button_password_ok_clicked (GtkButton * button);
+void on_button_password_cancel_clicked (GtkButton * button);
+/*!
+ * Called when you single click a row in the connection list. This
+ * function will update the user in the username entry box on the
+ * nxlauncher window.
+ */
+void on_treeview_connection_cursor_changed (GtkWidget * widget);
+
+//@}
+
+/*!
+ * Look in ~/.nx, and build a list of connections based on the number
+ * of .nxs files in there.
+ *
+ * Return number of connections.
+ */
+int nxconnection_buildlist (void);
+
+/*!
+ * Create the memory structure for the treelist of connections
+ */
+void nxlaunch_create_nxconnection_list (void);
+
+/*!
+ * Create the memory structure for the treelist of available sessions
+ */
+void nxlaunch_create_nxsession_list (void);
+
+/*!
+ * Send all the settings in a single dbus signal.
+ */
+int sendSettings (DBusConnection *bus, struct nx_connection * nx_conn);
+
+/*!
+ * Calls receiveSession and interprets the output.
+ *
+ * \param relist_call Set this to TRUE if this is a call to
+ * receiveSession to re-list the sessions in the session list, after
+ * terminating a session.
+ */
+void callReceiveSession (gboolean relist_call);
+
+/*!
+ * Used in receiveSession as the return value
+ */
+#define REPLY_REQUIRED  1
+#define NEW_CONNECTION  2
+#define SERVER_CAPACITY 3
+/*!
+ * Listen to the dbus, waiting for a signal to say either that
+ * connection is in progress, or giving us a list of possible sessions
+ * we could connect to. Return true if nxcld requires a reply such
+ * as &quot;please resume session 1&quot;.
+ */
+int receiveSession (DBusConnection* conn);
+
+/*!
+ * Send a signal containing the identifier for the NX session that the
+ * user would like to start.
+ */
+int sendReply (DBusConnection *bus, int sessionNum);
+
+/*!
+ * Send a signal containing the identifier for the NX session that the
+ * user would like to terminate.
+ */
+int terminateSession (DBusConnection *bus, int sessionNum);
+
+/*!
+ * Set up DBUS.
+ *
+ * Uses global variables dbusConn and dbusErr which need to be set up
+ * in the main.c file.
+ *
+ * Returns the suffix of the dbus naming - e.g. 0 if dbusSendInterface
+ * is org.freenx.nxcl.client0 etc.
+ *
+ * Returns -1 on error.
+ */
+int obtainDbusConnection (void);
+
+
+/*!
+ * Fork and exec the nxcl process.
+ */
+void execNxcl (void);
+
+/*!
+ * Prepare DBUS for sending/receiving and then send the settings
+ */
+void sendNxclSettings (struct nx_connection * nx_conn);
+
+/*!
+ * Populate nx_conn from the treeview list.
+ */
+void getActiveConnection (struct nx_connection * nx_conn);
+
+/*!
+ * If there is a configured connection with the name connection_name,
+ * launch it by calling launch_connection.
+ */
+gboolean launch_named_connection (gchar * connection_name);
+
+/*!
+ * Launch the connection by calling nxcl, then communicating with it
+ * via dbus.
+ */
+void launch_connection (struct nx_connection * nx_conn);
+
+/*!
+ * Hide the main nxlaunch window
+ */
+void nxlauncher_hide (void);
+
+/*!
+ * Show the main nxlaunch window
+ */
+void nxlauncher_show (void);
+
+/*!
+ * Get the password field stored in the active (highlighted)
+ * connection. If there is a password, return TRUE, if the length of
+ * the password is 0, return FALSE.
+ */
+#define STORED_PASSWORD  0x1
+#define ENTERED_PASSWORD 0x2
+int checkActiveConnectionPassword (void);
+
+/*!
+ * Display a window saying &quot;We're done&quot;, then exit after 5 seconds.
+ * This is so that the program doesn't appear to exit before the NX
+ * session window appears.
+ */
+void nxlaunch_quit_with_window (void);
+
+/*!
+ * Display a progress window, which could have a progress bar on it,
+ * and should have some text output to the user.
+ */
+void nxlaunch_display_progress (void);
+
+/*!
+ * A listener for dbus status messages. We use the contents of these
+ * messages to update the progress bar for user feedback on connection
+ * progress.
+ */
+gboolean nxlaunch_status_listener (gpointer data);
+
+/*!
+ * Wait for an alive message from nxcl. This function blocks until the
+ * message is received or a timeout has occurred.
+ */
+gboolean waitForAlive (void);
+
+/*!
+ * A non-recoverable error occurred. Show the user a dialog explaining
+ * the error, with a quit button as the only available option. Grey
+ * out all other windows.
+ *
+ * \param message The error message to display
+ */
+void nxlaunch_error_requiring_quit (const char * message);
+
+//@} Fn Declarations
+
+#endif /* _NXLAUNCH_H_ */

Added: nxlaunch/src/pixmaps/gnome-nx-session.png
===================================================================
(Binary files differ)


Property changes on: nxlaunch/src/pixmaps/gnome-nx-session.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: nxlaunch/src/pixmaps/kde-nx-session.png
===================================================================
(Binary files differ)


Property changes on: nxlaunch/src/pixmaps/kde-nx-session.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: nxlaunch/src/pixmaps/nx-icon.png
===================================================================
(Binary files differ)


Property changes on: nxlaunch/src/pixmaps/nx-icon.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: nxlaunch/src/pixmaps/nx-icon.xcf
===================================================================
(Binary files differ)


Property changes on: nxlaunch/src/pixmaps/nx-icon.xcf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: nxlaunch/src/pixmaps/nxclient-icon.png
===================================================================
(Binary files differ)


Property changes on: nxlaunch/src/pixmaps/nxclient-icon.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: nxlaunch/src/pixmaps/rdp-nx-session.png
===================================================================
(Binary files differ)


Property changes on: nxlaunch/src/pixmaps/rdp-nx-session.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: nxlaunch/src/pixmaps/unknown-nx-session.png
===================================================================
(Binary files differ)


Property changes on: nxlaunch/src/pixmaps/unknown-nx-session.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: nxlaunch/src/pixmaps/vnc-nx-session.png
===================================================================
(Binary files differ)


Property changes on: nxlaunch/src/pixmaps/vnc-nx-session.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000510.html">[Freenx-cvs] r380 - in nxcl: lib nxcl
</A></li>
	<LI>Next message: <A HREF="000511.html">[Freenx-cvs] r382 - nxlaunch/src
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#668">[ date ]</a>
              <a href="thread.html#668">[ thread ]</a>
              <a href="subject.html#668">[ subject ]</a>
              <a href="author.html#668">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/freenx-cvs">More information about the Freenx-cvs
mailing list</a><br>
</body></html>
